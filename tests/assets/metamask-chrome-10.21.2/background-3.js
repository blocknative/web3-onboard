LavaPack.loadBundle([[2406,{buffer:1965},function(){with(this)return function(){"use strict";return function(e,t,r){!function(t,r){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function a(e,t,r){if(a.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var s;"object"==typeof t?t.exports=a:r.BN=a,a.BN=a,a.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:e("buffer").Buffer}catch(e){}function o(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function c(e,t,r){var n=o(e,r);return r-1>=t&&(n|=o(e,r-1)<<4),n}function u(e,t,r,i){for(var a=0,s=0,o=Math.min(e.length,r),c=t;c<o;c++){var u=e.charCodeAt(c)-48;a*=i,s=u>=49?u-49+10:u>=17?u-17+10:u,n(u>=0&&s<i,"Invalid character"),a+=s}return a}function l(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(a.isBN=function(e){return e instanceof a||null!==e&&"object"==typeof e&&e.constructor.wordSize===a.wordSize&&Array.isArray(e.words)},a.max=function(e,t){return e.cmp(t)>0?e:t},a.min=function(e,t){return e.cmp(t)<0?e:t},a.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},a.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},a.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var a,s,o=0;if("be"===r)for(i=e.length-1,a=0;i>=0;i-=3)s=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);else if("le"===r)for(i=0,a=0;i<e.length;i+=3)s=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[a]|=s<<o&67108863,this.words[a+1]=s>>>26-o&67108863,(o+=24)>=26&&(o-=26,a++);return this._strip()},a.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,a=0,s=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=c(e,t,n)<<a,this.words[s]|=67108863&i,a>=18?(a-=18,s+=1,this.words[s]|=i>>>26):a+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=c(e,t,n)<<a,this.words[s]|=67108863&i,a>=18?(a-=18,s+=1,this.words[s]|=i>>>26):a+=8;this._strip()},a.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var a=e.length-r,s=a%n,o=Math.min(a,a-s)+r,c=0,l=r;l<o;l+=n)c=u(e,l,l+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var d=1;for(c=u(e,l,e.length,t),l=0;l<s;l++)d*=t;this.imuln(d),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},a.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},a.prototype._move=function(e){l(e,this)},a.prototype.clone=function(){var e=new a(null);return this.copy(e),e},a.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},a.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=d}catch(e){a.prototype.inspect=d}else a.prototype.inspect=d;function d(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,a=0,s=0;s<this.length;s++){var o=this.words[s],c=(16777215&(o<<i|a)).toString(16);a=o>>>24-i&16777215,(i+=2)>=26&&(i-=26,s--),r=0!==a||s!==this.length-1?h[6-c.length]+c+r:c+r}for(0!==a&&(r=a.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var u=f[e],l=p[e];r="";var d=this.clone();for(d.negative=0;!d.isZero();){var m=d.modrn(l).toString(e);r=(d=d.idivn(l)).isZero()?m+r:h[u-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},a.prototype.toJSON=function(){return this.toString(16,2)},s&&(a.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),a.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],a=0|t.words[0],s=i*a,o=67108863&s,c=s/67108864|0;r.words[0]=o;for(var u=1;u<n;u++){for(var l=c>>>26,d=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;l+=(s=(i=0|e.words[p])*(a=0|t.words[f])+d)/67108864|0,d=67108863&s}r.words[u]=0|d,c=0|l}return 0!==c?r.words[u]=0|c:r.length--,r._strip()}a.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),a=r||Math.max(1,i);n(i<=a,"byte array longer than desired length"),n(a>0,"Requested array length <= 0");var s=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,a);return this["_toArrayLike"+("le"===t?"LE":"BE")](s,i),s},a.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,a=0;i<this.length;i++){var s=this.words[i]<<a|n;e[r++]=255&s,r<e.length&&(e[r++]=s>>8&255),r<e.length&&(e[r++]=s>>16&255),6===a?(r<e.length&&(e[r++]=s>>24&255),n=0,a=0):(n=s>>>24,a+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},a.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,a=0;i<this.length;i++){var s=this.words[i]<<a|n;e[r--]=255&s,r>=0&&(e[r--]=s>>8&255),r>=0&&(e[r--]=s>>16&255),6===a?(r>=0&&(e[r--]=s>>24&255),n=0,a=0):(n=s>>>24,a+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?a.prototype._countBits=function(e){return 32-Math.clz32(e)}:a.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},a.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},a.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},a.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return 0!==this.negative},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},a.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},a.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},a.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},a.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},a.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},a.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},a.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},a.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},a.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},a.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},a.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},a.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},a.prototype.notn=function(e){return this.clone().inotn(e)},a.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},a.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,a=0;a<n.length;a++)t=(0|r.words[a])+(0|n.words[a])+i,this.words[a]=67108863&t,i=t>>>26;for(;0!==i&&a<r.length;a++)t=(0|r.words[a])+i,this.words[a]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this},a.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},a.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var a=0,s=0;s<n.length;s++)a=(t=(0|r.words[s])-(0|n.words[s])+a)>>26,this.words[s]=67108863&t;for(;0!==a&&s<r.length;s++)a=(t=(0|r.words[s])+a)>>26,this.words[s]=67108863&t;if(0===a&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(e){return this.clone().isub(e)};var g=function(e,t,r){var n,i,a,s=e.words,o=t.words,c=r.words,u=0,l=0|s[0],d=8191&l,h=l>>>13,f=0|s[1],p=8191&f,m=f>>>13,g=0|s[2],v=8191&g,b=g>>>13,y=0|s[3],w=8191&y,E=y>>>13,k=0|s[4],S=8191&k,T=k>>>13,_=0|s[5],x=8191&_,A=_>>>13,P=0|s[6],I=8191&P,R=P>>>13,M=0|s[7],C=8191&M,N=M>>>13,O=0|s[8],L=8191&O,D=O>>>13,B=0|s[9],U=8191&B,F=B>>>13,G=0|o[0],j=8191&G,H=G>>>13,K=0|o[1],q=8191&K,V=K>>>13,W=0|o[2],z=8191&W,Y=W>>>13,$=0|o[3],J=8191&$,Q=$>>>13,Z=0|o[4],X=8191&Z,ee=Z>>>13,te=0|o[5],re=8191&te,ne=te>>>13,ie=0|o[6],ae=8191&ie,se=ie>>>13,oe=0|o[7],ce=8191&oe,ue=oe>>>13,le=0|o[8],de=8191&le,he=le>>>13,fe=0|o[9],pe=8191&fe,me=fe>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(u+(n=Math.imul(d,j))|0)+((8191&(i=(i=Math.imul(d,H))+Math.imul(h,j)|0))<<13)|0;u=((a=Math.imul(h,H))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,j),i=(i=Math.imul(p,H))+Math.imul(m,j)|0,a=Math.imul(m,H);var ve=(u+(n=n+Math.imul(d,q)|0)|0)+((8191&(i=(i=i+Math.imul(d,V)|0)+Math.imul(h,q)|0))<<13)|0;u=((a=a+Math.imul(h,V)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(v,j),i=(i=Math.imul(v,H))+Math.imul(b,j)|0,a=Math.imul(b,H),n=n+Math.imul(p,q)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(m,q)|0,a=a+Math.imul(m,V)|0;var be=(u+(n=n+Math.imul(d,z)|0)|0)+((8191&(i=(i=i+Math.imul(d,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((a=a+Math.imul(h,Y)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(w,j),i=(i=Math.imul(w,H))+Math.imul(E,j)|0,a=Math.imul(E,H),n=n+Math.imul(v,q)|0,i=(i=i+Math.imul(v,V)|0)+Math.imul(b,q)|0,a=a+Math.imul(b,V)|0,n=n+Math.imul(p,z)|0,i=(i=i+Math.imul(p,Y)|0)+Math.imul(m,z)|0,a=a+Math.imul(m,Y)|0;var ye=(u+(n=n+Math.imul(d,J)|0)|0)+((8191&(i=(i=i+Math.imul(d,Q)|0)+Math.imul(h,J)|0))<<13)|0;u=((a=a+Math.imul(h,Q)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(S,j),i=(i=Math.imul(S,H))+Math.imul(T,j)|0,a=Math.imul(T,H),n=n+Math.imul(w,q)|0,i=(i=i+Math.imul(w,V)|0)+Math.imul(E,q)|0,a=a+Math.imul(E,V)|0,n=n+Math.imul(v,z)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(b,z)|0,a=a+Math.imul(b,Y)|0,n=n+Math.imul(p,J)|0,i=(i=i+Math.imul(p,Q)|0)+Math.imul(m,J)|0,a=a+Math.imul(m,Q)|0;var we=(u+(n=n+Math.imul(d,X)|0)|0)+((8191&(i=(i=i+Math.imul(d,ee)|0)+Math.imul(h,X)|0))<<13)|0;u=((a=a+Math.imul(h,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(x,j),i=(i=Math.imul(x,H))+Math.imul(A,j)|0,a=Math.imul(A,H),n=n+Math.imul(S,q)|0,i=(i=i+Math.imul(S,V)|0)+Math.imul(T,q)|0,a=a+Math.imul(T,V)|0,n=n+Math.imul(w,z)|0,i=(i=i+Math.imul(w,Y)|0)+Math.imul(E,z)|0,a=a+Math.imul(E,Y)|0,n=n+Math.imul(v,J)|0,i=(i=i+Math.imul(v,Q)|0)+Math.imul(b,J)|0,a=a+Math.imul(b,Q)|0,n=n+Math.imul(p,X)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,X)|0,a=a+Math.imul(m,ee)|0;var Ee=(u+(n=n+Math.imul(d,re)|0)|0)+((8191&(i=(i=i+Math.imul(d,ne)|0)+Math.imul(h,re)|0))<<13)|0;u=((a=a+Math.imul(h,ne)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(I,j),i=(i=Math.imul(I,H))+Math.imul(R,j)|0,a=Math.imul(R,H),n=n+Math.imul(x,q)|0,i=(i=i+Math.imul(x,V)|0)+Math.imul(A,q)|0,a=a+Math.imul(A,V)|0,n=n+Math.imul(S,z)|0,i=(i=i+Math.imul(S,Y)|0)+Math.imul(T,z)|0,a=a+Math.imul(T,Y)|0,n=n+Math.imul(w,J)|0,i=(i=i+Math.imul(w,Q)|0)+Math.imul(E,J)|0,a=a+Math.imul(E,Q)|0,n=n+Math.imul(v,X)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(b,X)|0,a=a+Math.imul(b,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,a=a+Math.imul(m,ne)|0;var ke=(u+(n=n+Math.imul(d,ae)|0)|0)+((8191&(i=(i=i+Math.imul(d,se)|0)+Math.imul(h,ae)|0))<<13)|0;u=((a=a+Math.imul(h,se)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(C,j),i=(i=Math.imul(C,H))+Math.imul(N,j)|0,a=Math.imul(N,H),n=n+Math.imul(I,q)|0,i=(i=i+Math.imul(I,V)|0)+Math.imul(R,q)|0,a=a+Math.imul(R,V)|0,n=n+Math.imul(x,z)|0,i=(i=i+Math.imul(x,Y)|0)+Math.imul(A,z)|0,a=a+Math.imul(A,Y)|0,n=n+Math.imul(S,J)|0,i=(i=i+Math.imul(S,Q)|0)+Math.imul(T,J)|0,a=a+Math.imul(T,Q)|0,n=n+Math.imul(w,X)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(E,X)|0,a=a+Math.imul(E,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(b,re)|0,a=a+Math.imul(b,ne)|0,n=n+Math.imul(p,ae)|0,i=(i=i+Math.imul(p,se)|0)+Math.imul(m,ae)|0,a=a+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(d,ce)|0)|0)+((8191&(i=(i=i+Math.imul(d,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((a=a+Math.imul(h,ue)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,j),i=(i=Math.imul(L,H))+Math.imul(D,j)|0,a=Math.imul(D,H),n=n+Math.imul(C,q)|0,i=(i=i+Math.imul(C,V)|0)+Math.imul(N,q)|0,a=a+Math.imul(N,V)|0,n=n+Math.imul(I,z)|0,i=(i=i+Math.imul(I,Y)|0)+Math.imul(R,z)|0,a=a+Math.imul(R,Y)|0,n=n+Math.imul(x,J)|0,i=(i=i+Math.imul(x,Q)|0)+Math.imul(A,J)|0,a=a+Math.imul(A,Q)|0,n=n+Math.imul(S,X)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(T,X)|0,a=a+Math.imul(T,ee)|0,n=n+Math.imul(w,re)|0,i=(i=i+Math.imul(w,ne)|0)+Math.imul(E,re)|0,a=a+Math.imul(E,ne)|0,n=n+Math.imul(v,ae)|0,i=(i=i+Math.imul(v,se)|0)+Math.imul(b,ae)|0,a=a+Math.imul(b,se)|0,n=n+Math.imul(p,ce)|0,i=(i=i+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,a=a+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(d,de)|0)|0)+((8191&(i=(i=i+Math.imul(d,he)|0)+Math.imul(h,de)|0))<<13)|0;u=((a=a+Math.imul(h,he)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(U,j),i=(i=Math.imul(U,H))+Math.imul(F,j)|0,a=Math.imul(F,H),n=n+Math.imul(L,q)|0,i=(i=i+Math.imul(L,V)|0)+Math.imul(D,q)|0,a=a+Math.imul(D,V)|0,n=n+Math.imul(C,z)|0,i=(i=i+Math.imul(C,Y)|0)+Math.imul(N,z)|0,a=a+Math.imul(N,Y)|0,n=n+Math.imul(I,J)|0,i=(i=i+Math.imul(I,Q)|0)+Math.imul(R,J)|0,a=a+Math.imul(R,Q)|0,n=n+Math.imul(x,X)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(A,X)|0,a=a+Math.imul(A,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(T,re)|0,a=a+Math.imul(T,ne)|0,n=n+Math.imul(w,ae)|0,i=(i=i+Math.imul(w,se)|0)+Math.imul(E,ae)|0,a=a+Math.imul(E,se)|0,n=n+Math.imul(v,ce)|0,i=(i=i+Math.imul(v,ue)|0)+Math.imul(b,ce)|0,a=a+Math.imul(b,ue)|0,n=n+Math.imul(p,de)|0,i=(i=i+Math.imul(p,he)|0)+Math.imul(m,de)|0,a=a+Math.imul(m,he)|0;var _e=(u+(n=n+Math.imul(d,pe)|0)|0)+((8191&(i=(i=i+Math.imul(d,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((a=a+Math.imul(h,me)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(U,q),i=(i=Math.imul(U,V))+Math.imul(F,q)|0,a=Math.imul(F,V),n=n+Math.imul(L,z)|0,i=(i=i+Math.imul(L,Y)|0)+Math.imul(D,z)|0,a=a+Math.imul(D,Y)|0,n=n+Math.imul(C,J)|0,i=(i=i+Math.imul(C,Q)|0)+Math.imul(N,J)|0,a=a+Math.imul(N,Q)|0,n=n+Math.imul(I,X)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(R,X)|0,a=a+Math.imul(R,ee)|0,n=n+Math.imul(x,re)|0,i=(i=i+Math.imul(x,ne)|0)+Math.imul(A,re)|0,a=a+Math.imul(A,ne)|0,n=n+Math.imul(S,ae)|0,i=(i=i+Math.imul(S,se)|0)+Math.imul(T,ae)|0,a=a+Math.imul(T,se)|0,n=n+Math.imul(w,ce)|0,i=(i=i+Math.imul(w,ue)|0)+Math.imul(E,ce)|0,a=a+Math.imul(E,ue)|0,n=n+Math.imul(v,de)|0,i=(i=i+Math.imul(v,he)|0)+Math.imul(b,de)|0,a=a+Math.imul(b,he)|0;var xe=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((a=a+Math.imul(m,me)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(U,z),i=(i=Math.imul(U,Y))+Math.imul(F,z)|0,a=Math.imul(F,Y),n=n+Math.imul(L,J)|0,i=(i=i+Math.imul(L,Q)|0)+Math.imul(D,J)|0,a=a+Math.imul(D,Q)|0,n=n+Math.imul(C,X)|0,i=(i=i+Math.imul(C,ee)|0)+Math.imul(N,X)|0,a=a+Math.imul(N,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(R,re)|0,a=a+Math.imul(R,ne)|0,n=n+Math.imul(x,ae)|0,i=(i=i+Math.imul(x,se)|0)+Math.imul(A,ae)|0,a=a+Math.imul(A,se)|0,n=n+Math.imul(S,ce)|0,i=(i=i+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,a=a+Math.imul(T,ue)|0,n=n+Math.imul(w,de)|0,i=(i=i+Math.imul(w,he)|0)+Math.imul(E,de)|0,a=a+Math.imul(E,he)|0;var Ae=(u+(n=n+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,me)|0)+Math.imul(b,pe)|0))<<13)|0;u=((a=a+Math.imul(b,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(U,J),i=(i=Math.imul(U,Q))+Math.imul(F,J)|0,a=Math.imul(F,Q),n=n+Math.imul(L,X)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(D,X)|0,a=a+Math.imul(D,ee)|0,n=n+Math.imul(C,re)|0,i=(i=i+Math.imul(C,ne)|0)+Math.imul(N,re)|0,a=a+Math.imul(N,ne)|0,n=n+Math.imul(I,ae)|0,i=(i=i+Math.imul(I,se)|0)+Math.imul(R,ae)|0,a=a+Math.imul(R,se)|0,n=n+Math.imul(x,ce)|0,i=(i=i+Math.imul(x,ue)|0)+Math.imul(A,ce)|0,a=a+Math.imul(A,ue)|0,n=n+Math.imul(S,de)|0,i=(i=i+Math.imul(S,he)|0)+Math.imul(T,de)|0,a=a+Math.imul(T,he)|0;var Pe=(u+(n=n+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(E,pe)|0))<<13)|0;u=((a=a+Math.imul(E,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(U,X),i=(i=Math.imul(U,ee))+Math.imul(F,X)|0,a=Math.imul(F,ee),n=n+Math.imul(L,re)|0,i=(i=i+Math.imul(L,ne)|0)+Math.imul(D,re)|0,a=a+Math.imul(D,ne)|0,n=n+Math.imul(C,ae)|0,i=(i=i+Math.imul(C,se)|0)+Math.imul(N,ae)|0,a=a+Math.imul(N,se)|0,n=n+Math.imul(I,ce)|0,i=(i=i+Math.imul(I,ue)|0)+Math.imul(R,ce)|0,a=a+Math.imul(R,ue)|0,n=n+Math.imul(x,de)|0,i=(i=i+Math.imul(x,he)|0)+Math.imul(A,de)|0,a=a+Math.imul(A,he)|0;var Ie=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((a=a+Math.imul(T,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(U,re),i=(i=Math.imul(U,ne))+Math.imul(F,re)|0,a=Math.imul(F,ne),n=n+Math.imul(L,ae)|0,i=(i=i+Math.imul(L,se)|0)+Math.imul(D,ae)|0,a=a+Math.imul(D,se)|0,n=n+Math.imul(C,ce)|0,i=(i=i+Math.imul(C,ue)|0)+Math.imul(N,ce)|0,a=a+Math.imul(N,ue)|0,n=n+Math.imul(I,de)|0,i=(i=i+Math.imul(I,he)|0)+Math.imul(R,de)|0,a=a+Math.imul(R,he)|0;var Re=(u+(n=n+Math.imul(x,pe)|0)|0)+((8191&(i=(i=i+Math.imul(x,me)|0)+Math.imul(A,pe)|0))<<13)|0;u=((a=a+Math.imul(A,me)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(U,ae),i=(i=Math.imul(U,se))+Math.imul(F,ae)|0,a=Math.imul(F,se),n=n+Math.imul(L,ce)|0,i=(i=i+Math.imul(L,ue)|0)+Math.imul(D,ce)|0,a=a+Math.imul(D,ue)|0,n=n+Math.imul(C,de)|0,i=(i=i+Math.imul(C,he)|0)+Math.imul(N,de)|0,a=a+Math.imul(N,he)|0;var Me=(u+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(R,pe)|0))<<13)|0;u=((a=a+Math.imul(R,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(U,ce),i=(i=Math.imul(U,ue))+Math.imul(F,ce)|0,a=Math.imul(F,ue),n=n+Math.imul(L,de)|0,i=(i=i+Math.imul(L,he)|0)+Math.imul(D,de)|0,a=a+Math.imul(D,he)|0;var Ce=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(i=(i=i+Math.imul(C,me)|0)+Math.imul(N,pe)|0))<<13)|0;u=((a=a+Math.imul(N,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(U,de),i=(i=Math.imul(U,he))+Math.imul(F,de)|0,a=Math.imul(F,he);var Ne=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(i=(i=i+Math.imul(L,me)|0)+Math.imul(D,pe)|0))<<13)|0;u=((a=a+Math.imul(D,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863;var Oe=(u+(n=Math.imul(U,pe))|0)+((8191&(i=(i=Math.imul(U,me))+Math.imul(F,pe)|0))<<13)|0;return u=((a=Math.imul(F,me))+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,c[0]=ge,c[1]=ve,c[2]=be,c[3]=ye,c[4]=we,c[5]=Ee,c[6]=ke,c[7]=Se,c[8]=Te,c[9]=_e,c[10]=xe,c[11]=Ae,c[12]=Pe,c[13]=Ie,c[14]=Re,c[15]=Me,c[16]=Ce,c[17]=Ne,c[18]=Oe,0!==u&&(c[19]=u,r.length++),r};function v(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,a=0;a<r.length-1;a++){var s=i;i=0;for(var o=67108863&n,c=Math.min(a,t.length-1),u=Math.max(0,a-e.length+1);u<=c;u++){var l=a-u,d=(0|e.words[l])*(0|t.words[u]),h=67108863&d;o=67108863&(h=h+o|0),i+=(s=(s=s+(d/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}r.words[a]=o,n=s,s=i}return 0!==n?r.words[a]=n:r.length--,r._strip()}function b(e,t,r){return v(e,t,r)}function y(e,t){this.x=e,this.y=t}Math.imul||(g=m),a.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?g(this,e,t):r<63?m(this,e,t):r<1024?v(this,e,t):b(this,e,t)},y.prototype.makeRBT=function(e){for(var t=new Array(e),r=a.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},y.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},y.prototype.permute=function(e,t,r,n,i,a){for(var s=0;s<a;s++)n[s]=t[e[s]],i[s]=r[e[s]]},y.prototype.transform=function(e,t,r,n,i,a){this.permute(a,e,t,r,n,i);for(var s=1;s<i;s<<=1)for(var o=s<<1,c=Math.cos(2*Math.PI/o),u=Math.sin(2*Math.PI/o),l=0;l<i;l+=o)for(var d=c,h=u,f=0;f<s;f++){var p=r[l+f],m=n[l+f],g=r[l+f+s],v=n[l+f+s],b=d*g-h*v;v=d*v+h*g,g=b,r[l+f]=p+g,n[l+f]=m+v,r[l+f+s]=p-g,n[l+f+s]=m-v,f!==o&&(b=c*d-u*h,h=c*h+u*d,d=b)}},y.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},y.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},y.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},y.prototype.convert13b=function(e,t,r,i){for(var a=0,s=0;s<t;s++)a+=0|e[s],r[2*s]=8191&a,a>>>=13,r[2*s+1]=8191&a,a>>>=13;for(s=2*t;s<i;++s)r[s]=0;n(0===a),n(0==(-8192&a))},y.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},y.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),a=this.stub(n),s=new Array(n),o=new Array(n),c=new Array(n),u=new Array(n),l=new Array(n),d=new Array(n),h=r.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,a,o,c,n,i),this.transform(u,a,l,d,n,i);for(var f=0;f<n;f++){var p=o[f]*l[f]-c[f]*d[f];c[f]=o[f]*d[f]+c[f]*l[f],o[f]=p}return this.conjugate(o,c,n),this.transform(o,c,h,a,n,i),this.conjugate(h,a,n),this.normalize13b(h,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},a.prototype.mul=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},a.prototype.mulf=function(e){var t=new a(null);return t.words=new Array(this.length+e.length),b(this,e,t)},a.prototype.imul=function(e){return this.clone().mulTo(e,this)},a.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var a=(0|this.words[i])*e,s=(67108863&a)+(67108863&r);r>>=26,r+=a/67108864|0,r+=s>>>26,this.words[i]=67108863&s}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},a.prototype.muln=function(e){return this.clone().imuln(e)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new a(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},a.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,a=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(t=0;t<this.length;t++){var o=this.words[t]&a,c=(0|this.words[t])-o<<r;this.words[t]=c|s,s=o>>>26-r}s&&(this.words[t]=s,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},a.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},a.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var a=e%26,s=Math.min((e-a)/26,this.length),o=67108863^67108863>>>a<<a,c=r;if(i-=s,i=Math.max(0,i),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var l=0;for(u=this.length-1;u>=0&&(0!==l||u>=i);u--){var d=0|this.words[u];this.words[u]=l<<26-a|d>>>a,l=d&o}return c&&0!==l&&(c.words[c.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},a.prototype.shln=function(e){return this.clone().ishln(e)},a.prototype.ushln=function(e){return this.clone().iushln(e)},a.prototype.shrn=function(e){return this.clone().ishrn(e)},a.prototype.ushrn=function(e){return this.clone().iushrn(e)},a.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},a.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},a.prototype.maskn=function(e){return this.clone().imaskn(e)},a.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},a.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},a.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},a.prototype.addn=function(e){return this.clone().iaddn(e)},a.prototype.subn=function(e){return this.clone().isubn(e)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(e,t,r){var i,a,s=e.length+r;this._expand(s);var o=0;for(i=0;i<e.length;i++){a=(0|this.words[i+r])+o;var c=(0|e.words[i])*t;o=((a-=67108863&c)>>26)-(c/67108864|0),this.words[i+r]=67108863&a}for(;i<this.length-r;i++)o=(a=(0|this.words[i+r])+o)>>26,this.words[i+r]=67108863&a;if(0===o)return this._strip();for(n(-1===o),o=0,i=0;i<this.length;i++)o=(a=-(0|this.words[i])+o)>>26,this.words[i]=67108863&a;return this.negative=1,this._strip()},a.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,s=0|i.words[i.length-1];0!==(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var o,c=n.length-i.length;if("mod"!==t){(o=new a(null)).length=c+1,o.words=new Array(o.length);for(var u=0;u<o.length;u++)o.words[u]=0}var l=n.clone()._ishlnsubmul(i,1,c);0===l.negative&&(n=l,o&&(o.words[c]=1));for(var d=c-1;d>=0;d--){var h=67108864*(0|n.words[i.length+d])+(0|n.words[i.length+d-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(i,h,d);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(i,1,d),n.isZero()||(n.negative^=1);o&&(o.words[d]=h)}return o&&o._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:o||null,mod:n}},a.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new a(0),mod:new a(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(i=o.div.neg()),"div"!==t&&(s=o.mod.neg(),r&&0!==s.negative&&s.iadd(e)),{div:i,mod:s}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(i=o.div.neg()),{div:i,mod:o.mod}):0!=(this.negative&e.negative)?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(s=o.mod.neg(),r&&0!==s.negative&&s.isub(e)),{div:o.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new a(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new a(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new a(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,s,o},a.prototype.div=function(e){return this.divmod(e,"div",!1).div},a.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},a.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},a.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),a=r.cmp(n);return a<0||1===i&&0===a?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},a.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,a=this.length-1;a>=0;a--)i=(r*i+(0|this.words[a]))%e;return t?-i:i},a.prototype.modn=function(e){return this.modrn(e)},a.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var a=(0|this.words[i])+67108864*r;this.words[i]=a/e|0,r=a%e}return this._strip(),t?this.ineg():this},a.prototype.divn=function(e){return this.clone().idivn(e)},a.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new a(1),s=new a(0),o=new a(0),c=new a(1),u=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++u;for(var l=r.clone(),d=t.clone();!t.isZero();){for(var h=0,f=1;0==(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(l),s.isub(d)),i.iushrn(1),s.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(o.isOdd()||c.isOdd())&&(o.iadd(l),c.isub(d)),o.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(o),s.isub(c)):(r.isub(t),o.isub(i),c.isub(s))}return{a:o,b:c,gcd:r.iushln(u)}},a.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,s=new a(1),o=new a(0),c=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var u=0,l=1;0==(t.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var d=0,h=1;0==(r.words[0]&h)&&d<26;++d,h<<=1);if(d>0)for(r.iushrn(d);d-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(o)):(r.isub(t),o.isub(s))}return(i=0===t.cmpn(1)?s:o).cmpn(0)<0&&i.iadd(e),i},a.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var a=t;t=r,r=a}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},a.prototype.invm=function(e){return this.egcd(e).a.umod(e)},a.prototype.isEven=function(){return 0==(1&this.words[0])},a.prototype.isOdd=function(){return 1==(1&this.words[0])},a.prototype.andln=function(e){return this.words[0]&e},a.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var a=i,s=r;0!==a&&s<this.length;s++){var o=0|this.words[s];a=(o+=a)>>>26,o&=67108863,this.words[s]=o}return 0!==a&&(this.words[s]=a,this.length++),this},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},a.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},a.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},a.prototype.gtn=function(e){return 1===this.cmpn(e)},a.prototype.gt=function(e){return 1===this.cmp(e)},a.prototype.gten=function(e){return this.cmpn(e)>=0},a.prototype.gte=function(e){return this.cmp(e)>=0},a.prototype.ltn=function(e){return-1===this.cmpn(e)},a.prototype.lt=function(e){return-1===this.cmp(e)},a.prototype.lten=function(e){return this.cmpn(e)<=0},a.prototype.lte=function(e){return this.cmp(e)<=0},a.prototype.eqn=function(e){return 0===this.cmpn(e)},a.prototype.eq=function(e){return 0===this.cmp(e)},a.red=function(e){return new x(e)},a.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},a.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(e){return this.red=e,this},a.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},a.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},a.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},a.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},a.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},a.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},a.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},a.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},a.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};function E(e,t){this.name=e,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function k(){E.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){E.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){E.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function _(){E.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function x(e){if("string"==typeof e){var t=a._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function A(e){x.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}E.prototype._tmp=function(){var e=new a(null);return e.words=new Array(Math.ceil(this.n/13)),e},E.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},E.prototype.split=function(e,t){e.iushrn(this.n,0,t)},E.prototype.imulK=function(e){return e.imul(this.k)},i(k,E),k.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var a=e.words[9];for(t.words[t.length++]=a&r,i=10;i<e.length;i++){var s=0|e.words[i];e.words[i-10]=(s&r)<<4|a>>>22,a=s}a>>>=22,e.words[i-10]=a,0===a&&e.length>10?e.length-=10:e.length-=9},k.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(S,E),i(T,E),i(_,E),_.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},a._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new k;else if("p224"===e)t=new S;else if("p192"===e)t=new T;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new _}return w[e]=t,t},x.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},x.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},x.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(l(e,e.umod(this.m)._forceRed(this)),e)},x.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},x.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},x.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},x.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},x.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},x.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},x.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},x.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},x.prototype.isqr=function(e){return this.imul(e,e.clone())},x.prototype.sqr=function(e){return this.mul(e,e)},x.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new a(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var o=new a(1).toRed(this),c=o.redNeg(),u=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new a(2*l*l).toRed(this);0!==this.pow(l,u).cmp(c);)l.redIAdd(c);for(var d=this.pow(l,i),h=this.pow(e,i.addn(1).iushrn(1)),f=this.pow(e,i),p=s;0!==f.cmp(o);){for(var m=f,g=0;0!==m.cmp(o);g++)m=m.redSqr();n(g<p);var v=this.pow(d,new a(1).iushln(p-g-1));h=h.redMul(v),d=v.redSqr(),f=f.redMul(d),p=g}return h},x.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},x.prototype.pow=function(e,t){if(t.isZero())return new a(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new a(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],s=0,o=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],l=c-1;l>=0;l--){var d=u>>l&1;i!==r[0]&&(i=this.sqr(i)),0!==d||0!==s?(s<<=1,s|=d,(4===++o||0===n&&0===l)&&(i=this.mul(i,r[s]),o=0,s=0)):o=0}c=26}return i},x.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},x.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},a.mont=function(e){return new A(e)},i(A,x),A.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},A.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},A.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),a=i;return i.cmp(this.m)>=0?a=i.isub(this.m):i.cmpn(0)<0&&(a=i.iadd(this.m)),a._forceRed(this)},A.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new a(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},A.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}}},{package:"eth-lattice-keyring>bn.js"}],[2407,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t.push(n(e[r]));const r=f(...t);return f(s(r.length,192),r)}const t=v(e);return 1===t.length&&t[0]<128?t:f(s(t.length,128),t)}function i(e,t,r){if(r>e.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return e.slice(t,r)}function a(e){if(0===e[0])throw new Error("invalid RLP: extra zeros");return d(l(e))}function s(e,t){if(e<56)return Uint8Array.from([e+t]);const r=m(e),n=m(t+55+r.length/2);return Uint8Array.from(h(n+r))}function o(e,t=!1){if(!e||0===e.length)return Uint8Array.from([]);const r=c(v(e));if(t)return r;if(0!==r.remainder.length)throw new Error("invalid RLP: remainder must be zero");return r.data}function c(e){let t,r,n,s,o;const u=[],l=e[0];if(l<=127)return{data:e.slice(0,1),remainder:e.slice(1)};if(l<=183){if(t=l-127,n=128===l?Uint8Array.from([]):i(e,1,t),2===t&&n[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:n,remainder:e.slice(t)}}if(l<=191){if(r=l-182,e.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(t=a(i(e,1,r)),t<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return n=i(e,r,t+r),{data:n,remainder:e.slice(t+r)}}if(l<=247){for(t=l-191,s=i(e,1,t);s.length;)o=c(s),u.push(o.data),s=o.remainder;return{data:u,remainder:e.slice(t)}}{if(r=l-246,t=a(i(e,1,r)),t<56)throw new Error("invalid RLP: encoded list too short");const n=r+t;if(n>e.length)throw new Error("invalid RLP: total length is larger than the data");for(s=i(e,r,n);s.length;)o=c(s),u.push(o.data),s=o.remainder;return{data:u,remainder:e.slice(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.decode=r.encode=void 0,r.encode=n,r.decode=o;const u=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function l(e){let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t}function d(e){const t=Number.parseInt(e,16);if(Number.isNaN(t))throw new Error("Invalid byte sequence");return t}function h(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=2*r;t[r]=d(e.slice(n,n+2))}return t}function f(...e){if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}function p(e){return(new TextEncoder).encode(e)}function m(e){if(e<0)throw new Error("Invalid integer as argument, must be unsigned!");const t=e.toString(16);return t.length%2?`0${t}`:t}function g(e){return e.length>=2&&"0"===e[0]&&"x"===e[1]}function v(e){if(e instanceof Uint8Array)return e;if("string"==typeof e)return g(e)?h((t="string"!=typeof(r=e)?r:g(r)?r.slice(2):r).length%2?`0${t}`:t):p(e);var t,r;if("number"==typeof e||"bigint"==typeof e)return e?h(m(e)):Uint8Array.from([]);if(null===e||e===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof e)}r.utils={bytesToHex:l,concatBytes:f,hexToBytes:h,utf8ToBytes:p};const b={encode:n,decode:o};r.default=b}}},{package:"eth-lattice-keyring>rlp"}],[2408,{"./lib":2410,"./lib/elliptic":2409},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e("./lib")(e("./lib/elliptic"))}}},{package:"eth-lattice-keyring>secp256k1"}],[2409,{elliptic:2198},function(){with(this)return function(){"use strict";return function(e,t,r){const n=new(0,e("elliptic").ec)("secp256k1"),i=n.curve,a=i.n.constructor;function s(e){const t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){let r=new a(t);if(r.cmp(i.p)>=0)return null;r=r.toRed(i.red);let s=r.redSqr().redIMul(r).redIAdd(i.b).redSqrt();return 3===e!==s.isOdd()&&(s=s.redNeg()),n.keyPair({pub:{x:r,y:s}})}(t,e.subarray(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){let s=new a(t),o=new a(r);if(s.cmp(i.p)>=0||o.cmp(i.p)>=0)return null;if(s=s.toRed(i.red),o=o.toRed(i.red),(6===e||7===e)&&o.isOdd()!==(7===e))return null;const c=s.redSqr().redIMul(s);return o.redSqr().redISub(c.redIAdd(i.b)).isZero()?n.keyPair({pub:{x:s,y:o}}):null}(t,e.subarray(1,33),e.subarray(33,65));default:return null}}function o(e,t){const r=t.encode(null,33===e.length);for(let t=0;t<e.length;++t)e[t]=r[t]}t.exports={contextRandomize:()=>0,privateKeyVerify(e){const t=new a(e);return t.cmp(i.n)<0&&!t.isZero()?0:1},privateKeyNegate(e){const t=new a(e),r=i.n.sub(t).umod(i.n).toArrayLike(Uint8Array,"be",32);return e.set(r),0},privateKeyTweakAdd(e,t){const r=new a(t);if(r.cmp(i.n)>=0)return 1;if(r.iadd(new a(e)),r.cmp(i.n)>=0&&r.isub(i.n),r.isZero())return 1;const n=r.toArrayLike(Uint8Array,"be",32);return e.set(n),0},privateKeyTweakMul(e,t){let r=new a(t);if(r.cmp(i.n)>=0||r.isZero())return 1;r.imul(new a(e)),r.cmp(i.n)>=0&&(r=r.umod(i.n));const n=r.toArrayLike(Uint8Array,"be",32);return e.set(n),0},publicKeyVerify:e=>null===s(e)?1:0,publicKeyCreate(e,t){const r=new a(t);if(r.cmp(i.n)>=0||r.isZero())return 1;return o(e,n.keyFromPrivate(t).getPublic()),0},publicKeyConvert(e,t){const r=s(t);if(null===r)return 1;return o(e,r.getPublic()),0},publicKeyNegate(e,t){const r=s(t);if(null===r)return 1;const n=r.getPublic();return n.y=n.y.redNeg(),o(e,n),0},publicKeyCombine(e,t){const r=new Array(t.length);for(let e=0;e<t.length;++e)if(r[e]=s(t[e]),null===r[e])return 1;let n=r[0].getPublic();for(let e=1;e<r.length;++e)n=n.add(r[e].pub);return n.isInfinity()?2:(o(e,n),0)},publicKeyTweakAdd(e,t,r){const n=s(t);if(null===n)return 1;if((r=new a(r)).cmp(i.n)>=0)return 2;const c=n.getPublic().add(i.g.mul(r));return c.isInfinity()?2:(o(e,c),0)},publicKeyTweakMul(e,t,r){const n=s(t);if(null===n)return 1;if((r=new a(r)).cmp(i.n)>=0||r.isZero())return 2;return o(e,n.getPublic().mul(r)),0},signatureNormalize(e){const t=new a(e.subarray(0,32)),r=new a(e.subarray(32,64));return t.cmp(i.n)>=0||r.cmp(i.n)>=0?1:(1===r.cmp(n.nh)&&e.set(i.n.sub(r).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(e,t){const r=t.subarray(0,32),n=t.subarray(32,64);if(new a(r).cmp(i.n)>=0)return 1;if(new a(n).cmp(i.n)>=0)return 1;const{output:s}=e;let o=s.subarray(4,37);o[0]=0,o.set(r,1);let c=33,u=0;for(;c>1&&0===o[u]&&!(128&o[u+1]);--c,++u);if(o=o.subarray(u),128&o[0])return 1;if(c>1&&0===o[0]&&!(128&o[1]))return 1;let l=s.subarray(39,72);l[0]=0,l.set(n,1);let d=33,h=0;for(;d>1&&0===l[h]&&!(128&l[h+1]);--d,++h);return l=l.subarray(h),128&l[0]||d>1&&0===l[0]&&!(128&l[1])?1:(e.outputlen=6+c+d,s[0]=48,s[1]=e.outputlen-2,s[2]=2,s[3]=o.length,s.set(o,4),s[4+c]=2,s[5+c]=l.length,s.set(l,6+c),0)},signatureImport(e,t){if(t.length<8)return 1;if(t.length>72)return 1;if(48!==t[0])return 1;if(t[1]!==t.length-2)return 1;if(2!==t[2])return 1;const r=t[3];if(0===r)return 1;if(5+r>=t.length)return 1;if(2!==t[4+r])return 1;const n=t[5+r];if(0===n)return 1;if(6+r+n!==t.length)return 1;if(128&t[4])return 1;if(r>1&&0===t[4]&&!(128&t[5]))return 1;if(128&t[r+6])return 1;if(n>1&&0===t[r+6]&&!(128&t[r+7]))return 1;let s=t.subarray(4,4+r);if(33===s.length&&0===s[0]&&(s=s.subarray(1)),s.length>32)return 1;let o=t.subarray(6+r);if(33===o.length&&0===o[0]&&(o=o.slice(1)),o.length>32)throw new Error("S length is too long");let c=new a(s);c.cmp(i.n)>=0&&(c=new a(0));let u=new a(t.subarray(6+r));return u.cmp(i.n)>=0&&(u=new a(0)),e.set(c.toArrayLike(Uint8Array,"be",32),0),e.set(u.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(e,t,r,s,o){if(o){const e=o;o=n=>{const i=e(t,r,null,s,n);if(!(i instanceof Uint8Array&&32===i.length))throw new Error("This is the way");return new a(i)}}const c=new a(r);if(c.cmp(i.n)>=0||c.isZero())return 1;let u;try{u=n.sign(t,r,{canonical:!0,k:o,pers:s})}catch(e){return 1}return e.signature.set(u.r.toArrayLike(Uint8Array,"be",32),0),e.signature.set(u.s.toArrayLike(Uint8Array,"be",32),32),e.recid=u.recoveryParam,0},ecdsaVerify(e,t,r){const o={r:e.subarray(0,32),s:e.subarray(32,64)},c=new a(o.r),u=new a(o.s);if(c.cmp(i.n)>=0||u.cmp(i.n)>=0)return 1;if(1===u.cmp(n.nh)||c.isZero()||u.isZero())return 3;const l=s(r);if(null===l)return 2;const d=l.getPublic();return n.verify(t,o,d)?0:3},ecdsaRecover(e,t,r,s){const c={r:t.slice(0,32),s:t.slice(32,64)},u=new a(c.r),l=new a(c.s);if(u.cmp(i.n)>=0||l.cmp(i.n)>=0)return 1;if(u.isZero()||l.isZero())return 2;let d;try{d=n.recoverPubKey(s,c,r)}catch(e){return 2}return o(e,d),0},ecdh(e,t,r,o,c,u,l){const d=s(t);if(null===d)return 1;const h=new a(r);if(h.cmp(i.n)>=0||h.isZero())return 2;const f=d.getPublic().mul(h);if(c===undefined){const t=f.encode(null,!0),r=n.hash().update(t).digest();for(let t=0;t<32;++t)e[t]=r[t]}else{u||(u=new Uint8Array(32));const t=f.getX().toArray("be",32);for(let e=0;e<32;++e)u[e]=t[e];l||(l=new Uint8Array(32));const r=f.getY().toArray("be",32);for(let e=0;e<32;++e)l[e]=r[e];const n=c(u,l,o);if(!(n instanceof Uint8Array&&n.length===e.length))return 2;e.set(n)}return 0}}}}},{package:"eth-lattice-keyring>secp256k1"}],[241,{"./constants":240,multibase:229,"uint8arrays/concat":242,"uint8arrays/from-string":244,"uint8arrays/to-string":245,varint:6451},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multibase"),i=e("varint"),{names:a}=e("./constants"),s=e("uint8arrays/to-string"),o=e("uint8arrays/from-string"),c=e("uint8arrays/concat"),u={};for(const e in a){const t=e;u[a[t]]=t}function l(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");const t=i.decode(e);if(!f(t))throw new Error(`multihash unknown function code: 0x${t.toString(16)}`);e=e.slice(i.decode.bytes);const r=i.decode(e);if(r<0)throw new Error(`multihash invalid length: ${r}`);if((e=e.slice(i.decode.bytes)).length!==r)throw new Error(`multihash length inconsistent: 0x${s(e,"base16")}`);return{code:t,name:u[t],length:r,digest:e}}function d(e){let t=e;if("string"==typeof e){if(a[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=a[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(u[t]===undefined&&!h(t))throw new Error(`Unrecognized function code: ${t}`);return t}function h(e){return e>0&&e<16}function f(e){return!!h(e)||!!u[e]}function p(e){l(e)}Object.freeze(u),t.exports={names:a,codes:u,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(e,"base16")},fromHexString:function(e){return o(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(n.encode("base58btc",e)).slice(1)},fromB58String:function(e){const t=e instanceof Uint8Array?s(e):e;return n.decode("z"+t)},decode:l,encode:function(e,t,r){if(!e||t===undefined)throw new Error("multihash encode requires at least two args: digest, code");const n=d(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==r&&(r=e.length),r&&e.length!==r)throw new Error("digest length should be equal to specified length.");const a=i.encode(n),s=i.encode(r);return c([a,s,e],a.length+s.length+e.length)},coerceCode:d,isAppCode:h,validate:p,prefix:function(e){return p(e),e.subarray(0,2)},isValidCode:f}}}},{package:"@ensdomains/content-hash>cids>multihashes"}],[2410,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n="Impossible case. Please create issue.",i="The tweak was out of range or the resulted private key is invalid",a="The tweak was out of range or equal to zero",s="Unknow error on context randomization",o="Private Key is invalid",c="Public Key could not be parsed",u="Public Key serialization error",l="The sum of the public keys is not valid",d="Signature could not be parsed",h="The nonce generation function failed, or the private key was invalid",f="Public key could not be recover",p="Scalar was invalid (zero or overflow)";function m(e,t){if(!e)throw new Error(t)}function g(e,t,r){if(m(t instanceof Uint8Array,`Expected ${e} to be an Uint8Array`),r!==undefined)if(Array.isArray(r)){const n=`Expected ${e} to be an Uint8Array with length [${r.join(", ")}]`;m(r.includes(t.length),n)}else{const n=`Expected ${e} to be an Uint8Array with length ${r}`;m(t.length===r,n)}}function v(e){m("Boolean"===y(e),"Expected compressed to be a Boolean")}function b(e=(e=>new Uint8Array(e)),t){return"function"==typeof e&&(e=e(t)),g("output",e,t),e}function y(e){return Object.prototype.toString.call(e).slice(8,-1)}t.exports=e=>({contextRandomize(t){if(m(null===t||t instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),null!==t&&g("seed",t,32),1===e.contextRandomize(t))throw new Error(s)},privateKeyVerify:t=>(g("private key",t,32),0===e.privateKeyVerify(t)),privateKeyNegate(t){switch(g("private key",t,32),e.privateKeyNegate(t)){case 0:return t;case 1:throw new Error(n)}},privateKeyTweakAdd(t,r){switch(g("private key",t,32),g("tweak",r,32),e.privateKeyTweakAdd(t,r)){case 0:return t;case 1:throw new Error(i)}},privateKeyTweakMul(t,r){switch(g("private key",t,32),g("tweak",r,32),e.privateKeyTweakMul(t,r)){case 0:return t;case 1:throw new Error(a)}},publicKeyVerify:t=>(g("public key",t,[33,65]),0===e.publicKeyVerify(t)),publicKeyCreate(t,r=!0,n){switch(g("private key",t,32),v(r),n=b(n,r?33:65),e.publicKeyCreate(n,t)){case 0:return n;case 1:throw new Error(o);case 2:throw new Error(u)}},publicKeyConvert(t,r=!0,n){switch(g("public key",t,[33,65]),v(r),n=b(n,r?33:65),e.publicKeyConvert(n,t)){case 0:return n;case 1:throw new Error(c);case 2:throw new Error(u)}},publicKeyNegate(t,r=!0,i){switch(g("public key",t,[33,65]),v(r),i=b(i,r?33:65),e.publicKeyNegate(i,t)){case 0:return i;case 1:throw new Error(c);case 2:throw new Error(n);case 3:throw new Error(u)}},publicKeyCombine(t,r=!0,n){m(Array.isArray(t),"Expected public keys to be an Array"),m(t.length>0,"Expected public keys array will have more than zero items");for(const e of t)g("public key",e,[33,65]);switch(v(r),n=b(n,r?33:65),e.publicKeyCombine(n,t)){case 0:return n;case 1:throw new Error(c);case 2:throw new Error(l);case 3:throw new Error(u)}},publicKeyTweakAdd(t,r,n=!0,a){switch(g("public key",t,[33,65]),g("tweak",r,32),v(n),a=b(a,n?33:65),e.publicKeyTweakAdd(a,t,r)){case 0:return a;case 1:throw new Error(c);case 2:throw new Error(i)}},publicKeyTweakMul(t,r,n=!0,i){switch(g("public key",t,[33,65]),g("tweak",r,32),v(n),i=b(i,n?33:65),e.publicKeyTweakMul(i,t,r)){case 0:return i;case 1:throw new Error(c);case 2:throw new Error(a)}},signatureNormalize(t){switch(g("signature",t,64),e.signatureNormalize(t)){case 0:return t;case 1:throw new Error(d)}},signatureExport(t,r){g("signature",t,64);const i={output:r=b(r,72),outputlen:72};switch(e.signatureExport(i,t)){case 0:return r.slice(0,i.outputlen);case 1:throw new Error(d);case 2:throw new Error(n)}},signatureImport(t,r){switch(g("signature",t),r=b(r,64),e.signatureImport(r,t)){case 0:return r;case 1:throw new Error(d);case 2:throw new Error(n)}},ecdsaSign(t,r,i={},a){g("message",t,32),g("private key",r,32),m("Object"===y(i),"Expected options to be an Object"),i.data!==undefined&&g("options.data",i.data),i.noncefn!==undefined&&m("Function"===y(i.noncefn),"Expected options.noncefn to be a Function");const s={signature:a=b(a,64),recid:null};switch(e.ecdsaSign(s,t,r,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(h);case 2:throw new Error(n)}},ecdsaVerify(t,r,n){switch(g("signature",t,64),g("message",r,32),g("public key",n,[33,65]),e.ecdsaVerify(t,r,n)){case 0:return!0;case 3:return!1;case 1:throw new Error(d);case 2:throw new Error(c)}},ecdsaRecover(t,r,i,a=!0,s){switch(g("signature",t,64),m("Number"===y(r)&&r>=0&&r<=3,"Expected recovery id to be a Number within interval [0, 3]"),g("message",i,32),v(a),s=b(s,a?33:65),e.ecdsaRecover(s,t,r,i)){case 0:return s;case 1:throw new Error(d);case 2:throw new Error(f);case 3:throw new Error(n)}},ecdh(t,r,n={},i){switch(g("public key",t,[33,65]),g("private key",r,32),m("Object"===y(n),"Expected options to be an Object"),n.data!==undefined&&g("options.data",n.data),n.hashfn!==undefined?(m("Function"===y(n.hashfn),"Expected options.hashfn to be a Function"),n.xbuf!==undefined&&g("options.xbuf",n.xbuf,32),n.ybuf!==undefined&&g("options.ybuf",n.ybuf,32),g("output",i)):i=b(i,32),e.ecdh(i,t,r,n.data,n.hashfn,n.xbuf,n.ybuf)){case 0:return i;case 1:throw new Error(c);case 2:throw new Error(p)}}})}}},{package:"eth-lattice-keyring>secp256k1"}],[242,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"@ensdomains/content-hash>cids>uint8arrays"}],[243,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}}}},{package:"@ensdomains/content-hash>cids>uint8arrays"}],[2436,{"@ethereumjs/tx":399,buffer:1966,"ethereumjs-util":2496,events:1967,hdkey:2437,"trezor-connect":6379,"trezor-connect/lib/plugins/ethereum/typedData":6382},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){const{EventEmitter:n}=e("events"),i=e("ethereumjs-util"),a=e("hdkey"),s=e("trezor-connect").default,{TransactionFactory:o}=e("@ethereumjs/tx"),c=e("trezor-connect/lib/plugins/ethereum/typedData"),u="m/44'/60'/0'/0",l={[u]:!0,"m/44'/1'/0'/0":!0},d="Trezor Hardware",h=1e3,f={email:"support@metamask.io",appUrl:"https://metamask.io"};function p(e){return new Promise((t=>setTimeout(t,e)))}function m(e){return"function"==typeof e.getChainId}class g extends n{constructor(e={}){super(),this.type=d,this.accounts=[],this.hdk=new a,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},this.deserialize(e),s.on("DEVICE_EVENT",(e=>{e&&e.payload&&e.payload.features&&(this.model=e.payload.features.model)})),s.init({manifest:f})}getModel(){return this.model}dispose(){s.dispose()}serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}deserialize(e={}){return this.hdPath=e.hdPath||u,this.accounts=e.accounts||[],this.page=e.page||0,this.perPage=e.perPage||5,Promise.resolve()}isUnlocked(){return Boolean(this.hdk&&this.hdk.publicKey)}unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((e,t)=>{s.getPublicKey({path:this.hdPath,coin:"ETH"}).then((n=>{n.success?(this.hdk.publicKey=r.from(n.payload.publicKey,"hex"),this.hdk.chainCode=r.from(n.payload.chainCode,"hex"),e("just unlocked")):t(new Error(n.payload&&n.payload.error||"Unknown error"))})).catch((e=>{t(new Error(e&&e.toString()||"Unknown error"))}))}))}setAccountToUnlock(e){this.unlockedAccount=parseInt(e,10)}addAccounts(e=1){return new Promise(((t,r)=>{this.unlock().then((r=>{const n=this.unlockedAccount,i=n+e;for(let e=n;e<i;e++){const t=this._addressFromIndex("m",e);this.accounts.includes(t)||this.accounts.push(t),this.page=0}t(this.accounts)})).catch((e=>{r(e)}))}))}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}__getPage(e){return this.page+=e,this.page<=0&&(this.page=1),new Promise(((e,t)=>{this.unlock().then((t=>{const r=(this.page-1)*this.perPage,n=r+this.perPage,a=[];for(let e=r;e<n;e++){const t=this._addressFromIndex("m",e);a.push({address:t,balance:null,index:e}),this.paths[i.toChecksumAddress(t)]=e}e(a)})).catch((e=>{t(e)}))}))}getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(e){if(!this.accounts.map((e=>e.toLowerCase())).includes(e.toLowerCase()))throw new Error(`Address ${e} not found in this keyring`);this.accounts=this.accounts.filter((t=>t.toLowerCase()!==e.toLowerCase()))}signTransaction(e,t){return m(t)?this._signTransaction(e,t.getChainId(),t,(e=>(t.v=r.from(e.v,"hex"),t.r=r.from(e.r,"hex"),t.s=r.from(e.s,"hex"),t))):this._signTransaction(e,t.common.chainIdBN().toNumber(),t,(e=>{const r=t.toJSON();return r.type=t.type,r.v=i.addHexPrefix(e.v),r.r=i.addHexPrefix(e.r),r.s=i.addHexPrefix(e.s),o.fromTxData(r,{common:t.common,freeze:Object.isFrozen(t)})}))}async _signTransaction(e,t,r,n){let a;a=m(r)?{to:this._normalize(r.to),value:this._normalize(r.value),data:this._normalize(r.data),chainId:t,nonce:this._normalize(r.nonce),gasLimit:this._normalize(r.gasLimit),gasPrice:this._normalize(r.gasPrice)}:{...r.toJSON(),chainId:t,to:this._normalize(r.to)};try{const t=await this.unlock();await p("just unlocked"===t?h:0);const r=await s.ethereumSignTransaction({path:this._pathFromAddress(e),transaction:a});if(r.success){const t=n(r.payload),a=i.toChecksumAddress(i.addHexPrefix(t.getSenderAddress().toString("hex")));if(a!==i.toChecksumAddress(e))throw new Error("signature doesn't match the right address");return t}throw new Error(r.payload&&r.payload.error||"Unknown error")}catch(e){throw new Error(e&&e.toString()||"Unknown error")}}signMessage(e,t){return this.signPersonalMessage(e,t)}signPersonalMessage(e,t){return new Promise(((r,n)=>{this.unlock().then((a=>{setTimeout((a=>{s.ethereumSignMessage({path:this._pathFromAddress(e),message:i.stripHexPrefix(t),hex:!0}).then((t=>{if(t.success){t.payload.address!==i.toChecksumAddress(e)&&n(new Error("signature doesnt match the right address"));const a=`0x${t.payload.signature}`;r(a)}else n(new Error(t.payload&&t.payload.error||"Unknown error"))})).catch((e=>{n(new Error(e&&e.toString()||"Unknown error"))}))}),"just unlocked"===a?h:0)})).catch((e=>{n(new Error(e&&e.toString()||"Unknown error"))}))}))}async signTypedData(e,t,{version:r}){const n=c(t,"V4"===r),{types:{EIP712Domain:a=[],...o}={},message:u={},domain:l={},primaryType:d,domain_separator_hash:f,message_hash:m}=n,g=await this.unlock();await p("just unlocked"===g?h:0);const v=await s.ethereumSignTypedData({path:this._pathFromAddress(e),data:{types:{EIP712Domain:a,...o},message:u,domain:l,primaryType:d},metamask_v4_compat:!0,domain_separator_hash:f,message_hash:m});if(v.success){if(i.toChecksumAddress(e)!==v.payload.address)throw new Error("signature doesnt match the right address");return v.payload.signature}throw new Error(v.payload&&v.payload.error||"Unknown error")}exportAccount(){return Promise.reject(new Error("Not supported on this device"))}forgetDevice(){this.accounts=[],this.hdk=new a,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(e){if(!l[e])throw new Error(`The setHdPath method does not support setting HD Path to ${e}`);this.hdPath!==e&&(this.hdk=new a,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=e}_normalize(e){return i.bufferToHex(e).toString()}_addressFromIndex(e,t){const r=this.hdk.derive(`${e}/${t}`),n=i.publicToAddress(r.publicKey,!0).toString("hex");return i.toChecksumAddress(`0x${n}`)}_pathFromAddress(e){const t=i.toChecksumAddress(e);let r=this.paths[t];if(void 0===r)for(let e=0;e<1e3;e++)if(t===this._addressFromIndex("m",e)){r=e;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`}}g.type=d,t.exports=g}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-trezor-keyring"}],[2437,{assert:1594,coinstring:2008,crypto:2074,"safe-buffer":6178,secp256k1:6189},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("assert"),i=e("safe-buffer").Buffer,a=e("crypto"),s=e("coinstring"),o=e("secp256k1"),c=i.from("Bitcoin seed","utf8"),u=2147483648,l={private:76066276,public:76067358};function d(e){this.versions=e||l,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function h(e,t,r){var n=i.allocUnsafe(78);n.writeUInt32BE(t,0),n.writeUInt8(e.depth,4);var a=e.depth?e.parentFingerprint:0;return n.writeUInt32BE(a,5),n.writeUInt32BE(e.index,9),e.chainCode.copy(n,13),r.copy(n,45),n}function f(e){var t=a.createHash("sha256").update(e).digest();return a.createHash("rmd160").update(t).digest()}Object.defineProperty(d.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(d.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(d.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(d.prototype,"privateKey",{get:function(){return this._privateKey},set:function(e){n.equal(e.length,32,"Private key must be 32 bytes."),n(!0===o.privateKeyVerify(e),"Invalid private key"),this._privateKey=e,this._publicKey=o.publicKeyCreate(e,!0),this._identifier=f(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(d.prototype,"publicKey",{get:function(){return this._publicKey},set:function(e){n(33===e.length||65===e.length,"Public key must be 33 or 65 bytes."),n(!0===o.publicKeyVerify(e),"Invalid public key"),this._publicKey=o.publicKeyConvert(e,!0),this._identifier=f(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(d.prototype,"privateExtendedKey",{get:function(){return this._privateKey?s.encode(h(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(d.prototype,"publicExtendedKey",{get:function(){return s.encode(h(this,this.versions.public,this.publicKey))}}),d.prototype.derive=function(e){if("m"===e||"M"===e||"m'"===e||"M'"===e)return this;var t=e.split("/"),r=this;return t.forEach((function(e,t){if(0!==t){var i=e.length>1&&"'"===e[e.length-1],a=parseInt(e,10);n(a<u,"Invalid index"),i&&(a+=u),r=r.deriveChild(a)}else n(e,"m","Invalid path")})),r},d.prototype.deriveChild=function(e){var t,r=e>=u,s=i.allocUnsafe(4);if(s.writeUInt32BE(e,0),r){n(this.privateKey,"Could not derive hardened child key");var c=this.privateKey,l=i.alloc(1,0);c=i.concat([l,c]),t=i.concat([c,s])}else t=i.concat([this.publicKey,s]);var h=a.createHmac("sha512",this.chainCode).update(t).digest(),f=h.slice(0,32),p=h.slice(32),m=new d(this.versions);if(this.privateKey)try{m.privateKey=o.privateKeyTweakAdd(this.privateKey,f)}catch(t){return this.derive(e+1)}else try{m.publicKey=o.publicKeyTweakAdd(this.publicKey,f,!0)}catch(t){return this.derive(e+1,r)}return m.chainCode=p,m.depth=this.depth+1,m.parentFingerprint=this.fingerprint,m.index=e,m},d.prototype.sign=function(e){return o.sign(e,this.privateKey).signature},d.prototype.verify=function(e,t){return o.verify(e,t,this.publicKey)},d.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},d.fromMasterSeed=function(e,t){var r=a.createHmac("sha512",c).update(e).digest(),n=r.slice(0,32),i=r.slice(32),s=new d(t);return s.chainCode=i,s.privateKey=n,s},d.fromExtendedKey=function(e,t){var r=new d(t=t||l),i=s.decode(e),a=i.readUInt32BE(0);n(a===t.private||a===t.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var o=i.slice(45);return 0===o.readUInt8(0)?(n(a===t.private,"Version mismatch: version does not match private"),r.privateKey=o.slice(1)):(n(a===t.public,"Version mismatch: version does not match public"),r.publicKey=o),r},d.fromJSON=function(e){return d.fromExtendedKey(e.xpriv)},d.HARDENED_OFFSET=u,t.exports=d}}},{package:"eth-trezor-keyring>hdkey"}],[244,{multibase:229},function(){with(this)return function(){"use strict";return function(e,t,r){const{encoding:n}=e("multibase"),i=new TextEncoder;t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?i.encode(e):"ascii"===t?function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e):n(t).decode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays"}],[245,{multibase:229},function(){with(this)return function(){"use strict";return function(e,t,r){const{encoding:n}=e("multibase"),i=new TextDecoder("utf8");t.exports=function(e,t="utf8"){return"utf8"===t||"utf-8"===t?i.decode(e):"ascii"===t?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):n(t).encode(e)}}}},{package:"@ensdomains/content-hash>cids>uint8arrays"}],[246,{multihashes:241},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i={checkCIDComponents:function(e){if(null==e)return"null values are not valid CIDs";if(0!==e.version&&1!==e.version)return"Invalid version, must be a number equal to 1 or 0";if("string"!=typeof e.codec)return"codec must be string";if(0===e.version){if("dag-pb"!==e.codec)return"codec must be 'dag-pb' for CIDv0";if("base58btc"!==e.multibaseName)return"multibaseName must be 'base58btc' for CIDv0"}if(!(e.multihash instanceof Uint8Array))return"multihash must be a Uint8Array";try{n.validate(e.multihash)}catch(e){let t=e.message;return t||(t="Multihash validation failed"),t}}};t.exports=i}}},{package:"@ensdomains/content-hash>cids"}],[247,{"./cid-util":246,multibase:229,multicodec:237,multihashes:241,"uint8arrays/concat":242,"uint8arrays/equals":243,"uint8arrays/to-string":245},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multihashes"),i=e("multibase"),a=e("multicodec"),s=e("./cid-util"),o=e("uint8arrays/concat"),c=e("uint8arrays/to-string"),u=e("uint8arrays/equals"),l=a.nameToCode,d=Object.keys(l).reduce(((e,t)=>(e[l[t]]=t,e)),{}),h=Symbol.for("@ipld/js-cid/CID");class f{constructor(e,t,r,s){if(this.version,this.codec,this.multihash,Object.defineProperty(this,h,{value:!0}),f.isCID(e)){const t=e;return this.version=t.version,this.codec=t.codec,this.multihash=t.multihash,void(this.multibaseName=t.multibaseName||(0===t.version?"base58btc":"base32"))}if("string"==typeof e){const t=i.isEncoded(e);if(t){const r=i.decode(e);this.version=parseInt(r[0].toString(),16),this.codec=a.getCodec(r.slice(1)),this.multihash=a.rmPrefix(r.slice(1)),this.multibaseName=t}else this.version=0,this.codec="dag-pb",this.multihash=n.fromB58String(e),this.multibaseName="base58btc";return f.validateCID(this),void Object.defineProperty(this,"string",{value:e})}if(e instanceof Uint8Array){const t=parseInt(e[0].toString(),16);if(1===t){const r=e;this.version=t,this.codec=a.getCodec(r.slice(1)),this.multihash=a.rmPrefix(r.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=e,this.multibaseName="base58btc";f.validateCID(this)}else this.version=e,"number"==typeof t&&(t=d[t]),this.codec=t,this.multihash=r,this.multibaseName=s||(0===e?"base58btc":"base32"),f.validateCID(this)}get bytes(){let e=this._bytes;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");{const t=a.getCodeVarint(this.codec);e=o([[1],t,this.multihash],1+t.byteLength+this.multihash.byteLength)}}Object.defineProperty(this,"_bytes",{value:e})}return e}get prefix(){const e=a.getCodeVarint(this.codec),t=n.prefix(this.multihash);return o([[this.version],e,t],1+e.byteLength+t.byteLength)}get code(){return l[this.codec]}toV0(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");const{name:e,length:t}=n.decode(this.multihash);if("sha2-256"!==e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==t)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new f(0,this.codec,this.multihash)}toV1(){return new f(1,this.codec,this.multihash,this.multibaseName)}toBaseEncodedString(e=this.multibaseName){if(this.string&&0!==this.string.length&&e===this.multibaseName)return this.string;let t;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=n.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=c(i.encode(e,this.bytes))}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}toString(e){return this.toBaseEncodedString(e)}toJSON(){return{codec:this.codec,version:this.version,hash:this.multihash}}equals(e){return this.codec===e.codec&&this.version===e.version&&u(this.multihash,e.multihash)}static validateCID(e){const t=s.checkCIDComponents(e);if(t)throw new Error(t)}static isCID(e){return e instanceof f||Boolean(e&&e[h])}}f.codecs=l,t.exports=f}}},{package:"@ensdomains/content-hash>cids"}],[248,{buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer");t.exports=class{constructor(e,t,r,i){this.name=e,this.code=t,this.codeBuf=n.from(this.code),this.alphabet=i,this.engine=r(i)}encode(e){return this.engine.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.engine.decode(e)}}}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[249,{"./base.js":248,"./rfc4648":251,"./util":252,"base-x":1844},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("base-x"),i=e("./base.js"),a=e("./rfc4648"),{decodeText:s,encodeText:o}=e("./util"),c=[["identity","\0",()=>({encode:s,decode:o}),""],["base2","0",a(1),"01"],["base8","7",a(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",a(4),"0123456789abcdef"],["base16upper","F",a(4),"0123456789ABCDEF"],["base32hex","v",a(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",a(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",a(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",a(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",a(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=c.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=u[t[0]],e)),{});t.exports={names:u,codes:l}}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[25,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WALLET_PREFIX=r.NOTIFICATION_NAMES=r.LOG_METHOD_TYPES=r.LOG_LIMIT=r.LOG_IGNORE_METHODS=void 0;r.WALLET_PREFIX="wallet_";r.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"};r.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"];r.LOG_METHOD_TYPES={restricted:"restricted",internal:"internal"};r.LOG_LIMIT=100}}},{package:"$root$"}],[250,{"./constants":249,"./util":252,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("./constants"),{decodeText:a,asBuffer:s}=e("./util");function o(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error(`Unsupported encoding: ${e}`)}(r=t.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");const{name:r,codeBuf:i}=o(e);!function(e,t){o(e).decode(a(t))}(r,t);const s=n.alloc(i.length+t.length);return s.set(i,0),s.set(t,i.length),s}).encode=function(e,t){const r=o(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},r.decode=function(e){ArrayBuffer.isView(e)&&(e=a(e));const t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());const r=o(e[0]);return s(r.decode(e.substring(1)))},r.isEncoded=function(e){if(e instanceof Uint8Array&&(e=a(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return o(e[0]).name}catch(e){return!1}},r.encoding=o,r.encodingFromData=function(e){return e instanceof Uint8Array&&(e=a(e)),o(e[0])},r.names=Object.freeze(i.names),r.codes=Object.freeze(i.codes)}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[2502,{bs58check:1975,crypto:2074,"ethereumjs-util":2507,randombytes:6010,"safe-buffer":6178,scryptsy:6188,"uuid/v4":2516},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("safe-buffer").Buffer,a=e("ethereumjs-util"),s=e("crypto"),o=e("randombytes"),c=e("scryptsy"),u=e("uuid/v4"),l=e("bs58check");function d(e,t){if(!e)throw new Error(t||"Assertion failed")}function h(e,t){return i.concat([e.update(t),e.final()])}var f=function(e,t){if(e&&t)throw new Error("Cannot supply both a private and a public key to the constructor");if(e&&!a.isValidPrivate(e))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(t&&!a.isValidPublic(t))throw new Error("Invalid public key");this._privKey=e,this._pubKey=t};Object.defineProperty(f.prototype,"privKey",{get:function(){return d(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(f.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=a.privateToPublic(this.privKey)),this._pubKey}}),f.generate=function(e){if(!e)return new f(o(32));for(var t=new a.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var r=o(32);if(new a.BN(a.privateToAddress(r)).lte(t))return new f(r)}},f.generateVanityAddress=function(e){for("object"!==(void 0===e?"undefined":n(e))&&(e=new RegExp(e));;){var t=o(32),r=a.privateToAddress(t);if(e.test(r.toString("hex")))return new f(t)}},f.prototype.getPrivateKey=function(){return this.privKey},f.prototype.getPrivateKeyString=function(){return a.bufferToHex(this.getPrivateKey())},f.prototype.getPublicKey=function(){return this.pubKey},f.prototype.getPublicKeyString=function(){return a.bufferToHex(this.getPublicKey())},f.prototype.getAddress=function(){return a.publicToAddress(this.pubKey)},f.prototype.getAddressString=function(){return a.bufferToHex(this.getAddress())},f.prototype.getChecksumAddressString=function(){return a.toChecksumAddress(this.getAddressString())},f.prototype.toV3=function(e,t){d(this._privKey,"This is a public key only wallet");var r,n=(t=t||{}).salt||o(32),l=t.iv||o(16),f=t.kdf||"scrypt",p={dklen:t.dklen||32,salt:n.toString("hex")};if("pbkdf2"===f)p.c=t.c||262144,p.prf="hmac-sha256",r=s.pbkdf2Sync(i.from(e),n,p.c,p.dklen,"sha256");else{if("scrypt"!==f)throw new Error("Unsupported kdf");p.n=t.n||262144,p.r=t.r||8,p.p=t.p||1,r=c(i.from(e),n,p.n,p.r,p.p,p.dklen)}var m=s.createCipheriv(t.cipher||"aes-128-ctr",r.slice(0,16),l);if(!m)throw new Error("Unsupported cipher");var g=h(m,this.privKey),v=a.keccak256(i.concat([r.slice(16,32),i.from(g,"hex")]));return{version:3,id:u({random:t.uuid||o(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:g.toString("hex"),cipherparams:{iv:l.toString("hex")},cipher:t.cipher||"aes-128-ctr",kdf:f,kdfparams:p,mac:v.toString("hex")}}},f.prototype.getV3Filename=function(e){return["UTC--",(e?new Date(e):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},f.prototype.toV3String=function(e,t){return JSON.stringify(this.toV3(e,t))},f.fromPublicKey=function(e,t){return t&&(e=a.importPublic(e)),new f(null,e)},f.fromExtendedPublicKey=function(e){return d("xpub"===e.slice(0,4),"Not an extended public key"),e=l.decode(e).slice(45),f.fromPublicKey(e,!0)},f.fromPrivateKey=function(e){return new f(e)},f.fromExtendedPrivateKey=function(e){d("xprv"===e.slice(0,4),"Not an extended private key");var t=l.decode(e);return d(0===t[45],"Invalid extended private key"),f.fromPrivateKey(t.slice(46))},f.fromV1=function(e,t){d("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if("1"!==r.Version)throw new Error("Not a V1 wallet");if("scrypt"!==r.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var o=r.Crypto.KeyHeader.KdfParams,u=c(i.from(t),i.from(r.Crypto.Salt,"hex"),o.N,o.R,o.P,o.DkLen),l=i.from(r.Crypto.CipherText,"hex");if(a.keccak256(i.concat([u.slice(16,32),l])).toString("hex")!==r.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var p=h(s.createDecipheriv("aes-128-cbc",a.keccak256(u.slice(0,16)).slice(0,16),i.from(r.Crypto.IV,"hex")),l);return new f(p)},f.fromV3=function(e,t,r){d("string"==typeof t);var o,u,l="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(r?e.toLowerCase():e);if(3!==l.version)throw new Error("Not a V3 wallet");if("scrypt"===l.crypto.kdf)u=l.crypto.kdfparams,o=c(i.from(t),i.from(u.salt,"hex"),u.n,u.r,u.p,u.dklen);else{if("pbkdf2"!==l.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(u=l.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");o=s.pbkdf2Sync(i.from(t),i.from(u.salt,"hex"),u.c,u.dklen,"sha256")}var p=i.from(l.crypto.ciphertext,"hex");if(a.keccak256(i.concat([o.slice(16,32),p])).toString("hex")!==l.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var m=h(s.createDecipheriv(l.crypto.cipher,o.slice(0,16),i.from(l.crypto.cipherparams.iv,"hex")),p);return new f(m)},f.fromEthSale=function(e,t){d("string"==typeof t);var r="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e),o=i.from(r.encseed,"hex"),c=s.pbkdf2Sync(t,t,2e3,32,"sha256").slice(0,16),u=h(s.createDecipheriv("aes-128-cbc",c,o.slice(0,16)),o.slice(16)),l=new f(a.keccak256(u));if(l.getAddress().toString("hex")!==r.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return l},t.exports=f}}},{package:"ethereumjs-wallet"}],[2503,{"./bytes":2504,"./hash":2506,"./secp256k1v3-adapter":2509,assert:1594,"bn.js":1922,buffer:1966,"ethjs-util":2513},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=e("assert"),i=e("ethjs-util"),a=e("./secp256k1v3-adapter"),s=e("bn.js"),o=e("./bytes"),c=e("./hash");r.zeroAddress=function(){var e=o.zeros(20);return o.bufferToHex(e)},r.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/.test(e)},r.isZeroAddress=function(e){return r.zeroAddress()===o.addHexPrefix(e)},r.toChecksumAddress=function(e,t){e=i.stripHexPrefix(e).toLowerCase();for(var r=t!==undefined?t.toString()+"0x":"",n=c.keccak(r+e).toString("hex"),a="0x",s=0;s<e.length;s++)parseInt(n[s],16)>=8?a+=e[s].toUpperCase():a+=e[s];return a},r.isValidChecksumAddress=function(e,t){return r.isValidAddress(e)&&r.toChecksumAddress(e,t)===e},r.generateAddress=function(e,r){e=o.toBuffer(e);var n=new s(r);return n.isZero()?c.rlphash([e,null]).slice(-20):c.rlphash([e,t.from(n.toArray())]).slice(-20)},r.generateAddress2=function(e,r,i){var a=o.toBuffer(e),s=o.toBuffer(r),u=o.toBuffer(i);return n(20===a.length),n(32===s.length),c.keccak256(t.concat([t.from("ff","hex"),a,s,c.keccak256(u)])).slice(-20)},r.isPrecompiled=function(e){var t=o.unpad(e);return 1===t.length&&t[0]>=1&&t[0]<=8},r.isValidPrivate=function(e){return a.privateKeyVerify(e)},r.isValidPublic=function(e,r){return void 0===r&&(r=!1),64===e.length?a.publicKeyVerify(t.concat([t.from([4]),e])):!!r&&a.publicKeyVerify(e)},r.pubToAddress=function(e,t){return void 0===t&&(t=!1),e=o.toBuffer(e),t&&64!==e.length&&(e=a.publicKeyConvert(e,!1).slice(1)),n(64===e.length),c.keccak(e).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(e){return r.publicToAddress(r.privateToPublic(e))},r.privateToPublic=function(e){return e=o.toBuffer(e),a.publicKeyCreate(e,!1).slice(1)},r.importPublic=function(e){return 64!==(e=o.toBuffer(e)).length&&(e=a.publicKeyConvert(e,!1).slice(1)),e}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2504,{"bn.js":1922,buffer:1966,"ethjs-util":2513},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=e("ethjs-util"),i=e("bn.js");r.zeros=function(e){return t.allocUnsafe(e).fill(0)},r.setLengthLeft=function(e,t,n){void 0===n&&(n=!1);var i=r.zeros(t);return e=r.toBuffer(e),n?e.length<t?(e.copy(i),i):e.slice(0,t):e.length<t?(e.copy(i,t-e.length),i):e.slice(-t)},r.setLength=r.setLengthLeft,r.setLengthRight=function(e,t){return r.setLength(e,t,!0)},r.unpad=function(e){for(var t=(e=n.stripHexPrefix(e))[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e},r.stripZeros=r.unpad,r.toBuffer=function(e){if(!t.isBuffer(e))if(Array.isArray(e))e=t.from(e);else if("string"==typeof e){if(!n.isHexString(e))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+e);e=t.from(n.padToEven(n.stripHexPrefix(e)),"hex")}else if("number"==typeof e)e=n.intToBuffer(e);else if(null===e||e===undefined)e=t.allocUnsafe(0);else if(i.isBN(e))e=e.toArrayLike(t);else{if(!e.toArray)throw new Error("invalid type");e=t.from(e.toArray())}return e},r.bufferToInt=function(e){return new i(r.toBuffer(e)).toNumber()},r.bufferToHex=function(e){return"0x"+(e=r.toBuffer(e)).toString("hex")},r.fromSigned=function(e){return new i(e).fromTwos(256)},r.toUnsigned=function(e){return t.from(e.toTwos(256).toArray())},r.addHexPrefix=function(e){return"string"!=typeof e||n.isHexPrefixed(e)?e:"0x"+e},r.baToJSON=function(e){if(t.isBuffer(e))return"0x"+e.toString("hex");if(e instanceof Array){for(var n=[],i=0;i<e.length;i++)n.push(r.baToJSON(e[i]));return n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2505,{"bn.js":1922,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=e("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=t.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=t.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=t.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2506,{"./bytes":2504,buffer:1966,"create-hash":2067,"ethereum-cryptography/keccak":2441,"ethjs-util":2513,rlp:6176},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=e("ethereum-cryptography/keccak"),i=n.keccak224,a=n.keccak384,s=n.keccak256,o=n.keccak512,c=e("create-hash"),u=e("ethjs-util"),l=e("rlp"),d=e("./bytes");r.keccak=function(e,r){switch(void 0===r&&(r=256),e="string"!=typeof e||u.isHexString(e)?d.toBuffer(e):t.from(e,"utf8"),r||(r=256),r){case 224:return i(e);case 256:return s(e);case 384:return a(e);case 512:return o(e);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(e){return r.keccak(e)},r.sha256=function(e){return e=d.toBuffer(e),c("sha256").update(e).digest()},r.ripemd160=function(e,t){e=d.toBuffer(e);var r=c("rmd160").update(e).digest();return!0===t?d.setLength(r,32):r},r.rlphash=function(e){return r.keccak(l.encode(e))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2507,{"./account":2503,"./bytes":2504,"./constants":2505,"./hash":2506,"./object":2508,"./secp256k1v3-adapter":2509,"./signature":2512,"bn.js":1922,"ethjs-util":2513,rlp:6176},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var a=e("./secp256k1v3-adapter");r.secp256k1=a;var s=e("ethjs-util"),o=e("bn.js");r.BN=o;var c=e("rlp");r.rlp=c,Object.assign(r,s),i(e("./constants"),r),i(e("./account"),r),i(e("./hash"),r),i(e("./signature"),r),i(e("./bytes"),r),i(e("./object"),r)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2508,{"./bytes":2504,assert:1594,buffer:1966,"ethjs-util":2513,rlp:6176},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=e("assert"),i=e("ethjs-util"),a=e("rlp"),s=e("./bytes");r.defineProperties=function(e,r,o){if(e.raw=[],e._fields=[],e.toJSON=function(t){if(void 0===t&&(t=!1),t){var r={};return e._fields.forEach((function(t){r[t]="0x"+e[t].toString("hex")})),r}return s.baToJSON(e.raw)},e.serialize=function(){return a.encode(e.raw)},r.forEach((function(r,i){function a(){return e.raw[i]}function o(a){"00"!==(a=s.toBuffer(a)).toString("hex")||r.allowZero||(a=t.allocUnsafe(0)),r.allowLess&&r.length?(a=s.stripZeros(a),n(r.length>=a.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===a.length||!r.length||n(r.length===a.length,"The field "+r.name+" must have byte length of "+r.length),e.raw[i]=a}e._fields.push(r.name),Object.defineProperty(e,r.name,{enumerable:!0,configurable:!0,get:a,set:o}),r.default&&(e[r.name]=r.default),r.alias&&Object.defineProperty(e,r.alias,{enumerable:!1,configurable:!0,set:o,get:a})})),o)if("string"==typeof o&&(o=t.from(i.stripHexPrefix(o),"hex")),t.isBuffer(o)&&(o=a.decode(o)),Array.isArray(o)){if(o.length>e._fields.length)throw new Error("wrong number of fields in data");o.forEach((function(t,r){e[e._fields[r]]=s.toBuffer(t)}))}else{if("object"!=typeof o)throw new Error("invalid data");var c=Object.keys(o);r.forEach((function(t){-1!==c.indexOf(t.name)&&(e[t.name]=o[t.name]),-1!==c.indexOf(t.alias)&&(e[t.alias]=o[t.alias])}))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2509,{"./secp256k1v3-lib/der":2510,"./secp256k1v3-lib/index":2511,buffer:1966,"ethereum-cryptography/secp256k1":2473},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=e("ethereum-cryptography/secp256k1"),i=e("./secp256k1v3-lib/index"),a=e("./secp256k1v3-lib/der");r.privateKeyVerify=function(e){return 32===e.length&&n.privateKeyVerify(Uint8Array.from(e))},r.privateKeyExport=function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(e,t);return a.privateKeyExport(e,r,t)},r.privateKeyImport=function(e){if(null!==(e=a.privateKeyImport(e))&&32===e.length&&r.privateKeyVerify(e))return e;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(e){return t.from(n.privateKeyNegate(Uint8Array.from(e)))},r.privateKeyModInverse=function(e){if(32!==e.length)throw new Error("private key length is invalid");return t.from(i.privateKeyModInverse(Uint8Array.from(e)))},r.privateKeyTweakAdd=function(e,r){return t.from(n.privateKeyTweakAdd(Uint8Array.from(e),r))},r.privateKeyTweakMul=function(e,r){return t.from(n.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r)))},r.publicKeyCreate=function(e,r){return t.from(n.publicKeyCreate(Uint8Array.from(e),r))},r.publicKeyConvert=function(e,r){return t.from(n.publicKeyConvert(Uint8Array.from(e),r))},r.publicKeyVerify=function(e){return(33===e.length||65===e.length)&&n.publicKeyVerify(Uint8Array.from(e))},r.publicKeyTweakAdd=function(e,r,i){return t.from(n.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(e,r,i){return t.from(n.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(r),i))},r.publicKeyCombine=function(e,r){var i=[];return e.forEach((function(e){i.push(Uint8Array.from(e))})),t.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(e){return t.from(n.signatureNormalize(Uint8Array.from(e)))},r.signatureExport=function(e){return t.from(n.signatureExport(Uint8Array.from(e)))},r.signatureImport=function(e){return t.from(n.signatureImport(Uint8Array.from(e)))},r.signatureImportLax=function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=a.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return i.signatureImport(t)},r.sign=function(e,r,i){if(null===i)throw new TypeError("options should be an Object");var a=undefined;if(i){if(a={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");a.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(a.noncefn=function(e,r,n,a,s){var o=null!=n?t.from(n):null,c=null!=a?t.from(a):null,u=t.from("");return i.noncefn&&(u=i.noncefn(t.from(e),t.from(r),o,c,s)),new Uint8Array(u)})}var s=n.ecdsaSign(Uint8Array.from(e),Uint8Array.from(r),a);return{signature:t.from(s.signature),recovery:s.recid}},r.verify=function(e,t,r){return n.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},r.recover=function(e,r,i,a){return t.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(e),a))},r.ecdh=function(e,r){return t.from(n.ecdh(Uint8Array.from(e),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(e,r,n){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return t.from(i.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(r),n))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[251,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let a="",s=0,o=0;for(let n=0;n<e.length;++n)for(o=o<<8|e[n],s+=8;s>r;)s-=r,a+=t[i&o>>s];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const a=new Uint8Array(i*r/8|0);let s=0,o=0,c=0;for(let t=0;t<i;++t){const i=n[e[t]];if(i===undefined)throw new SyntaxError("Invalid character "+e[t]);o=o<<r|i,s+=r,s>=8&&(s-=8,a[c++]=255&o>>s)}if(s>=r||255&o<<8-s)throw new SyntaxError("Unexpected end of data");return a})(r,t,e)})}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[2510,{buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var t=e.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=e.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,a){void 0===a&&(a=!0);var s=e.from(a?t:n);return r.copy(s,a?8:9),i.copy(s,a?181:214),s},r.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||48!==e[r])return null;if(t<(r+=1)+1||!(128&e[r]))return null;var n=127&e[r];if(n<1||n>2)return null;if(t<(r+=1)+n)return null;var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return t<(r+=n)+i||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]?null:e.slice(r+2,r+2+e[r+1])},r.signatureImportLax=function(t){var r=e.alloc(32,0),n=e.alloc(32,0),i=t.length,a=0;if(48!==t[a++])return null;var s=t[a++];if(128&s&&(a+=s-128)>i)return null;if(2!==t[a++])return null;var o=t[a++];if(128&o){if(a+(s=o-128)>i)return null;for(;s>0&&0===t[a];a+=1,s-=1);for(o=0;s>0;a+=1,s-=1)o=(o<<8)+t[a]}if(o>i-a)return null;var c=a;if(a+=o,2!==t[a++])return null;var u=t[a++];if(128&u){if(a+(s=u-128)>i)return null;for(;s>0&&0===t[a];a+=1,s-=1);for(u=0;s>0;a+=1,s-=1)u=(u<<8)+t[a]}if(u>i-a)return null;var l=a;for(a+=u;o>0&&0===t[c];o-=1,c+=1);if(o>32)return null;var d=t.slice(c,c+o);for(d.copy(r,32-d.length);u>0&&0===t[l];u-=1,l+=1);if(u>32)return null;var h=t.slice(l,l+u);return h.copy(n,32-h.length),{r:r,s:n}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2511,{"bn.js":1922,buffer:1966,elliptic:2198},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=e("bn.js"),i=new(0,e("elliptic").ec)("secp256k1"),a=i.curve;r.privateKeyExport=function(e,t){void 0===t&&(t=!0);var r=new n(e);if(r.ucmp(a.n)>=0)throw new Error("couldn't export to DER format");var o=i.g.mul(r);return s(o.getX(),o.getY(),t)},r.privateKeyModInverse=function(e){var r=new n(e);if(r.ucmp(a.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(a.n).toArrayLike(t,"be",32)},r.signatureImport=function(e){var r=new n(e.r);r.ucmp(a.n)>=0&&(r=new n(0));var i=new n(e.s);return i.ucmp(a.n)>=0&&(i=new n(0)),t.concat([r.toArrayLike(t,"be",32),i.toArrayLike(t,"be",32)])},r.ecdhUnsafe=function(e,t,r){void 0===r&&(r=!0);var o=i.keyFromPublic(e),c=new n(t);if(c.ucmp(a.n)>=0||c.isZero())throw new Error("scalar was invalid (zero or overflow)");var u=o.pub.mul(c);return s(u.getX(),u.getY(),r)};var s=function(e,r,n){var i;return n?((i=t.alloc(33))[0]=r.isOdd()?3:2,e.toArrayLike(t,"be",32).copy(i,1)):((i=t.alloc(65))[0]=4,e.toArrayLike(t,"be",32).copy(i,1),r.toArrayLike(t,"be",32).copy(i,33)),i}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2512,{"./bytes":2504,"./hash":2506,"./secp256k1v3-adapter":2509,"bn.js":1922,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=e("./secp256k1v3-adapter"),i=e("bn.js"),a=e("./bytes"),s=e("./hash");function o(e,t){return t?e-(2*t+35):e-27}function c(e){return 0===e||1===e}r.ecsign=function(e,t,r){var i=n.sign(e,t),a=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?a+(2*r+35):a+27}},r.ecrecover=function(e,r,i,s,u){var l=t.concat([a.setLength(i,32),a.setLength(s,32)],64),d=o(r,u);if(!c(d))throw new Error("Invalid signature v value");var h=n.recover(e,l,d);return n.publicKeyConvert(h,!1).slice(1)},r.toRpcSig=function(e,r,n,i){if(!c(o(e,i)))throw new Error("Invalid signature v value");return a.bufferToHex(t.concat([a.setLengthLeft(r,32),a.setLengthLeft(n,32),a.toBuffer(e)]))},r.fromRpcSig=function(e){var t=a.toBuffer(e);if(65!==t.length)throw new Error("Invalid signature length");var r=t[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}},r.isValidSignature=function(e,t,r,n,a){void 0===n&&(n=!0);var s=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),u=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==t.length||32!==r.length)return!1;if(!c(o(e,a)))return!1;var l=new i(t),d=new i(r);return!(l.isZero()||l.gt(u)||d.isZero()||d.gt(u))&&(!n||1!==d.cmp(s))},r.hashPersonalMessage=function(e){var r=t.from("Ethereum Signed Message:\n"+e.length.toString(),"utf-8");return s.keccak(t.concat([r,e]))}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2513,{buffer:1966,"is-hex-prefixed":5175,"strip-hex-prefix":6347},function(){with(this)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("is-hex-prefixed"),i=e("strip-hex-prefix");function a(e){var t=e;if("string"!=typeof t)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof t+", while padToEven.");return t.length%2&&(t="0"+t),t}function s(e){return"0x"+e.toString(16)}t.exports={arrayContainsArray:function(e,t,r){if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof e+"'");if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof t+"'");return t[Boolean(r)?"some":"every"]((function(t){return e.indexOf(t)>=0}))},intToBuffer:function(e){var t=s(e);return new r(a(t.slice(2)),"hex")},getBinarySize:function(e){if("string"!=typeof e)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof e+"'.");return r.byteLength(e,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:a,intToHex:s,fromAscii:function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r).toString(16);t+=n.length<2?"0"+n:n}return"0x"+t},fromUtf8:function(e){return"0x"+a(new r(e,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(e){var t="",r=0,n=e.length;for("0x"===e.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(e.substr(r,2),16);t+=String.fromCharCode(i)}return t},toUtf8:function(e){return new r(a(i(e).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(e,t,r){if(!Array.isArray(e))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof e+"'");if("string"!=typeof t)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof t+"'.");for(var n=[],i=0;i<e.length;i++){var a=e[i][t];if(r&&!a)a="";else if("string"!=typeof a)throw new Error("invalid abi");n.push(a)}return n},isHexString:function(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util>ethjs-util"}],[2514,{},function(){with(this)return function(){"use strict";return function(e,t,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}}}},{package:"ethereumjs-wallet>uuid"}],[2515,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);t.exports=function(){return n(i),i}}else{var a=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}}}},{package:"ethereumjs-wallet>uuid"}],[2516,{"./lib/bytesToUuid":2514,"./lib/rng":2515},function(){with(this)return function(){"use strict";return function(e,t,r){var n=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,r){var a=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var o=0;o<16;++o)t[a+o]=s[o];return t||i(s)}}}},{package:"ethereumjs-wallet>uuid"}],[2517,{"./index.js":2502,"aes-js":1545,crypto:2074,"ethereumjs-util":2507,"safe-buffer":6178,scryptsy:6188,utf8:6427},function(){with(this)return function(){"use strict";return function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=e("./index.js"),a=e("ethereumjs-util"),s=e("crypto"),o=e("scryptsy"),c=e("utf8"),u=e("aes-js"),l=e("safe-buffer").Buffer;function d(e,t){if(!e)throw new Error(t||"Assertion failed")}var h={};h.fromEtherWallet=function(e,t){var r,a="object"===(void 0===e?"undefined":n(e))?e:JSON.parse(e);if(a.locked){if("string"!=typeof t)throw new Error("Password required");if(t.length<7)throw new Error("Password must be at least 7 characters");var o=a.encrypted?a.private.slice(0,128):a.private;if(o=function(e){var t=l.from(e,"base64");return"Salted__"===t.slice(0,8).toString()?{salt:t.slice(8,16),ciphertext:t.slice(16)}:{ciphertext:t}}(o),!o.salt)throw new Error("Unsupported EtherWallet key format");var u=function(e,t,r){function n(n){var i=s.createHash(r.digest||"md5");i.update(n),i.update(e),i.update(t),n=i.digest();for(var a=1;a<(r.count||1);a++)(i=s.createHash(r.digest||"md5")).update(n),n=i.digest();return n}for(var i=r.keysize||16,a=r.ivsize||16,o=[],c=0;l.concat(o).length<i+a;)o[c]=n(0===c?l.alloc(0):o[c-1]),c++;var u=l.concat(o);return{key:u.slice(0,i),iv:u.slice(i,i+a)}}(l.from(t),o.salt,{keysize:32,ivsize:16});r=function(e,t){return l.concat([e.update(t),e.final()])}(s.createDecipheriv("aes-256-cbc",u.key,u.iv),l.from(o.ciphertext)),r=l.from(c.decode(r.toString()),"hex")}else{if(64!==a.private.length)throw new Error("Invalid private key length");r=l.from(a.private,"hex")}var d=new i(r);if(d.getAddressString()!==a.address)throw new Error("Invalid private key or address");return d},h.fromEtherCamp=function(e){return new i(a.keccak256(l.from(e)))},h.fromKryptoKit=function(e,t){"#"===e[0]&&(e=e.slice(1));var r,n=e[0];if(e=e.slice(1),"d"===n)r=a.sha256(l.from(e));else{if("q"!==n)throw new Error("Unsupported or invalid entropy type");if("string"!=typeof t)throw new Error("Password required");var s=a.sha256(l.from(e.slice(0,30))),c=e.slice(30,46),d=function(e){function t(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}for(var r="",n="",i=0;i<e.length;i++)e[i]<=127?(r+=t(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16);return l.from(r+t(n))}(s),h=o(l.from(t,"utf8"),d,16384,8,1,32),f=new u.ModeOfOperation.ecb(h);if(r=l.concat([l.from(f.decrypt(s.slice(0,16))),l.from(f.decrypt(s.slice(16,32)))]),c.length>0&&c!==a.sha256(a.sha256(r)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase")}return new i(r)},h.fromQuorumWallet=function(e,t){d(e.length>=10),d(t.length>=10);var r=e+t;return r=s.pbkdf2Sync(r,r,2e3,32,"sha256"),new i(r)},t.exports=h}}},{package:"ethereumjs-wallet"}],[252,{buffer:1966,"web-encoding":6455},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),{TextEncoder:i,TextDecoder:a}=e("web-encoding"),s=new a,o=new i;t.exports={decodeText:e=>s.decode(e),encodeText:e=>o.encode(e),asBuffer:({buffer:e,byteLength:t,byteOffset:r})=>n.from(e,r,t)}}}},{package:"@ensdomains/content-hash>multihashes>multibase"}],[253,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o||a>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(127&n)<<a:(127&n)*Math.pow(2,a),a+=7}while(n>=128);return e.bytes=s-r,i}}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[254,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function e(t,r,i){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");r=r||[];var a=i=i||0;for(;t>=n;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-a+1,r};var n=Math.pow(2,31)}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[255,{"./decode.js":253,"./encode.js":254,"./length.js":256},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={encode:e("./encode.js"),decode:e("./decode.js"),encodingLength:e("./length.js")}}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[256,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Math.pow(2,7),i=Math.pow(2,14),a=Math.pow(2,21),s=Math.pow(2,28),o=Math.pow(2,35),c=Math.pow(2,42),u=Math.pow(2,49),l=Math.pow(2,56),d=Math.pow(2,63);t.exports=function(e){return e<n?1:e<i?2:e<a?3:e<s?4:e<o?5:e<c?6:e<u?7:e<l?8:e<d?9:10}}}},{package:"@ensdomains/content-hash>multicodec>varint"}],[257,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,cidv1:1,cidv2:2,cidv3:3,ip4:4,tcp:6,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,dccp:33,"murmur3-128":34,"murmur3-32":35,ip6:41,ip6zone:42,path:47,multicodec:48,multihash:49,multiaddr:50,multibase:51,dns:53,dns4:54,dns6:55,dnsaddr:56,protobuf:80,cbor:81,raw:85,"dbl-sha2-256":86,rlp:96,bencode:99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,sctp:132,"dag-jose":133,"dag-cose":134,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"bitcoin-witness-commitment":178,"zcash-block":192,"zcash-tx":193,docid:206,"stellar-block":208,"stellar-tx":209,md4:212,md5:213,bmt:214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,zeronet:230,"secp256k1-pub":231,"bls12_381-g1-pub":234,"bls12_381-g2-pub":235,"x25519-pub":236,"ed25519-pub":237,"bls12_381-g1g2-pub":238,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,udp:273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,udt:301,utp:302,unix:400,p2p:421,ipfs:421,https:443,onion:444,onion3:445,garlic64:446,garlic32:447,tls:448,quic:460,ws:477,wss:478,"p2p-websocket-star":479,http:480,json:512,messagepack:513,"libp2p-peer-record":769,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"p256-pub":4608,"p384-pub":4609,"p521-pub":4610,"ed448-pub":4611,"x448-pub":4612,"ed25519-priv":4864,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082,"zeroxcert-imprint-256":52753,"fil-commitment-unsealed":61697,"fil-commitment-sealed":61698,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332,"skynet-ns":11639056});t.exports={baseTable:n}}}},{package:"@ensdomains/content-hash>multicodec"}],[258,{"./base-table":257},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n)){i[e.toUpperCase().replace(/-/g,"_")]=t}t.exports=Object.freeze(i)}}},{package:"@ensdomains/content-hash>multicodec"}],[259,{"./constants":258,"./int-table":260,"./print":261,"./util":262,"./varint-table":263,"uint8arrays/concat":266,varint:255},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("./int-table"),a=e("./varint-table"),s=e("./util"),o=e("uint8arrays/concat");const c=e("./constants"),u=e("./print");t.exports={addPrefix:function(e,t){let r;if(e instanceof Uint8Array)r=s.varintUint8ArrayEncode(e);else{if(!a[e])throw new Error("multicodec not recognized");r=a[e]}return o([r,t],r.length+t.length)},rmPrefix:function(e){return n.decode(e),e.slice(n.decode.bytes)},getCodec:function(e){const t=n.decode(e),r=i.get(t);if(r===undefined)throw new Error(`Code ${t} not found`);return r},getName:function(e){return i.get(e)},getNumber:function(e){const t=a[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return n.decode(t)},getCode:function(e){return n.decode(e)},getCodeVarint:function(e){const t=a[e];if(t===undefined)throw new Error("Codec `"+e+"` not found");return t},getVarint:function(e){return n.encode(e)},print:u,...c}}}},{package:"@ensdomains/content-hash>multicodec"}],[26,{"./background-api":23,"./caveat-mutators":24,"./enums":25,"./permission-log":27,"./selectors":28,"./specifications":29},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("./caveat-mutators");Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===n[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}}))}));var i=e("./background-api");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===i[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}}))}));var a=e("./enums");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===a[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}}))}));var s=e("./permission-log");Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===s[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return s[e]}}))}));var o=e("./specifications");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===o[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}}))}));var c=e("./selectors");Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in r&&r[e]===c[e]||Object.defineProperty(r,e,{enumerable:!0,get:function(){return c[e]}}))}))}}},{package:"$root$"}],[260,{"./base-table":257},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=new Map;for(const e in n){const t=n[e];i.set(t,e)}t.exports=Object.freeze(i)}}},{package:"@ensdomains/content-hash>multicodec"}],[261,{"./base-table":257},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i={};for(const[e,t]of Object.entries(n))i[t]===undefined&&(i[t]=e);t.exports=Object.freeze(i)}}},{package:"@ensdomains/content-hash>multicodec"}],[262,{"uint8arrays/from-string":267,"uint8arrays/to-string":272,varint:255},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("varint"),i=e("uint8arrays/to-string"),a=e("uint8arrays/from-string");function s(e){return parseInt(i(e,"base16"),16)}t.exports={numberToUint8Array:function(e){let t=e.toString(16);t.length%2==1&&(t="0"+t);return a(t,"base16")},uint8ArrayToNumber:s,varintUint8ArrayEncode:function(e){return Uint8Array.from(n.encode(s(e)))},varintEncode:function(e){return Uint8Array.from(n.encode(e))}}}}},{package:"@ensdomains/content-hash>multicodec"}],[263,{"./base-table":257,"./util":262},function(){with(this)return function(){"use strict";return function(e,t,r){const{baseTable:n}=e("./base-table"),i=e("./util").varintEncode,a={};for(const e in n){const t=n[e];a[e]=i(t)}t.exports=Object.freeze(a)}}},{package:"@ensdomains/content-hash>multicodec"}],[264,{},function(){with(this)return function(){"use strict";return function(e,t,r){const n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});t.exports={names:n}}}},{package:"@ensdomains/content-hash>multihashes"}],[265,{"./constants":264,buffer:1966,multibase:250,varint:6451,"web-encoding":6455},function(){with(this)return function(){"use strict";return function(e,t,r){const{Buffer:n}=e("buffer"),i=e("multibase"),a=e("varint"),{names:s}=e("./constants"),{TextDecoder:o}=e("web-encoding"),c=new o,u={};for(const e in s)u[s[e]]=e;function l(e){r.decode(e)}r.names=s,r.codes=Object.freeze(u),r.toHexString=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return(n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength)).toString("hex")},r.fromHexString=function(e){return n.from(e,"hex")},r.toB58String=function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return c.decode(i.encode("base58btc",e)).slice(1)},r.fromB58String=function(e){const t=e instanceof Uint8Array?c.decode(e):e;return i.decode("z"+t)},r.decode=function(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");let t=n.isBuffer(e)?e:n.from(e.buffer,e.byteOffset,e.byteLength);if(t.length<2)throw new Error("multihash too short. must be > 2 bytes.");const i=a.decode(t);if(!r.isValidCode(i))throw new Error(`multihash unknown function code: 0x${i.toString(16)}`);t=t.slice(a.decode.bytes);const s=a.decode(t);if(s<0)throw new Error(`multihash invalid length: ${s}`);if(t=t.slice(a.decode.bytes),t.length!==s)throw new Error(`multihash length inconsistent: 0x${t.toString("hex")}`);return{code:i,name:u[i],length:s,digest:t}},r.encode=function(e,t,i){if(!e||t===undefined)throw new Error("multihash encode requires at least two args: digest, code");const s=r.coerceCode(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");const o=a.encode(s),c=a.encode(i),u=n.alloc(o.length+c.length+e.length);return u.set(o,0),u.set(c,o.length),u.set(e,o.length+c.length),u},r.coerceCode=function(e){let t=e;if("string"==typeof e){if(s[e]===undefined)throw new Error(`Unrecognized hash function named: ${e}`);t=s[e]}if("number"!=typeof t)throw new Error(`Hash function code should be a number. Got: ${t}`);if(u[t]===undefined&&!r.isAppCode(t))throw new Error(`Unrecognized function code: ${t}`);return t},r.isAppCode=function(e){return e>0&&e<16},r.isValidCode=function(e){return!!r.isAppCode(e)||!!u[e]},r.validate=l,r.prefix=function(e){return l(e),n.from(e.buffer,e.byteOffset,2)}}}},{package:"@ensdomains/content-hash>multihashes"}],[266,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays"}],[267,{"multibase/src/constants":269,"web-encoding":6455},function(){with(this)return function(){"use strict";return function(e,t,r){const{names:n}=e("multibase/src/constants"),{TextEncoder:i}=e("web-encoding"),a=new i;t.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return a.encode(e);if("ascii"===t)return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.decode(e)}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays"}],[268,{"./util":271},function(){with(this)return function(){"use strict";return function(e,t,r){const{encodeText:n}=e("./util");t.exports=class{constructor(e,t,r,i){this.name=e,this.code=t,this.codeBuf=n(this.code),this.alphabet=i,this.codec=r(i)}encode(e){return this.codec.encode(e)}decode(e){for(const t of e)if(this.alphabet&&this.alphabet.indexOf(t)<0)throw new Error(`invalid character '${t}' in '${e}'`);return this.codec.decode(e)}}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[269,{"./base.js":268,"./rfc4648":270,"./util":271,"@multiformats/base-x":1322},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("@multiformats/base-x"),i=e("./base.js"),{rfc4648:a}=e("./rfc4648"),{decodeText:s,encodeText:o}=e("./util"),c=[["identity","\0",()=>({encode:s,decode:o}),""],["base2","0",a(1),"01"],["base8","7",a(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",a(4),"0123456789abcdef"],["base16upper","F",a(4),"0123456789ABCDEF"],["base32hex","v",a(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",a(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",a(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",a(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",a(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=c.reduce(((e,t)=>(e[t[0]]=new i(t[0],t[1],t[2],t[3]),e)),{}),l=c.reduce(((e,t)=>(e[t[1]]=u[t[0]],e)),{});t.exports={names:u,codes:l}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[27,{"../../../../shared/constants/permissions":6590,"./enums":25,"@metamask/obs-store":1217},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogController=void 0;var n=e("@metamask/obs-store"),i=e("../../../../shared/constants/permissions"),a=e("./enums");function s(e,t){return e.reduce(((e,r)=>({...e,[r]:t})),{})}r.PermissionLogController=class{constructor({restrictedMethods:e,initState:t}){this.restrictedMethods=e,this.store=new n.ObservableStore({permissionHistory:{},permissionActivityLog:[],...t})}getActivityLog(){return this.store.getState().permissionActivityLog}updateActivityLog(e){this.store.updateState({permissionActivityLog:e})}getHistory(){return this.store.getState().permissionHistory}updateHistory(e){this.store.updateState({permissionHistory:e})}updateAccountsHistory(e,t){if(0===t.length)return;const r=s(t,Date.now());this.commitNewHistory(e,{eth_accounts:{accounts:r}})}createMiddleware(){return(e,t,r,n)=>{let i,s;const{origin:o,method:c}=e,u=c.startsWith(a.WALLET_PREFIX);if(a.LOG_IGNORE_METHODS.includes(c)||!u&&!this.restrictedMethods.has(c)){if("eth_requestAccounts"!==c)return void r();i=this.logRequest(e,u),s=["eth_accounts"]}else i=this.logRequest(e,u),c===`${a.WALLET_PREFIX}requestPermissions`&&(s=this.getRequestedMethods(e));r((e=>{const r=Date.now();this.logResponse(i,t,r),s&&!t.error&&t.result&&this.logPermissionsHistory(s,o,t.result,r,"eth_requestAccounts"===c),e()}))}}logRequest(e,t){const r={id:e.id,method:e.method,methodType:t?a.LOG_METHOD_TYPES.internal:a.LOG_METHOD_TYPES.restricted,origin:e.origin,requestTime:Date.now(),responseTime:null,success:null};return this.commitNewActivity(r),r}logResponse(e,t,r){e&&t&&(e.success=Object.hasOwnProperty.call(t,"result"),e.responseTime=r)}commitNewActivity(e){const t=this.getActivityLog();t.push(e),t.length>a.LOG_LIMIT&&t.shift(),this.updateActivityLog(t)}logPermissionsHistory(e,t,r,n,i){let a,o;if(i){a=r;o={eth_accounts:{accounts:s(a,n),lastApproved:n}}}else o=r.map((e=>("eth_accounts"===e.parentCapability&&(a=this.getAccountsFromPermission(e)),e.parentCapability))).reduce(((t,r)=>{if(e.includes(r))if("eth_accounts"===r){const e=s(a,n);t[r]={lastApproved:n,accounts:e}}else t[r]={lastApproved:n};return t}),{});Object.keys(o).length>0&&this.commitNewHistory(t,o)}commitNewHistory(e,t){const r=this.getHistory(),n={...r[e],...t},i=r[e]&&r[e].eth_accounts,a=t.eth_accounts;if(i&&a){const e=a.lastApproved||i.lastApproved;n.eth_accounts={lastApproved:e,accounts:{...i.accounts,...a.accounts}}}r[e]=n,this.updateHistory(r)}getRequestedMethods(e){return e.params&&e.params[0]&&"object"==typeof e.params[0]&&!Array.isArray(e.params[0])?Object.keys(e.params[0]):null}getAccountsFromPermission(e){if("eth_accounts"!==e.parentCapability||!e.caveats)return[];const t=new Set;for(const r of e.caveats)if(r.type===i.CaveatTypes.restrictReturnedAccounts&&Array.isArray(r.value))for(const e of r.value)t.add(e);return[...t]}}}}},{package:"$root$"}],[270,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={rfc4648:e=>t=>({encode:r=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let a="",s=0,o=0;for(let n=0;n<e.length;++n)for(o=o<<8|e[n],s+=8;s>r;)s-=r,a+=t[i&o>>s];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a})(r,t,e),decode:r=>((e,t,r)=>{const n={};for(let e=0;e<t.length;++e)n[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const a=new Uint8Array(i*r/8|0);let s=0,o=0,c=0;for(let t=0;t<i;++t){const i=n[e[t]];if(i===undefined)throw new SyntaxError("Invalid character "+e[t]);o=o<<r|i,s+=r,s>=8&&(s-=8,a[c++]=255&o>>s)}if(s>=r||255&o<<8-s)throw new SyntaxError("Unexpected end of data");return a})(r,t,e)})}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[271,{"web-encoding":6455},function(){with(this)return function(){"use strict";return function(e,t,r){const{TextEncoder:n,TextDecoder:i}=e("web-encoding"),a=new i,s=new n;t.exports={decodeText:e=>a.decode(e),encodeText:e=>s.encode(e),concat:function(e,t){const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays>multibase"}],[272,{"multibase/src/constants":269,"web-encoding":6455},function(){with(this)return function(){"use strict";return function(e,t,r){const{names:n}=e("multibase/src/constants"),{TextDecoder:i}=e("web-encoding"),a=new i("utf8");t.exports=function(e,t="utf8"){if("utf8"===t||"utf-8"===t)return a.decode(e);if("ascii"===t)return function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e);const r=n[t];if(!r)throw new Error("Unknown base");return r.encode(e)}}}},{package:"@ensdomains/content-hash>multicodec>uint8arrays"}],[273,{cids:247},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("cids");r.cidForWeb=e=>{let t=new n(e);0===t.version&&(t=t.toV1());let r=t.toString("base32");if(r.length>63){const e=t.toString("base36");if(e.length<=63)return e;throw new TypeError("CID is longer than DNS limit of 63 characters and is not compatible with public gateways")}return r};r.cidV0ToV1Base32=e=>{let t=new n(e);return 0===t.version&&(t=t.toV1()),t.toString("base32")}}}},{package:"@ensdomains/content-hash"}],[274,{"./helpers":273,"./profiles":275,multicodec:259,multihashes:265},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("multicodec"),i=e("multihashes"),{hexStringToBuffer:a,profiles:s}=e("./profiles"),{cidForWeb:o,cidV0ToV1Base32:c}=e("./helpers");t.exports={helpers:{cidForWeb:o,cidV0ToV1Base32:c},decode:function(e){const t=a(e),r=n.getCodec(t),i=n.rmPrefix(t);let o=s[r];return o||(o=s.default),o.decode(i)},fromIpfs:function(e){return this.encode("ipfs-ns",e)},fromSkylink:function(e){return this.encode("skynet-ns",e)},fromSwarm:function(e){return this.encode("swarm-ns",e)},encode:function(e,t){let r=s[e];r||(r=s.default);const a=r.encode(t);return i.toHexString(n.addPrefix(e,a))},getCodec:function(e){let t=a(e);return n.getCodec(t)}}}}},{package:"@ensdomains/content-hash"}],[275,{buffer:1966,cids:247,"js-base64":5197,multihashes:265},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){const n=e("cids"),i=e("multihashes"),a=e("js-base64"),s=e=>{let t=e.slice(0,2),r=e.slice(2),n="";return n="0x"===t?r:e,i.fromHexString(n)},o=e=>{try{const{multihash:t}=e;if(t.length<38){const e=i.decode(t);if("identity"===e.name&&e.length<36)return!1}return!0}catch(e){return!1}return!1},c={skynet:e=>a.toUint8Array(e),swarm:e=>{const t=i.encode(s(e),"keccak-256");return new n(1,"swarm-manifest",t).bytes},ipfs:e=>new n(e).toV1().bytes,ipns:e=>{const t=new n(e);if(!o(t))throw Error("ipns-ns allows only valid cryptographic libp2p-key identifiers, try using ED25519 pubkey instead");return new n(1,"libp2p-key",t.multihash).bytes},utf8:e=>t.from(e,"utf8")},u={hexMultiHash:e=>{const t=new n(e);return i.decode(t.multihash).digest.toString("hex")},ipfs:e=>{const t=new n(e).toV1();return t.toString("libp2p-key"===t.codec?"base36":"base32")},ipns:e=>{const t=new n(e).toV1();return o(t)?t.toString("base36"):(console.warn("[ensdomains/content-hash] use of non-cryptographic identifiers in ipns-ns is deprecated and will be removed, migrate to ED25519 libp2p-key"),String(i.decode(new n(e).multihash).digest))},utf8:e=>e.toString("utf8"),base64:e=>a.fromUint8Array(e,!0)},l={"skynet-ns":{encode:c.skynet,decode:u.base64},"swarm-ns":{encode:c.swarm,decode:u.hexMultiHash},"ipfs-ns":{encode:c.ipfs,decode:u.ipfs},"ipns-ns":{encode:c.ipns,decode:u.ipns},default:{encode:c.utf8,decode:u.utf8}};r.hexStringToBuffer=s,r.profiles=l}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@ensdomains/content-hash"}],[28,{"../../../../shared/constants/permissions":6590,reselect:6169},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var n=e("reselect"),i=e("../../../../shared/constants/permissions");const a=(0,n.createSelector)((e=>e.subjects),(e=>Object.values(e).reduce(((e,t)=>{var r,n;const a=null===(r=t.permissions)||void 0===r||null===(n=r.eth_accounts)||void 0===n?void 0:n.caveats.find((({type:e})=>e===i.CaveatTypes.restrictReturnedAccounts));return a&&e.set(t.origin,a.value),e}),new Map)));r.getPermittedAccountsByOrigin=a;r.getChangedAccounts=(e,t)=>{if(t===undefined)return e;const r=new Map;if(e===t)return r;const n=new Set([...e.keys()]);for(const a of t.keys()){var i;const s=null!==(i=e.get(a))&&void 0!==i?i:[];t.get(a)!==s&&r.set(a,s),n.delete(a)}for(const t of n.keys())r.set(t,e.get(t));return r}}}},{package:"$root$"}],[29,{"../../../../shared/constants/permissions":6590,"@metamask/controllers":1071},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var n=e("@metamask/controllers"),i=e("../../../../shared/constants/permissions");const a=Object.freeze({...i.RestrictedMethods}),s=Object.freeze({[i.CaveatTypes.restrictReturnedAccounts]:e=>({type:i.CaveatTypes.restrictReturnedAccounts,value:e})});r.getCaveatSpecifications=({getIdentities:e})=>({[i.CaveatTypes.restrictReturnedAccounts]:{type:i.CaveatTypes.restrictReturnedAccounts,decorator:(e,t)=>async r=>(await e(r)).filter((e=>t.value.includes(e))).slice(0,1),validator:(t,r,n)=>function(e,t){if(!Array.isArray(e)||0===e.length)throw new Error(`${a.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=t();e.forEach((e=>{if(!e||"string"!=typeof e)throw new Error(`${a.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${e}".`);if(!r[e])throw new Error(`${a.eth_accounts} error: Received unrecognized address: "${e}".`)}))}(t.value,e)}});r.getPermissionSpecifications=({getAllAccounts:e,getIdentities:t,captureKeyringTypesWithMissingIdentities:r})=>({[a.eth_accounts]:{permissionType:n.PermissionType.RestrictedMethod,targetKey:a.eth_accounts,allowedCaveats:[i.CaveatTypes.restrictReturnedAccounts],factory:(e,t)=>{if(Array.isArray(e.caveats))throw new Error(`${a.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!t.approvedAccounts)throw new Error(`${a.eth_accounts} error: No approved accounts specified.`);return(0,n.constructPermission)({...e,caveats:[s[i.CaveatTypes.restrictReturnedAccounts](t.approvedAccounts)]})},methodImplementation:async n=>{const i=await e(),a=t();return i.sort(((e,t)=>{if(!a[e])throw r(a,i),new Error(`Missing identity for address: "${e}".`);if(!a[t])throw r(a,i),new Error(`Missing identity for address: "${t}".`);return a[e].lastSelected===a[t].lastSelected?0:a[e].lastSelected===undefined?1:a[t].lastSelected===undefined?-1:a[t].lastSelected-a[e].lastSelected}))},validator:(e,t,r)=>{const{caveats:n}=e;if(!n||1!==n.length||n[0].type!==i.CaveatTypes.restrictReturnedAccounts)throw new Error(`${a.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${i.CaveatTypes.restrictReturnedAccounts}".`)}}});const o=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3"]);r.unrestrictedMethods=o}}},{package:"$root$"}],[2945,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Object.prototype.hasOwnProperty,i="~";function a(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,r,n,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new s(r,n||e,a),c=i?i+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function u(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(i=!1)),u.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)n.call(e,t)&&r.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},u.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,s=new Array(a);n<a;n++)s[n]=r[n].fn;return s},u.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},u.prototype.emit=function(e,t,r,n,a,s){var o=i?i+e:e;if(!this._events[o])return!1;var c,u,l=this._events[o],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,undefined,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,a),!0;case 6:return l.fn.call(l.context,t,r,n,a,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,undefined,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,n);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},u.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},u.prototype.removeListener=function(e,t,r,n){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return c(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||n&&!s.once||r&&s.context!==r||c(this,a);else{for(var o=0,u=[],l=s.length;o<l;o++)(s[o].fn!==t||n&&!s[o].once||r&&s[o].context!==r)&&u.push(s[o]);u.length?this._events[a]=1===u.length?u[0]:u:c(this,a)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&c(this,t)):(this._events=new a,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,void 0!==t&&(t.exports=u)}}},{package:"mockttp>@httptoolkit/subscriptions-transport-ws>eventemitter3"}],[30,{"../../../shared/constants/hardware-wallets":6586,"../../../shared/constants/network":6589,"../../../shared/modules/network.utils":6612,"./network":18,"@metamask/obs-store":1217,assert:1594,"eth-sig-util":2423,ethers:2520,loglevel:5639},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=e("assert"),a=e("@metamask/obs-store"),s=e("eth-sig-util"),o=e("ethers"),c=(n=e("loglevel"))&&n.__esModule?n:{default:n},u=e("../../../shared/constants/network"),l=e("../../../shared/modules/network.utils"),d=e("../../../shared/constants/hardware-wallets"),h=e("./network");r.default=class{constructor(e={}){const t={frequentRpcListDetail:[],useBlockie:!1,useNonceField:!1,usePhishDetect:!0,dismissSeedBackUpReminder:!1,useTokenDetection:!1,useCollectibleDetection:!1,openSeaEnabled:!1,advancedGasFee:null,featureFlags:{showIncomingTransactions:!0},knownMethodData:{},currentLocale:e.initLangCode,identities:{},lostIdentities:{},forgottenPassword:!1,preferences:{autoLockTimeLimit:undefined,showFiatInTestnets:!1,showTestNetworks:!1,useNativeCurrencyAsPrimaryCurrency:!0,hideZeroBalanceTokens:!1},ipfsGateway:u.IPFS_DEFAULT_GATEWAY_URL,infuraBlocked:null,ledgerTransportType:window.navigator.hid?d.LEDGER_TRANSPORT_TYPES.WEBHID:d.LEDGER_TRANSPORT_TYPES.U2F,theme:"light",...e.initState};this.network=e.network,this.ethersProvider=new o.ethers.providers.Web3Provider(e.provider),this.store=new a.ObservableStore(t),this.store.setMaxListeners(12),this.openPopup=e.openPopup,this.migrateAddressBookState=e.migrateAddressBookState,this.tokenListController=e.tokenListController,this._subscribeToInfuraAvailability(),global.setPreference=(e,t)=>this.setFeatureFlag(e,t)}setPasswordForgotten(e){this.store.updateState({forgottenPassword:e})}setUseBlockie(e){this.store.updateState({useBlockie:e})}setUseNonceField(e){this.store.updateState({useNonceField:e})}setUsePhishDetect(e){this.store.updateState({usePhishDetect:e})}setUseTokenDetection(e){this.store.updateState({useTokenDetection:e}),this.tokenListController.updatePreventPollingOnNetworkRestart(!e),e?this.tokenListController.start():(this.tokenListController.clearingTokenListData(),this.tokenListController.stop())}setUseCollectibleDetection(e){this.store.updateState({useCollectibleDetection:e})}setOpenSeaEnabled(e){this.store.updateState({openSeaEnabled:e})}setAdvancedGasFee(e){this.store.updateState({advancedGasFee:e})}setEIP1559V2Enabled(e){this.store.updateState({eip1559V2Enabled:e})}setTheme(e){this.store.updateState({theme:e})}addKnownMethodData(e,t){const{knownMethodData:r}=this.store.getState();r[e]=t,this.store.updateState({knownMethodData:r})}setCurrentLocale(e){const t=["ar","dv","fa","he","ku"].includes(e)?"rtl":"auto";return this.store.updateState({currentLocale:e,textDirection:t}),t}setAddresses(e){const t=this.store.getState().identities,r=e.reduce(((e,r,n)=>{const i=t[r]||{};return e[r]={name:`Account ${n+1}`,address:r,...i},e}),{});this.store.updateState({identities:r})}removeAddress(e){const{identities:t}=this.store.getState();if(!t[e])throw new Error(`${e} can't be deleted cause it was not found`);if(delete t[e],this.store.updateState({identities:t}),e===this.getSelectedAddress()){const[e]=Object.keys(t);this.setSelectedAddress(e)}return e}addAddresses(e){const{identities:t}=this.store.getState();e.forEach((e=>{if(t[e])return;const r=Object.keys(t).length;t[e]={name:`Account ${r+1}`,address:e}})),this.store.updateState({identities:t})}syncAddresses(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array of addresses. Error #11201");const{identities:t,lostIdentities:r}=this.store.getState(),n={};Object.keys(t).forEach((r=>{e.includes(r)||(n[r]=t[r],delete t[r])})),Object.keys(n).length>0&&Object.keys(n).forEach((e=>{r[e]=n[e]})),this.store.updateState({identities:t,lostIdentities:r}),this.addAddresses(e);let i=this.getSelectedAddress();return e.includes(i)||([i]=e,this.setSelectedAddress(i)),i}setSelectedAddress(e){const t=(0,s.normalize)(e),{identities:r}=this.store.getState(),n=r[t];if(!n)throw new Error(`Identity for '${t} not found`);n.lastSelected=Date.now(),this.store.updateState({identities:r,selectedAddress:t})}getSelectedAddress(){return this.store.getState().selectedAddress}setAccountLabel(e,t){if(!e)throw new Error(`setAccountLabel requires a valid address, got ${String(e)}`);const r=(0,s.normalize)(e),{identities:n}=this.store.getState();return n[r]=n[r]||{},n[r].name=t,this.store.updateState({identities:n}),Promise.resolve(t)}async updateRpc(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e.rpcUrl));if(r>-1){const n=t[r],a={...n,...e};if(n.chainId!==a.chainId){let r=n.chainId;if(!r)try{r=await this.ethersProvider.send("net_version"),(0,i.strict)("string"==typeof r)}catch(e){c.default.debug(e),c.default.warn(`Failed to get networkId from ${n.rpcUrl}; skipping address book migration`)}let s=!1;const o=Object.values(u.BUILT_IN_NETWORKS).map((e=>e.networkId)),l=t.filter((t=>t.rpcUrl!==e.rpcUrl));(o.includes(r)||l.some((e=>e.chainId===r)))&&(s=!0),this.migrateAddressBookState(r,a.chainId,s)}t[r]=a,this.store.updateState({frequentRpcListDetail:t})}else{const{rpcUrl:t,chainId:r,ticker:n,nickname:i,rpcPrefs:a={}}=e;this.addToFrequentRpcList(t,r,n,i,a)}}addToFrequentRpcList(e,t,r="ETH",n="",i={}){const a=this.getFrequentRpcListDetail(),s=a.findIndex((t=>t.rpcUrl===e));if(-1!==s&&a.splice(s,1),!(0,l.isPrefixedFormattedHexString)(t))throw new Error(`Invalid chainId: "${t}"`);a.push({rpcUrl:e,chainId:t,ticker:r,nickname:n,rpcPrefs:i}),this.store.updateState({frequentRpcListDetail:a})}removeFromFrequentRpcList(e){const t=this.getFrequentRpcListDetail(),r=t.findIndex((t=>t.rpcUrl===e));return-1!==r&&t.splice(r,1),this.store.updateState({frequentRpcListDetail:t}),Promise.resolve(t)}getFrequentRpcListDetail(){return this.store.getState().frequentRpcListDetail}setFeatureFlag(e,t){const r={...this.store.getState().featureFlags,[e]:t};return this.store.updateState({featureFlags:r}),Promise.resolve(r)}setPreference(e,t){const r={...this.getPreferences(),[e]:t};return this.store.updateState({preferences:r}),Promise.resolve(r)}getPreferences(){return this.store.getState().preferences}getIpfsGateway(){return this.store.getState().ipfsGateway}setIpfsGateway(e){return this.store.updateState({ipfsGateway:e}),Promise.resolve(e)}setLedgerTransportPreference(e){return this.store.updateState({ledgerTransportType:e}),e}getLedgerTransportPreference(){return this.store.getState().ledgerTransportType}async setDismissSeedBackUpReminder(e){await this.store.updateState({dismissSeedBackUpReminder:e})}_subscribeToInfuraAvailability(){this.network.on(h.NETWORK_EVENTS.INFURA_IS_BLOCKED,(()=>{this._setInfuraBlocked(!0)})),this.network.on(h.NETWORK_EVENTS.INFURA_IS_UNBLOCKED,(()=>{this._setInfuraBlocked(!1)}))}_setInfuraBlocked(e){const{infuraBlocked:t}=this.store.getState();t!==e&&this.store.updateState({infuraBlocked:e})}}}}},{package:"$root$"}],[31,{"../../../shared/constants/gas":6585,"../../../shared/constants/smartTransactions":6592,"../../../shared/constants/swaps":6593,"../../../shared/constants/time":6594,"../../../shared/lib/fetch-with-cache":6598,"../../../shared/lib/swaps-utils":6601,"../../../shared/lib/transactions-controller-utils":6603,"../../../shared/modules/conversion.utils":6607,"../../../shared/modules/string-utils":6617,"../../../shared/modules/swaps.utils":6618,"./network":18,"@metamask/obs-store":1217,"bignumber.js":1854,ethers:2520,"human-standard-token-abi":4867,lodash:5626,loglevel:5639},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.default=void 0;var n=e("ethers"),i=w(e("loglevel")),a=w(e("bignumber.js")),s=e("@metamask/obs-store"),o=e("lodash"),c=w(e("human-standard-token-abi")),u=e("../../../shared/modules/conversion.utils"),l=e("../../../shared/constants/swaps"),d=e("../../../shared/constants/gas"),h=e("../../../shared/constants/smartTransactions"),f=e("../../../shared/modules/swaps.utils"),p=e("../../../shared/lib/swaps-utils"),m=w(e("../../../shared/lib/fetch-with-cache")),g=e("../../../shared/constants/time"),v=e("../../../shared/modules/string-utils"),b=e("../../../shared/lib/transactions-controller-utils"),y=e("./network");function w(e){return e&&e.__esModule?e:{default:e}}const E=25e5,k=g.MINUTE;function S(e=25e5,t=0,r=0){const n=new a.default(e,10).minus(t,10);return!n.lt(0)&&n.lt(r,16)?`0x${n.toString(16)}`:r}const T={quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:k,swapsQuotePrefetchingRefreshTime:k,swapsStxBatchStatusRefreshTime:h.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxGetTransactionsRefreshTime:h.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxMaxFeeMultiplier:h.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,swapsFeatureFlags:{}};function _(e){if(!Array.isArray(e)||0===e.length)throw new Error("Expected non-empty array param.");const t=[...e];if(t.sort(((e,t)=>{const r=new a.default(e.overallValueOfQuote,10),n=new a.default(t.overallValueOfQuote,10);return r.equals(n)?0:r.lessThan(n)?-1:1})),t.length%2==1){const e=t[(t.length-1)/2].overallValueOfQuote;return x(t.filter((t=>e===t.overallValueOfQuote)))}const r=t.length/2,n=r-1,i=t[r].overallValueOfQuote,s=t[n].overallValueOfQuote,o=t.filter((e=>i===e.overallValueOfQuote)),c=t.filter((e=>s===e.overallValueOfQuote)),u=x(o),l=x(c);return{ethFee:new a.default(u.ethFee,10).plus(l.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new a.default(u.metaMaskFeeInEth,10).plus(l.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new a.default(u.ethValueOfTokens,10).plus(l.ethValueOfTokens,10).dividedBy(2).toString(10)}}function x(e){const t=e.reduce(((e,t)=>({ethFee:e.ethFee.plus(t.ethFee,10),metaMaskFeeInEth:e.metaMaskFeeInEth.plus(t.metaMaskFeeInEth,10),ethValueOfTokens:e.ethValueOfTokens.plus(t.ethValueOfTokens,10)})),{ethFee:new a.default(0,10),metaMaskFeeInEth:new a.default(0,10),ethValueOfTokens:new a.default(0,10)});return{ethFee:t.ethFee.div(e.length,10).toString(10),metaMaskFeeInEth:t.metaMaskFeeInEth.div(e.length,10).toString(10),ethValueOfTokens:t.ethValueOfTokens.div(e.length,10).toString(10)}}r.default=class{constructor({getBufferedGasLimit:e,networkController:t,provider:r,getProviderConfig:i,getTokenRatesState:a,fetchTradesInfo:o=p.fetchTradesInfo,getCurrentChainId:c,getEIP1559GasFeeEstimates:u}){this.store=new s.ObservableStore({swapsState:{...T}}),this._fetchTradesInfo=o,this._getCurrentChainId=c,this._getEIP1559GasFeeEstimates=u,this.getBufferedGasLimit=e,this.getTokenRatesState=a,this.pollCount=0,this.getProviderConfig=i,this.indexOfNewestCallInFlight=0,this.ethersProvider=new n.ethers.providers.Web3Provider(r),this._currentNetwork=t.store.getState().network,t.on(y.NETWORK_EVENTS.NETWORK_DID_CHANGE,(e=>{"loading"!==e&&e!==this._currentNetwork&&(this._currentNetwork=e,this.ethersProvider=new n.ethers.providers.Web3Provider(r))}))}async fetchSwapsNetworkConfig(e){const t=await(0,m.default)((0,p.getBaseApi)("network",e),{method:"GET"},{cacheRefreshTime:6e5}),{refreshRates:r,parameters:n={}}=t||{};if(!r||"number"!=typeof r.quotes||"number"!=typeof r.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${t}`);return{quotes:1e3*r.quotes,quotesPrefetching:1e3*r.quotesPrefetching,stxGetTransactions:1e3*r.stxGetTransactions,stxBatchStatus:1e3*r.stxBatchStatus,stxStatusDeadline:r.stxStatusDeadline,stxMaxFeeMultiplier:n.stxMaxFeeMultiplier}}async _setSwapsNetworkConfig(){var e,t,r,n,i,a;const s=this._getCurrentChainId();let o;try{o=await this.fetchSwapsNetworkConfig(s)}catch(e){console.error("Request for Swaps network config failed: ",e)}const{swapsState:c}=this.store.getState();this.store.updateState({swapsState:{...c,swapsQuoteRefreshTime:(null===(e=o)||void 0===e?void 0:e.quotes)||k,swapsQuotePrefetchingRefreshTime:(null===(t=o)||void 0===t?void 0:t.quotesPrefetching)||k,swapsStxGetTransactionsRefreshTime:(null===(r=o)||void 0===r?void 0:r.stxGetTransactions)||h.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxBatchStatusRefreshTime:(null===(n=o)||void 0===n?void 0:n.stxBatchStatus)||h.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxStatusDeadline:(null===(i=o)||void 0===i?void 0:i.stxStatusDeadline)||h.FALLBACK_SMART_TRANSACTIONS_DEADLINE,swapsStxMaxFeeMultiplier:(null===(a=o)||void 0===a?void 0:a.stxMaxFeeMultiplier)||h.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER}})}pollForNewQuotes(){const{swapsState:{swapsQuoteRefreshTime:e,swapsQuotePrefetchingRefreshTime:t,quotesPollingLimitEnabled:r}}=this.store.getState(),n=r?e:t;this.pollingTimeout=setTimeout((()=>{var e;const{swapsState:t}=this.store.getState();this.fetchAndSetQuotes(t.fetchParams,null===(e=t.fetchParams)||void 0===e?void 0:e.metaData,!0)}),n)}stopPollingForQuotes(){this.pollingTimeout&&clearTimeout(this.pollingTimeout)}async fetchAndSetQuotes(e,t={},r){const{chainId:n}=t,{swapsState:{quotesPollingLimitEnabled:i,saveFetchedQuotes:a}}=this.store.getState();if(!e)return null;r||(this.pollCount=0),clearTimeout(this.pollingTimeout),r||this.setSwapsErrorKey("");const s=this.indexOfNewestCallInFlight+1;this.indexOfNewestCallInFlight=s,a||this.setSaveFetchedQuotes(!0);let[c]=await Promise.all([this._fetchTradesInfo(e,{...t}),this._setSwapsNetworkConfig()]);const{swapsState:{saveFetchedQuotes:u}}=this.store.getState();if(!u)return[{},null];c=(0,o.mapValues)(c,(e=>({...e,sourceTokenInfo:t.sourceTokenInfo,destinationTokenInfo:t.destinationTokenInfo})));const d=Date.now();let h=!1;if(!(0,f.isSwapsDefaultTokenAddress)(e.sourceToken,n)&&Object.values(c).length){const t=await this._getERC20Allowance(e.sourceToken,e.fromAddress,n),[i]=Object.values(c);if(h=i.approvalNeeded&&t.eq(0)&&"wrappedNative"!==i.aggregator,h){if(!r){const{gasLimit:e}=await this.timedoutGasReturn(i.approvalNeeded);c=(0,o.mapValues)(c,(t=>({...t,approvalNeeded:{...t.approvalNeeded,gas:e||l.DEFAULT_ERC20_APPROVE_GAS}})))}}else c=(0,o.mapValues)(c,(e=>({...e,approvalNeeded:null})))}let p=null;if(h||null!=e&&e.balanceError||(c=await this.getAllQuotesWithGasEstimates(c)),0===Object.values(c).length)this.setSwapsErrorKey(l.QUOTES_NOT_AVAILABLE_ERROR);else{const[e,t]=await this._findTopQuoteAndCalculateSavings(c);p=e,c=t}if(this.indexOfNewestCallInFlight!==s)throw new Error(l.SWAPS_FETCH_ORDER_CONFLICT);const{swapsState:m}=this.store.getState();let{selectedAggId:g}=m;return c[g]||(g=null),this.store.updateState({swapsState:{...m,quotes:c,fetchParams:{...e,metaData:t},quotesLastFetched:d,selectedAggId:g,topAggId:p}}),i&&(this.pollCount+=1),!i||this.pollCount<4?(this.pollForNewQuotes(),[c,p]):(this.resetPostFetchState(),this.setSwapsErrorKey(l.QUOTES_EXPIRED_ERROR),null)}safeRefetchQuotes(){const{swapsState:e}=this.store.getState();!this.pollingTimeout&&e.fetchParams&&this.fetchAndSetQuotes(e.fetchParams)}setSelectedQuoteAggId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,selectedAggId:e}})}setSwapsTokens(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,tokens:e}})}clearSwapsQuotes(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,quotes:{}}})}setSwapsErrorKey(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,errorKey:e}})}async getAllQuotesWithGasEstimates(e){const t=await Promise.all(Object.values(e).map((async e=>{const{gasLimit:t,simulationFails:r}=await this.timedoutGasReturn(e.trade);return[t,r,e.aggregator]}))),r={};return t.forEach((([t,n,i])=>{if(t&&!n){const n=S(e[i].maxGas,e[i].estimatedRefund,t);r[i]={...e[i],gasEstimate:t,gasEstimateWithRefund:n}}else e[i].approvalNeeded&&(r[i]=e[i])})),r}timedoutGasReturn(e){return new Promise((t=>{let r=!1;const n=setTimeout((()=>{r=!0,t({gasLimit:null,simulationFails:!0})}),5*g.SECOND),a={data:e.data,from:e.from,to:e.to,value:e.value};this.getBufferedGasLimit({txParams:a},1).then((({gasLimit:e,simulationFails:i})=>{r||(clearTimeout(n),t({gasLimit:e,simulationFails:i}))})).catch((e=>{i.default.error(e),r||(clearTimeout(n),t({gasLimit:null,simulationFails:!0}))}))}))}async setInitialGasEstimate(e){const{swapsState:t}=this.store.getState(),r={...t.quotes[e]},{gasLimit:n,simulationFails:i}=await this.timedoutGasReturn(r.trade);if(n&&!i){const e=S(r.maxGas,r.estimatedRefund,n);r.gasEstimate=n,r.gasEstimateWithRefund=e}this.store.updateState({swapsState:{...t,quotes:{...t.quotes,[e]:r}}})}setApproveTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,approveTxId:e}})}setTradeTxId(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,tradeTxId:e}})}setQuotesLastFetched(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,quotesLastFetched:e}})}setSwapsTxGasPrice(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customGasPrice:e}})}setSwapsTxMaxFeePerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customMaxFeePerGas:e}})}setSwapsUserFeeLevel(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,swapsUserFeeLevel:e}})}setSwapsQuotesPollingLimitEnabled(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,quotesPollingLimitEnabled:e}})}setSwapsTxMaxFeePriorityPerGas(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customMaxPriorityFeePerGas:e}})}setSwapsTxGasLimit(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customMaxGas:e}})}setCustomApproveTxData(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,customApproveTxData:e}})}setBackgroundSwapRouteState(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,routeState:e}})}setSaveFetchedQuotes(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,saveFetchedQuotes:e}})}setSwapsLiveness(e){const{swapsState:t}=this.store.getState(),{swapsFeatureIsLive:r}=e;this.store.updateState({swapsState:{...t,swapsFeatureIsLive:r}})}setSwapsFeatureFlags(e){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,swapsFeatureFlags:e}})}resetPostFetchState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...T,tokens:e.tokens,fetchParams:e.fetchParams,swapsFeatureIsLive:e.swapsFeatureIsLive,swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:e.swapsFeatureFlags}}),clearTimeout(this.pollingTimeout)}resetSwapsState(){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...T,swapsQuoteRefreshTime:e.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:e.swapsQuotePrefetchingRefreshTime}}),clearTimeout(this.pollingTimeout)}async _findTopQuoteAndCalculateSavings(e={}){const{contractExchangeRates:t}=this.getTokenRatesState(),{swapsState:{customGasPrice:r,customMaxPriorityFeePerGas:n}}=this.store.getState(),i=this._getCurrentChainId();if(!Object.keys(e).length)return{};const s=(0,o.cloneDeep)(e),{gasFeeEstimates:c,gasEstimateType:l}=await this._getEIP1559GasFeeEstimates();let h="0x0";if(l===d.GAS_ESTIMATE_TYPES.FEE_MARKET){const{high:{suggestedMaxPriorityFeePerGas:e},estimatedBaseFee:t}=c;h=(0,u.addCurrencies)(n||(0,u.decGWEIToHexWEI)(e),(0,u.decGWEIToHexWEI)(t),{aBase:16,bBase:16,toNumericBase:"hex",numberOfDecimals:6})}else l===d.GAS_ESTIMATE_TYPES.LEGACY?h=r||(0,u.decGWEIToHexWEI)(c.high):l===d.GAS_ESTIMATE_TYPES.ETH_GASPRICE&&(h=r||(0,u.decGWEIToHexWEI)(c.gasPrice));let p=null,m=null;Object.values(s).forEach((e=>{const{aggregator:r,approvalNeeded:n,averageGas:s,destinationAmount:o=0,destinationToken:c,destinationTokenInfo:l,gasEstimateWithRefund:d,sourceAmount:g,sourceToken:y,trade:w,fee:k}=e,S=(d?new a.default(d,16):new a.default(s||E,10)).plus((null==n?void 0:n.gas)||"0x0",16).toString(16),T=(0,b.calcGasTotal)(S,h),_=new a.default(T,16).plus(w.value,16),x=(0,u.conversionUtil)(_,{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}),A=(0,f.isSwapsDefaultTokenAddress)(y,i)?(0,u.conversionUtil)(_.minus(g,10),{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}):x,P=(0,b.calcTokenAmount)(o,l.decimals),I=new a.default(100,10).minus(k,10).div(100),R=P.div(I).minus(P),M=t[Object.keys(t).find((e=>(0,v.isEqualCaseInsensitive)(e,c)))],C=M||1,N=P.times(C.toString(10),10),O=(0,f.isSwapsDefaultTokenAddress)(c,i)?1:M,L=O===undefined?N:N.minus(A,10);e.ethFee=A.toString(10),O!==undefined&&(e.ethValueOfTokens=N.toString(10),e.overallValueOfQuote=L.toString(10),e.metaMaskFeeInEth=R.times(O.toString(10)).toString(10)),(null===m||L.gt(m))&&(p=r,m=L)}));let g=null;if((0,f.isSwapsDefaultTokenAddress)(s[p].destinationToken,i)||Boolean(t[Object.keys(t).find((e=>{var t;return(0,v.isEqualCaseInsensitive)(e,null===(t=s[p])||void 0===t?void 0:t.destinationToken)}))])){const e=s[p];g={};const{ethFee:t,metaMaskFeeInEth:r,ethValueOfTokens:n}=_(Object.values(s));g.performance=new a.default(e.ethValueOfTokens,10).minus(n,10),g.fee=new a.default(t).minus(e.ethFee,10),g.metaMaskFee=e.metaMaskFeeInEth,g.total=g.performance.plus(g.fee).minus(g.metaMaskFee).toString(10),g.performance=g.performance.toString(10),g.fee=g.fee.toString(10),g.medianMetaMaskFee=r,s[p].isBestQuote=!0,s[p].savings=g}return[p,s]}async _getERC20Allowance(e,t,r){const i=new n.ethers.Contract(e,c.default,this.ethersProvider);return await i.allowance(t,l.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[r])}};const A={getMedianEthValueQuote:_,meansOfQuotesFeesAndValue:x};r.utils=A}}},{package:"$root$"}],[32,{"../../../development/mock-3box":165,"../lib/createOriginMiddleware":48,"../lib/migrator":64,"../migrations":161,"./network/createMetamaskMiddleware":17,"3box":171,"@metamask/obs-store":1217,"eth-json-rpc-middleware":2283,"json-rpc-engine":5207,loglevel:5639},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store"),i=d(e("loglevel")),a=e("json-rpc-engine"),s=e("eth-json-rpc-middleware"),o=d(e("../lib/migrator")),c=d(e("../migrations")),u=d(e("../lib/createOriginMiddleware")),l=d(e("./network/createMetamaskMiddleware"));function d(e){return e&&e.__esModule?e:{default:e}}const h=e("3box");r.default=class{constructor(e={}){const{preferencesController:t,keyringController:r,addressBookController:i,version:a,getKeyringControllerState:s,trackMetaMetricsEvent:o}=e;this.preferencesController=t,this.addressBookController=i,this.keyringController=r,this.provider=this._createProvider({version:a,getAccounts:async({origin:e})=>{if("3Box"!==e)return[];const{isUnlocked:t}=s(),r=await this.keyringController.getAccounts();if(t&&r[0]){return[await this.keyringController.getAppKeyAddress(r[0],"wallet://3box.metamask.io")]}return[]},processPersonalMessage:async e=>{const t=await this.keyringController.getAccounts();return r.signPersonalMessage({...e,from:t[0]},{withAppKeyOrigin:"wallet://3box.metamask.io"})}}),this._trackMetaMetricsEvent=o;const u={threeBoxSyncingAllowed:!1,showRestorePrompt:!0,threeBoxLastUpdated:0,...e.initState,threeBoxAddress:null,threeBoxSynced:!1,threeBoxDisabled:!1};this.store=new n.ObservableStore(u),this.registeringUpdates=!1,this.lastMigration=c.default.sort(((e,t)=>e.version-t.version)).slice(-1)[0],u.threeBoxSyncingAllowed&&this.init()}async init(){const e=await this.keyringController.getAccounts();this.address=e[0],this._trackMetaMetricsEvent({event:"3Box Initiated",category:"3Box"}),!this.address||this.box&&this.store.getState().threeBoxSynced||await this.new3Box()}async _update3Box(){try{const{threeBoxSyncingAllowed:e,threeBoxSynced:t}=this.store.getState();if(e&&t){const e={preferences:this.preferencesController.store.getState(),addressBook:this.addressBookController.state,lastUpdated:Date.now(),lastMigration:this.lastMigration};await this.space.private.set("metamaskBackup",JSON.stringify(e)),await this.setShowRestorePromptToFalse()}}catch(e){console.error(e)}}_createProvider(e){const t=(0,l.default)(e),r=new a.JsonRpcEngine;r.push((0,u.default)({origin:"3Box"})),r.push(t);return(0,s.providerFromEngine)(r)}_waitForOnSyncDone(){return new Promise((e=>{this.box.onSyncDone((()=>(i.default.debug("3Box box sync done"),e())))}))}async new3Box(){const e=await this.keyringController.getAccounts();let t;this.address=await this.keyringController.getAppKeyAddress(e[0],"wallet://3box.metamask.io");try{const e=await h.getConfig(this.address);t=e.spaces&&e.spaces.metamask}catch(e){if(!e.message.match(/^Error: Invalid response \(404\)/u))throw this._trackMetaMetricsEvent({event:"3Box Config Error",category:"3Box"}),e;this._trackMetaMetricsEvent({event:"3Box Backup does not exist",category:"3Box"}),t=!1}if(this.getThreeBoxSyncingState()||t){this.store.updateState({threeBoxSynced:!1});let e=!1;const t=setTimeout((()=>{i.default.error("3Box sync timed out after 60000 ms"),e=!0,this.store.updateState({threeBoxDisabled:!0,threeBoxSyncingAllowed:!1})}),6e4);try{this.box=await h.openBox(this.address,this.provider),await this._waitForOnSyncDone(),this.space=await this.box.openSpace("metamask",{onSyncDone:async()=>{const r={threeBoxSynced:!0,threeBoxAddress:this.address};e&&(i.default.info("3Box sync completed after timeout; no longer disabled"),r.threeBoxDisabled=!1),clearTimeout(t),this.store.updateState(r),i.default.debug("3Box space sync done"),this._trackMetaMetricsEvent({event:"3Box Synced",category:"3Box"})}})}catch(e){throw this._trackMetaMetricsEvent({event:"3Box Initiation Error",category:"3Box"}),console.error(e),e}}}async getLastUpdated(){const e=await this.space.private.get("metamaskBackup");return JSON.parse(e||"{}").lastUpdated}async migrateBackedUpState(e){const t=new o.default({migrations:c.default}),{preferences:r,addressBook:n}=JSON.parse(e),i={PreferencesController:r,AddressBookController:n},a=t.generateInitialState(i),s=await t.migrateData(a);return{preferences:s.data.PreferencesController,addressBook:s.data.AddressBookController}}async restoreFromThreeBox(){const e=await this.space.private.get("metamaskBackup"),{preferences:t,addressBook:r}=await this.migrateBackedUpState(e);this.store.updateState({threeBoxLastUpdated:e.lastUpdated}),t&&this.preferencesController.store.updateState(t),r&&this.addressBookController.update(r,!0),this.setShowRestorePromptToFalse(),this._trackMetaMetricsEvent({event:"3Box Restored Data",category:"3Box"})}turnThreeBoxSyncingOn(){this._trackMetaMetricsEvent({event:"3Box Sync Turned On",category:"3Box"}),this._registerUpdates()}turnThreeBoxSyncingOff(){this._trackMetaMetricsEvent({event:"3Box Sync Turned Off",category:"3Box"}),this.box.logout()}setShowRestorePromptToFalse(){this.store.updateState({showRestorePrompt:!1})}setThreeBoxSyncingPermission(e){this.store.getState().threeBoxDisabled||(this.store.updateState({threeBoxSyncingAllowed:e}),e&&this.box&&this.turnThreeBoxSyncingOn(),!e&&this.box&&this.turnThreeBoxSyncingOff())}getThreeBoxSyncingState(){return this.store.getState().threeBoxSyncingAllowed}_registerUpdates(){if(!this.registeringUpdates){const e=this._update3Box.bind(this);this.preferencesController.store.subscribe(e);const t=this._update3Box.bind(this);this.addressBookController.subscribe(t),this.registeringUpdates=!0}}}}}},{package:"$root$"}],[33,{"../../../../shared/constants/app":6584,"../../../../shared/constants/gas":6585,"../../../../shared/constants/metametrics":6588,"../../../../shared/constants/network":6589,"../../../../shared/constants/transaction":6596,"../../../../shared/lib/transactions-controller-utils":6603,"../../../../shared/modules/conversion.utils":6607,"../../../../shared/modules/swaps.utils":6618,"../../../../shared/modules/transaction.utils":6619,"../../lib/cleanErrorStack":44,"../../lib/util":85,"../../metamask-controller":86,"./lib/util":35,"./pending-tx-tracker":36,"./tx-gas-utils":37,"./tx-state-manager":38,"@ethereumjs/common":394,"@ethereumjs/tx":399,"@metamask/obs-store":1217,"bignumber.js":1854,"eth-rpc-errors":2421,"ethereumjs-util":2496,"ethjs-query":2933,lodash:5626,loglevel:5639,"nonce-tracker":5753,"safe-event-emitter":6179},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=M(e("safe-event-emitter")),i=e("@metamask/obs-store"),a=e("ethereumjs-util"),s=M(e("ethjs-query")),o=e("eth-rpc-errors"),c=M(e("@ethereumjs/common")),u=e("@ethereumjs/tx"),l=M(e("nonce-tracker")),d=M(e("loglevel")),h=M(e("bignumber.js")),f=e("lodash"),p=M(e("../../lib/cleanErrorStack")),m=e("../../lib/util"),g=e("../../../../shared/constants/transaction"),v=e("../../metamask-controller"),b=e("../../../../shared/constants/gas"),y=e("../../../../shared/modules/conversion.utils"),w=e("../../../../shared/modules/swaps.utils"),E=e("../../../../shared/constants/metametrics"),k=e("../../../../shared/constants/network"),S=e("../../../../shared/modules/transaction.utils"),T=e("../../../../shared/constants/app"),_=e("../../../../shared/lib/transactions-controller-utils"),x=M(e("./tx-state-manager")),A=M(e("./tx-gas-utils")),P=M(e("./pending-tx-tracker")),I=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=R(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}n.default=e,r&&r.set(e,n);return n}(e("./lib/util"));function R(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(R=function(e){return e?r:t})(e)}function M(e){return e&&e.__esModule?e:{default:e}}const C=[g.TRANSACTION_TYPES.SWAP,g.TRANSACTION_TYPES.SWAP_APPROVAL],N=[...C,g.TRANSACTION_TYPES.SIMPLE_SEND,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM,g.TRANSACTION_TYPES.CONTRACT_INTERACTION],O="failed on-chain";class L extends n.default{constructor(e){super(),this.networkStore=e.networkStore||new i.ObservableStore({}),this._getCurrentChainId=e.getCurrentChainId,this.getProviderConfig=e.getProviderConfig,this._getCurrentNetworkEIP1559Compatibility=e.getCurrentNetworkEIP1559Compatibility,this._getCurrentAccountEIP1559Compatibility=e.getCurrentAccountEIP1559Compatibility,this.preferencesStore=e.preferencesStore||new i.ObservableStore({}),this.provider=e.provider,this.getPermittedAccounts=e.getPermittedAccounts,this.blockTracker=e.blockTracker,this.signEthTx=e.signTransaction,this.inProcessOfSigning=new Set,this._trackMetaMetricsEvent=e.trackMetaMetricsEvent,this._getParticipateInMetrics=e.getParticipateInMetrics,this._getEIP1559GasFeeEstimates=e.getEIP1559GasFeeEstimates,this.createEventFragment=e.createEventFragment,this.updateEventFragment=e.updateEventFragment,this.finalizeEventFragment=e.finalizeEventFragment,this.getEventFragmentById=e.getEventFragmentById,this.getDeviceModel=e.getDeviceModel,this.getAccountType=e.getAccountType,this.getTokenStandardAndDetails=e.getTokenStandardAndDetails,this.memStore=new i.ObservableStore({}),this.query=new s.default(this.provider),this.txGasUtil=new A.default(this.provider),this._mapMethods(),this.txStateManager=new x.default({initState:e.initState,txHistoryLimit:e.txHistoryLimit,getNetwork:this.getNetwork.bind(this),getCurrentChainId:e.getCurrentChainId}),this._onBootCleanUp(),this.store=this.txStateManager.store,this.nonceTracker=new l.default({provider:this.provider,blockTracker:this.blockTracker,getPendingTransactions:(...t)=>[...this.txStateManager.getPendingTransactions(...t),...e.getExternalPendingTransactions(...t)],getConfirmedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.pendingTxTracker=new P.default({provider:this.provider,nonceTracker:this.nonceTracker,publishTransaction:e=>this.query.sendRawTransaction(e),getPendingTransactions:()=>[...this.txStateManager.getPendingTransactions(),...this.txStateManager.getApprovedTransactions()],approveTransaction:this.approveTransaction.bind(this),getCompletedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.txStateManager.store.subscribe((()=>this.emit(v.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE))),this._setupListeners(),this._updateMemstore(),this.txStateManager.store.subscribe((()=>this._updateMemstore())),this.networkStore.subscribe((()=>{this._onBootCleanUp(),this._updateMemstore()})),this._updatePendingTxsAfterFirstBlock()}getChainId(){const e=this.networkStore.getState(),t=this._getCurrentChainId(),r=parseInt(t,16);return"loading"===e||Number.isNaN(r)?0:r}async getEIP1559Compatibility(e){const t=await this._getCurrentNetworkEIP1559Compatibility(),r=await this._getCurrentAccountEIP1559Compatibility(e);return t&&r}async getCommonConfiguration(e){const{type:t,nickname:r}=this.getProviderConfig(),n=await this.getEIP1559Compatibility(e)?k.HARDFORKS.LONDON:k.HARDFORKS.BERLIN;if(t!==k.NETWORK_TYPES.RPC&&t!==k.NETWORK_TYPES.SEPOLIA)return new c.default({chain:t,hardfork:n});const i=parseInt(this._getCurrentChainId(),16),a=this.networkStore.getState(),s={name:r,chainId:i,networkId:"loading"===a?0:parseInt(a,10)};return c.default.forCustomChain(k.NETWORK_TYPES.MAINNET,s,n)}addTransaction(e){this.txStateManager.addTransaction(e),this.emit(`${e.id}:unapproved`,e),this._trackTransactionMetricsEvent(e,g.TRANSACTION_EVENTS.ADDED,e.actionId)}wipeTransactions(e){this.txStateManager.wipeTransactions(e)}async newUnapprovedTransaction(e,t={}){d.default.debug(`MetaMaskController newUnapprovedTransaction ${JSON.stringify(e)}`);const r=await this.addUnapprovedTransaction(e,t.origin);return new Promise(((e,t)=>{this.txStateManager.once(`${r.id}:finished`,(r=>{switch(r.status){case g.TRANSACTION_STATUSES.SUBMITTED:return e(r.hash);case g.TRANSACTION_STATUSES.REJECTED:return t((0,p.default)(o.ethErrors.provider.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.")));case g.TRANSACTION_STATUSES.FAILED:return t((0,p.default)(o.ethErrors.rpc.internal(r.err.message)));default:return t((0,p.default)(o.ethErrors.rpc.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(r.txParams)}`)))}}))}))}_getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}_isUnapprovedTransaction(e){return this.txStateManager.getTransaction(e).status===g.TRANSACTION_STATUSES.UNAPPROVED}_throwErrorIfNotUnapprovedTx(e,t){if(!this._isUnapprovedTransaction(e))throw new Error(`TransactionsController: Can only call ${t} on an unapproved transaction.\n         Current tx status: ${this.txStateManager.getTransaction(e).status}`)}_updateTransaction(e,t,r){const n=this.txStateManager.getTransaction(e),i=(0,f.merge)(n,t);this.txStateManager.updateTransaction(i,r)}updatePreviousGasParams(e,{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}){const i={previousGas:{maxFeePerGas:t,maxPriorityFeePerGas:r,gasLimit:n}};i.previousGas=(0,f.pickBy)(i.previousGas);const a=`Update Previous Gas for ${e}`;return this._updateTransaction(e,i,a),this._getTransaction(e)}async updateEditableParams(e,{data:t,from:r,to:n,value:i,gas:a,gasPrice:s}){this._throwErrorIfNotUnapprovedTx(e,"updateEditableParams");const o={txParams:{data:t,from:r,to:n,value:i,gas:a,gasPrice:s}};o.txParams=(0,f.pickBy)(o.txParams,(e=>e!==undefined));const c=this._getTransaction(e),{type:u}=await(0,S.determineTransactionType)({...c.txParams,...o.txParams},this.query);o.type=u;const l=`Update Editable Params for ${e}`;return this._updateTransaction(e,o,l),this._getTransaction(e)}updateTransactionGasFees(e,{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:a,estimateUsed:s,estimateSuggested:o,defaultGasEstimates:c,originalGasEstimate:u,userEditedGasLimit:l,userFeeLevel:d}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionGasFees");let h={txParams:{gas:t,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:a},estimateUsed:s,estimateSuggested:o,defaultGasEstimates:c,originalGasEstimate:u,userEditedGasLimit:l,userFeeLevel:d};h.txParams=(0,f.pickBy)(h.txParams),h=(0,f.pickBy)(h);const p=`Update Transaction Gas Fees for ${e}`;return this._updateTransaction(e,h,p),this._getTransaction(e)}updateTransactionEstimatedBaseFee(e,{estimatedBaseFee:t,decEstimatedBaseFee:r}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionEstimatedBaseFee");let n={estimatedBaseFee:t,decEstimatedBaseFee:r};n=(0,f.pickBy)(n);const i=`Update Transaction Estimated Base Fees for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateSwapApprovalTransaction(e,{type:t,sourceTokenSymbol:r}){this._throwErrorIfNotUnapprovedTx(e,"updateSwapApprovalTransaction");let n={type:t,sourceTokenSymbol:r};n=(0,f.pickBy)(n);const i=`Update Swap Approval Transaction for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateSwapTransaction(e,{sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:a,swapMetaData:s,swapTokenValue:o,estimatedBaseFee:c,approvalTxId:u}){this._throwErrorIfNotUnapprovedTx(e,"updateSwapTransaction");let l={sourceTokenSymbol:t,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:a,swapMetaData:s,swapTokenValue:o,estimatedBaseFee:c,approvalTxId:u};l=(0,f.pickBy)(l);const d=`Update Swap Transaction for ${e}`;return this._updateTransaction(e,l,d),this._getTransaction(e)}updateTransactionUserSettings(e,{userEditedGasLimit:t,userFeeLevel:r}){this._throwErrorIfNotUnapprovedTx(e,"updateTransactionUserSettings");let n={userEditedGasLimit:t,userFeeLevel:r};n=(0,f.pickBy)(n);const i=`Update User Settings for ${e}`;return this._updateTransaction(e,n,i),this._getTransaction(e)}updateTransactionSendFlowHistory(e,t,r){var n;this._throwErrorIfNotUnapprovedTx(e,"updateTransactionSendFlowHistory");const i=this._getTransaction(e);if(t===((null==i||null===(n=i.sendFlowHistory)||void 0===n?void 0:n.length)||0)){var a;const t=`Update sendFlowHistory for ${e}`;this.txStateManager.updateTransaction({...i,sendFlowHistory:[...null!==(a=null==i?void 0:i.sendFlowHistory)&&void 0!==a?a:[],...r]},t)}return this._getTransaction(e)}async addTransactionGasDefaults(e){const t=await(0,S.determineTransactionContractCode)(e.txParams,this.query);let r=e;try{r=await this.addTxGasDefaults(e,t)}catch(t){throw d.default.warn(t),r=this.txStateManager.getTransaction(e.id),r.loadingDefaults=!1,this.txStateManager.updateTransaction(e,"Failed to calculate gas defaults."),t}return r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"Added new unapproved transaction."),r}async addUnapprovedTransaction(e,t,r,n=[],i){if(r!==undefined&&!N.includes(r))throw new Error(`TransactionController - invalid transactionType value: ${r}`);if(i){let e=this.txStateManager.getTransactionWithActionId(i);if(e)return this.emit("newUnapprovedTx",e),e=await this.addTransactionGasDefaults(e),e}const a=I.normalizeTxParams(e),s=await this.getEIP1559Compatibility();I.validateTxParams(a,s);let c=this.txStateManager.generateTxMeta({txParams:a,origin:t,sendFlowHistory:n});if(i&&(c.actionId=i),t===T.ORIGIN_METAMASK){if(a.from!==this.getSelectedAddress())throw o.ethErrors.rpc.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:t,fromAddress:a.from,selectedAddress:this.getSelectedAddress()}})}else{if(!(await this.getPermittedAccounts(t)).includes(a.from))throw o.ethErrors.provider.unauthorized({data:{origin:t}})}const{type:u}=await(0,S.determineTransactionType)(e,this.query);return c.type=r||u,c.txParams.value=c.txParams.value?(0,m.addHexPrefix)(c.txParams.value):"0x0",this.addTransaction(c),this.emit("newUnapprovedTx",c),c=await this.addTransactionGasDefaults(c),c}async addTxGasDefaults(e,t){const r=e.txParams.type!==g.TRANSACTION_ENVELOPE_TYPES.LEGACY&&await this.getEIP1559Compatibility(),{gasPrice:n,maxFeePerGas:i,maxPriorityFeePerGas:a}=await this._getDefaultGasFees(e,r),{gasLimit:s,simulationFails:o}=await this._getDefaultGasLimit(e,t);if(e=this.txStateManager.getTransaction(e.id),o&&(e.simulationFails=o),r){const{eip1559V2Enabled:t}=this.preferencesStore.getState(),r=this.getAdvancedGasFee();t&&Boolean(r)&&!C.includes(e.type)?(e.userFeeLevel=b.CUSTOM_GAS_ESTIMATE,e.txParams.maxFeePerGas=(0,y.decGWEIToHexWEI)(r.maxBaseFee),e.txParams.maxPriorityFeePerGas=(0,y.decGWEIToHexWEI)(r.priorityFee)):!e.txParams.gasPrice||e.txParams.maxFeePerGas||e.txParams.maxPriorityFeePerGas?(i&&a&&!e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas||e.origin===T.ORIGIN_METAMASK?e.userFeeLevel=b.GAS_RECOMMENDATIONS.MEDIUM:e.userFeeLevel=t?b.PRIORITY_LEVELS.DAPP_SUGGESTED:b.CUSTOM_GAS_ESTIMATE,i&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=i),a&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=a),n&&!e.txParams.maxFeePerGas&&(e.txParams.maxFeePerGas=n),e.txParams.maxFeePerGas&&!e.txParams.maxPriorityFeePerGas&&(e.txParams.maxPriorityFeePerGas=e.txParams.maxFeePerGas)):(e.txParams.maxFeePerGas=e.txParams.gasPrice,e.txParams.maxPriorityFeePerGas=e.txParams.gasPrice,t&&e.origin!==T.ORIGIN_METAMASK?e.userFeeLevel=b.PRIORITY_LEVELS.DAPP_SUGGESTED:e.userFeeLevel=b.CUSTOM_GAS_ESTIMATE),delete e.txParams.gasPrice}else delete e.txParams.maxPriorityFeePerGas,delete e.txParams.maxFeePerGas;return!n||e.txParams.gasPrice||e.txParams.maxPriorityFeePerGas||e.txParams.maxFeePerGas||(e.txParams.gasPrice=n),s&&!e.txParams.gas&&(e.txParams.gas=s,e.originalGasEstimate=s),e.defaultGasEstimates={estimateType:e.userFeeLevel,gas:e.txParams.gas,gasPrice:e.txParams.gasPrice,maxFeePerGas:e.txParams.maxFeePerGas,maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas},e}async _getDefaultGasFees(e,t){if(!t&&e.txParams.gasPrice||t&&e.txParams.maxFeePerGas&&e.txParams.maxPriorityFeePerGas)return{};try{const{gasFeeEstimates:e,gasEstimateType:r}=await this._getEIP1559GasFeeEstimates();if(t&&r===b.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:t,suggestedMaxFeePerGas:r}={}}=e;if(t&&r)return{maxFeePerGas:(0,y.decGWEIToHexWEI)(r),maxPriorityFeePerGas:(0,y.decGWEIToHexWEI)(t)}}else{if(r===b.GAS_ESTIMATE_TYPES.LEGACY)return{gasPrice:(0,y.decGWEIToHexWEI)(e.medium)};if(r===b.GAS_ESTIMATE_TYPES.ETH_GASPRICE)return{gasPrice:(0,y.decGWEIToHexWEI)(e.gasPrice)}}}catch(e){console.error(e)}const r=await this.query.gasPrice();return{gasPrice:r&&(0,m.addHexPrefix)(r.toString(16))}}async _getDefaultGasLimit(e){const t=this._getCurrentChainId(),r=k.CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP[t],n=(0,m.getChainType)(t);if(e.txParams.gas)return{};if(e.txParams.to&&e.type===g.TRANSACTION_TYPES.SIMPLE_SEND&&"custom"!==n&&!e.txParams.data)return{gasLimit:b.GAS_LIMITS.SIMPLE};const{blockGasLimit:i,estimatedGasHex:a,simulationFails:s}=await this.txGasUtil.analyzeGasUsage(e);return{gasLimit:this.txGasUtil.addGasBuffer((0,m.addHexPrefix)(a),i,r),simulationFails:s}}generateNewGasParams(e,t={},r=11){const{txParams:n}=e,i={},a={};var s;t.gasLimit&&(a.gas=null!==(s=null==t?void 0:t.gas)&&void 0!==s?s:b.GAS_LIMITS.SIMPLE);return t.estimateSuggested&&(a.estimateSuggested=t.estimateSuggested),t.estimateUsed&&(a.estimateUsed=t.estimateUsed),(0,S.isEIP1559Transaction)(e)?(i.maxFeePerGas=n.maxFeePerGas,i.maxPriorityFeePerGas=n.maxPriorityFeePerGas,a.maxFeePerGas=(null==t?void 0:t.maxFeePerGas)||(0,m.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.maxFeePerGas),r,10)),a.maxPriorityFeePerGas=(null==t?void 0:t.maxPriorityFeePerGas)||(0,m.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.maxPriorityFeePerGas),r,10))):(i.gasPrice=n.gasPrice,a.gasPrice=(null==t?void 0:t.gasPrice)||(0,m.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.gasPrice),r,10))),{previousGasParams:i,newGasParams:a}}async createCancelTransaction(e,t,{estimatedBaseFee:r,actionId:n}={}){if(n){const e=this.txStateManager.getTransactionWithActionId(n);if(e)return e}const i=this.txStateManager.getTransaction(e),{txParams:a}=i,{from:s,nonce:o}=a,{previousGasParams:c,newGasParams:u}=this.generateNewGasParams(i,{...t,gasLimit:t.gasLimit||b.GAS_LIMITS.SIMPLE}),l=this.txStateManager.generateTxMeta({txParams:{from:s,to:s,nonce:o,value:"0x0",...u},previousGasParams:c,loadingDefaults:!1,status:g.TRANSACTION_STATUSES.APPROVED,type:g.TRANSACTION_TYPES.CANCEL,actionId:n});return r&&(l.estimatedBaseFee=r),this.addTransaction(l),await this.approveTransaction(l.id,n),l}async createSpeedUpTransaction(e,t,{estimatedBaseFee:r,actionId:n}={}){if(n){const e=this.txStateManager.getTransactionWithActionId(n);if(e)return e}const i=this.txStateManager.getTransaction(e),{txParams:a}=i,{previousGasParams:s,newGasParams:o}=this.generateNewGasParams(i,t),c=this.txStateManager.generateTxMeta({txParams:{...a,...o},previousGasParams:s,loadingDefaults:!1,status:g.TRANSACTION_STATUSES.APPROVED,type:g.TRANSACTION_TYPES.RETRY,originalType:i.type,actionId:n});return r&&(c.estimatedBaseFee=r),this.addTransaction(c),await this.approveTransaction(c.id,n),c}async updateTransaction(e){this.txStateManager.updateTransaction(e,"confTx: user updated transaction")}async updateAndApproveTransaction(e,t){this.txStateManager.updateTransaction(e,"confTx: user approved transaction"),await this.approveTransaction(e.id,t)}async approveTransaction(e,t){const r=this.txStateManager.getTransaction(e);if(this.inProcessOfSigning.has(e))return;let n;this.inProcessOfSigning.add(e);try{this.txStateManager.setTxStatusApproved(e);const i=r.txParams.from;let{customNonceValue:a}=r;a=Number(a),n=await this.nonceTracker.getNonceLock(i);const s=r.previousGasParams?r.txParams.nonce:n.nextNonce,o=0===a?a:a||s;r.txParams.nonce=(0,m.addHexPrefix)(o.toString(16)),r.nonceDetails=n.nonceDetails,a&&(r.nonceDetails.customNonceValue=a),this.txStateManager.updateTransaction(r,"transactions#approveTransaction");const c=await this.signTransaction(e);await this.publishTransaction(e,c,t),this._trackTransactionMetricsEvent(r,g.TRANSACTION_EVENTS.APPROVED,t),n.releaseLock()}catch(r){try{this._failTransaction(e,r,t)}catch(e){d.default.error(e)}throw n&&n.releaseLock(),r}finally{this.inProcessOfSigning.delete(e)}}async approveTransactionsWithSameNonce(e=[]){if(0===e.length)return"";const t=e[0],r=await this.getCommonConfiguration(t.from),n=u.TransactionFactory.fromTxData(t,{common:r}),i=(0,a.bufferToHex)(n.serialize());if(this.inProcessOfSigning.has(i))return"";let s,o;this.inProcessOfSigning.add(i);try{const r=t.from;o=await this.nonceTracker.getNonceLock(r);const n=o.nextNonce;s=await Promise.all(e.map((e=>(e.nonce=(0,m.addHexPrefix)(n.toString(16)),this.signExternalTransaction(e)))))}catch(e){throw d.default.error(e),e}finally{o&&o.releaseLock(),this.inProcessOfSigning.delete(i)}return s}async signExternalTransaction(e){const t=I.normalizeTxParams(e),r=this.getChainId(),n=(0,S.isEIP1559Transaction)({txParams:t})?g.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:g.TRANSACTION_ENVELOPE_TYPES.LEGACY,i={...t,type:n,gasLimit:t.gas,chainId:(0,m.addHexPrefix)((0,_.decimalToHex)(r))},s=i.from,o=await this.getCommonConfiguration(s),c=u.TransactionFactory.fromTxData(i,{common:o}),l=await this.signEthTx(c,s);return(0,a.bufferToHex)(l.serialize())}async signTransaction(e){const t=this.txStateManager.getTransaction(e),r=this.getChainId(),n=(0,S.isEIP1559Transaction)(t)?g.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:g.TRANSACTION_ENVELOPE_TYPES.LEGACY,i={...t.txParams,type:n,chainId:r,gasLimit:t.txParams.gas},s=i.from,o=await this.getCommonConfiguration(i.from),c=u.TransactionFactory.fromTxData(i,{common:o}),l=await this.signEthTx(c,s);t.r=(0,a.bufferToHex)(l.r),t.s=(0,a.bufferToHex)(l.s),t.v=(0,a.bufferToHex)(l.v),this.txStateManager.updateTransaction(t,"transactions#signTransaction: add r, s, v values"),this.txStateManager.setTxStatusSigned(t.id);return(0,a.bufferToHex)(l.serialize())}async publishTransaction(e,t,r){const n=this.txStateManager.getTransaction(e);if(n.rawTx=t,n.type===g.TRANSACTION_TYPES.SWAP){const e=await this.query.getBalance(n.txParams.from);n.preTxBalance=e.toString(16)}let i;this.txStateManager.updateTransaction(n,"transactions#publishTransaction");try{i=await this.query.sendRawTransaction(t)}catch(e){if(!e.message.toLowerCase().includes("known transaction"))throw e;i=(0,a.keccak)((0,a.toBuffer)((0,m.addHexPrefix)(t),"hex")).toString("hex"),i=(0,m.addHexPrefix)(i)}this.setTxHash(e,i),this.txStateManager.setTxStatusSubmitted(e),this._trackTransactionMetricsEvent(n,g.TRANSACTION_EVENTS.SUBMITTED,r)}async updatePostTxBalance({txMeta:e,txId:t,numberOfAttempts:r=6}){const n=await this.query.getBalance(e.txParams.from),i=this.txStateManager.getTransaction(t),a=i.approvalTxId?this.txStateManager.getTransaction(i.approvalTxId):null;i.postTxBalance=n.toString(16);(0,w.isSwapsDefaultTokenAddress)(e.destinationTokenAddress,e.chainId)&&e.preTxBalance===i.postTxBalance&&r>0?setTimeout((()=>{this.updatePostTxBalance({txMeta:e,txId:t,numberOfAttempts:r-1})}),5e3):(this.txStateManager.updateTransaction(i,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(i,a))}async confirmTransaction(e,t,r,n){const i=this.txStateManager.getTransaction(e);if(i)try{const a=I.normalizeTxReceiptGasUsed(t.gasUsed);i.txReceipt={...t,gasUsed:a},r&&(i.baseFeePerGas=r),n&&(i.blockTimestamp=n),this.txStateManager.setTxStatusConfirmed(e),this._markNonceDuplicatesDropped(e);const{submittedTime:s}=i,o={gas_used:a};s&&(o.completion_time=this._getTransactionCompletionTime(s)),"0x0"===t.status&&(o.status=O),this._trackTransactionMetricsEvent(i,g.TRANSACTION_EVENTS.FINALIZED,undefined,o),this.txStateManager.updateTransaction(i,"transactions#confirmTransaction - add txReceipt"),i.type===g.TRANSACTION_TYPES.SWAP&&await this.updatePostTxBalance({txMeta:i,txId:e})}catch(e){d.default.error(e)}}async confirmExternalTransaction(e,t,r){if(await this.txStateManager.addExternalTransaction(e),!e)return;const n=e.id;try{const i=I.normalizeTxReceiptGasUsed(t.gasUsed);e.txReceipt={...t,gasUsed:i},r&&(e.baseFeePerGas=r),this.txStateManager.setTxStatusConfirmed(n),this._markNonceDuplicatesDropped(n);const{submittedTime:a}=e,s={gas_used:i};a&&(s.completion_time=this._getTransactionCompletionTime(a)),"0x0"===t.status&&(s.status=O),this._trackTransactionMetricsEvent(e,g.TRANSACTION_EVENTS.FINALIZED,undefined,s),this.txStateManager.updateTransaction(e,"transactions#confirmTransaction - add txReceipt"),e.type===g.TRANSACTION_TYPES.SWAP&&await this.updatePostTxBalance({txMeta:e,txId:n})}catch(e){d.default.error(e)}}async cancelTransaction(e,t){const r=this.txStateManager.getTransaction(e);this.txStateManager.setTxStatusRejected(e),this._trackTransactionMetricsEvent(r,g.TRANSACTION_EVENTS.REJECTED,t)}setTxHash(e,t){const r=this.txStateManager.getTransaction(e);r.hash=t,this.txStateManager.updateTransaction(r,"transactions#setTxHash")}async createTransactionEventFragment(e,t,r){const n=this.txStateManager.getTransaction(e),{properties:i,sensitiveProperties:a}=await this._buildEventFragmentProperties(n);this._createTransactionEventFragment(n,t,i,a,r)}_mapMethods(){this.getState=()=>this.memStore.getState(),this.getNetwork=()=>this.networkStore.getState(),this.getSelectedAddress=()=>this.preferencesStore.getState().selectedAddress,this.getUnapprovedTxCount=()=>Object.keys(this.txStateManager.getUnapprovedTxList()).length,this.getPendingTxCount=e=>this.txStateManager.getPendingTransactions(e).length,this.getTransactions=e=>this.txStateManager.getTransactions(e),this.getAdvancedGasFee=()=>this.preferencesStore.getState().advancedGasFee}async _updatePendingTxsAfterFirstBlock(){await this.blockTracker.getLatestBlock(),await this.pendingTxTracker.updatePendingTxs()}_onBootCleanUp(){this.txStateManager.getTransactions({searchCriteria:{status:g.TRANSACTION_STATUSES.UNAPPROVED,loadingDefaults:!0}}).forEach((e=>{this.addTxGasDefaults(e).then((e=>{e.loadingDefaults=!1,this.txStateManager.updateTransaction(e,"transactions: gas estimation for tx on boot")})).catch((t=>{const r=this.txStateManager.getTransaction(e.id);r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"failed to estimate gas during boot cleanup."),this._failTransaction(r.id,t)}))})),this.txStateManager.getTransactions({searchCriteria:{status:g.TRANSACTION_STATUSES.APPROVED}}).forEach((e=>{this.approveTransaction(e.id)}))}_setupListeners(){this.txStateManager.on("tx:status-update",this.emit.bind(this,"tx:status-update")),this._setupBlockTrackerListener(),this.pendingTxTracker.on("tx:warning",(e=>{this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:warning")})),this.pendingTxTracker.on("tx:failed",((e,t)=>{this._failTransaction(e,t)})),this.pendingTxTracker.on("tx:confirmed",((e,t,r,n)=>this.confirmTransaction(e,t,r,n))),this.pendingTxTracker.on("tx:dropped",(e=>{this._dropTransaction(e)})),this.pendingTxTracker.on("tx:block-update",((e,t)=>{e.firstRetryBlockNumber||(e.firstRetryBlockNumber=t,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:block-update"))})),this.pendingTxTracker.on("tx:retry",(e=>{"retryCount"in e||(e.retryCount=0),e.retryCount+=1,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:retry")}))}_markNonceDuplicatesDropped(e){const t=this.txStateManager.getTransaction(e),{nonce:r,from:n}=t.txParams,i=this.txStateManager.getTransactions({searchCriteria:{nonce:r,from:n}});i.length&&i.forEach((r=>{r.id!==e&&(r.replacedBy=t.hash,r.replacedById=t.id,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce"),r.status!==g.TRANSACTION_STATUSES.FAILED&&this._dropTransaction(r.id))}))}_setupBlockTrackerListener(){let e=!1;const t=this._onLatestBlock.bind(this),{blockTracker:r,txStateManager:n}=this;function i(){const i=n.getPendingTransactions();!e&&i.length>0?(r.on("latest",t),e=!0):e&&!i.length&&(r.removeListener("latest",t),e=!1)}n.on("tx:status-update",i),i()}async _onLatestBlock(e){try{await this.pendingTxTracker.updatePendingTxs()}catch(e){d.default.error(e)}try{await this.pendingTxTracker.resubmitPendingTxs(e)}catch(e){d.default.error(e)}}_updateMemstore(){const e=this.txStateManager.getUnapprovedTxList(),t=this.txStateManager.getTransactions({limit:100});this.memStore.updateState({unapprovedTxs:e,currentNetworkTxList:t})}_calculateTransactionsCost(e,t){let r="0x0";null!=t&&t.txReceipt&&(r=(0,_.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice));const n=(0,_.calcGasTotal)(e.txReceipt.gasUsed,e.txReceipt.effectiveGasPrice),i=new h.default(n,16).plus(r,16).toString(16);return{approvalGasCostInEth:Number((0,_.hexWEIToDecETH)(r)),tradeGasCostInEth:Number((0,_.hexWEIToDecETH)(n)),tradeAndApprovalGasCostInEth:Number((0,_.hexWEIToDecETH)(i))}}_trackSwapsMetrics(e,t){if(this._getParticipateInMetrics()&&e.swapMetaData)if("0x0"===e.txReceipt.status)this._trackMetaMetricsEvent({event:"Swap Failed",sensitiveProperties:{...e.swapMetaData},category:E.EVENT.CATEGORIES.SWAPS});else{const r=(0,_.getSwapsTokensReceivedFromTxMeta)(e.destinationTokenSymbol,e,e.destinationTokenAddress,e.txParams.from,e.destinationTokenDecimals,t,e.chainId),n=r?`${new h.default(r,10).div(e.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,i=e.txReceipt.gasUsed&&e.swapMetaData.estimated_gas?`${new h.default(e.txReceipt.gasUsed,16).div(e.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,a=this._calculateTransactionsCost(e,t);this._trackMetaMetricsEvent({event:"Swap Completed",category:E.EVENT.CATEGORIES.SWAPS,sensitiveProperties:{...e.swapMetaData,token_to_amount_received:r,quote_vs_executionRatio:n,estimated_vs_used_gasRatio:i,approval_gas_cost_in_eth:a.approvalGasCostInEth,trade_gas_cost_in_eth:a.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:a.tradeAndApprovalGasCostInEth}})}}_allowanceAmountInRelationToDappProposedValue(e,t,r){return e===g.TRANSACTION_APPROVAL_AMOUNT_TYPE.CUSTOM&&t&&r?`${new h.default(t,10).div(r,10).times(100).round(2)}`:null}_allowanceAmountInRelationToTokenBalance(e,t,r){return(e===g.TRANSACTION_APPROVAL_AMOUNT_TYPE.CUSTOM||e===g.TRANSACTION_APPROVAL_AMOUNT_TYPE.DAPP_PROPOSED)&&t&&r?`${new h.default(t,16).div(r,10).times(100).round(2)}`:null}async _buildEventFragmentProperties(e,t){const{type:r,time:n,status:i,chainId:a,origin:s,txParams:{gasPrice:o,gas:c,maxFeePerGas:u,maxPriorityFeePerGas:l,estimateSuggested:d,estimateUsed:h},defaultGasEstimates:f,originalType:p,replacedById:m,metamaskNetworkId:v,customTokenAmount:y,dappProposedTokenAmount:w,currentTokenBalance:E,originalApprovalAmount:k,finalApprovalAmount:x,contractMethodName:A}=e,P=s===T.ORIGIN_METAMASK?"user":"dapp",{assetType:I,tokenStandard:R}=await(0,S.determineTransactionAssetType)(e,this.query,this.getTokenStandardAndDetails),M={};if((0,S.isEIP1559Transaction)(e)?(M.max_fee_per_gas=u,M.max_priority_fee_per_gas=l):M.gas_price=o,f){const{estimateType:t}=f;if(t){M.default_estimate=t;let r=e.defaultGasEstimates.maxFeePerGas,n=e.defaultGasEstimates.maxPriorityFeePerGas;if([b.GAS_RECOMMENDATIONS.LOW,b.GAS_RECOMMENDATIONS.MEDIUM,b.GAS_RECOMMENDATIONS.MEDIUM.HIGH].includes(t)){var C,N;const{gasFeeEstimates:e}=await this._getEIP1559GasFeeEstimates();var O,L;if(null!=e&&null!==(C=e[t])&&void 0!==C&&C.suggestedMaxFeePerGas)r=null===(O=e[t])||void 0===O?void 0:O.suggestedMaxFeePerGas,M.default_max_fee_per_gas=r;if(null!=e&&null!==(N=e[t])&&void 0!==N&&N.suggestedMaxPriorityFeePerGas)n=null===(L=e[t])||void 0===L?void 0:L.suggestedMaxPriorityFeePerGas,M.default_max_priority_fee_per_gas=n}}e.defaultGasEstimates.gas&&(M.default_gas=e.defaultGasEstimates.gas),e.defaultGasEstimates.gasPrice&&(M.default_gas_price=e.defaultGasEstimates.gasPrice)}d&&(M.estimate_suggested=d),h&&(M.estimate_used=h),null!=t&&t.gas_used&&(M.gas_used=t.gas_used);const D=this._getGasValuesInGWEI(M);let B="0";if(e.txParams.maxFeePerGas){const{eip1559V2Enabled:e}=this.preferencesStore.getState();B=e?"2":"1"}const U=[g.TRANSACTION_TYPES.CONTRACT_INTERACTION,g.TRANSACTION_TYPES.TOKEN_METHOD_APPROVE,g.TRANSACTION_TYPES.TOKEN_METHOD_SAFE_TRANSFER_FROM,g.TRANSACTION_TYPES.TOKEN_METHOD_SET_APPROVAL_FOR_ALL,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM,g.TRANSACTION_TYPES.SMART,g.TRANSACTION_TYPES.SWAP,g.TRANSACTION_TYPES.SWAP_APPROVAL].includes(r),F="Approve";let G,j,H,K,q=g.TRANSACTION_TYPES.SIMPLE_SEND;r===g.TRANSACTION_TYPES.CANCEL?q=g.TRANSACTION_TYPES.CANCEL:r===g.TRANSACTION_TYPES.RETRY?q=p:r===g.TRANSACTION_TYPES.DEPLOY_CONTRACT?q=g.TRANSACTION_TYPES.DEPLOY_CONTRACT:U&&(q=g.TRANSACTION_TYPES.CONTRACT_INTERACTION,j=A,j===F&&R===g.TOKEN_STANDARDS.ERC20&&("0"===w||"0"===y?G=g.TRANSACTION_APPROVAL_AMOUNT_TYPE.REVOKE:y?G=g.TRANSACTION_APPROVAL_AMOUNT_TYPE.CUSTOM:w&&(G=g.TRANSACTION_APPROVAL_AMOUNT_TYPE.DAPP_PROPOSED),H=this._allowanceAmountInRelationToDappProposedValue(G,k,x),K=this._allowanceAmountInRelationToTokenBalance(G,w,E)));const V=this._getTransaction(m),W={RETRY:g.TRANSACTION_TYPES.RETRY,CANCEL:g.TRANSACTION_TYPES.CANCEL,SAME_NONCE:"other"};let z;null!=t&&t.dropped&&(z=W.SAME_NONCE,(null==V?void 0:V.type)===g.TRANSACTION_TYPES.CANCEL?z=W.CANCEL:(null==V?void 0:V.type)===g.TRANSACTION_TYPES.RETRY&&(z=W.RETRY));let Y={chain_id:a,referrer:s,source:P,network:v,eip_1559_version:B,gas_edit_type:"none",gas_edit_attempted:"none",account_type:await this.getAccountType(this.getSelectedAddress()),device_model:await this.getDeviceModel(this.getSelectedAddress()),asset_type:I,token_standard:R,transaction_type:q,transaction_speed_up:r===g.TRANSACTION_TYPES.RETRY};j===F&&(Y={...Y,transaction_approval_amount_type:G});let $={status:i,transaction_envelope_type:(0,S.isEIP1559Transaction)(e)?_.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:_.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:n,gas_limit:c,transaction_contract_method:j,transaction_replaced:z,...t,...D};return j===F&&($={...$,transaction_approval_amount_vs_balance_ratio:K,transaction_approval_amount_vs_proposed_ratio:H}),{properties:Y,sensitiveProperties:$}}_createTransactionEventFragment(e,t,r,n,i){const a=`transaction-${[g.TRANSACTION_EVENTS.FINALIZED,g.TRANSACTION_EVENTS.SUBMITTED].includes(t)?"submitted":"added"}-${e.id}`;if(void 0===this.getEventFragmentById(a))switch(t){case g.TRANSACTION_EVENTS.ADDED:this.createEventFragment({category:E.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:g.TRANSACTION_EVENTS.ADDED,successEvent:g.TRANSACTION_EVENTS.APPROVED,failureEvent:g.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:i});break;case g.TRANSACTION_EVENTS.APPROVED:case g.TRANSACTION_EVENTS.REJECTED:this.createEventFragment({category:E.EVENT.CATEGORIES.TRANSACTIONS,successEvent:g.TRANSACTION_EVENTS.APPROVED,failureEvent:g.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:i});break;case g.TRANSACTION_EVENTS.SUBMITTED:this.createEventFragment({category:E.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:g.TRANSACTION_EVENTS.SUBMITTED,successEvent:g.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:i});break;case g.TRANSACTION_EVENTS.FINALIZED:this.createEventFragment({category:E.EVENT.CATEGORIES.TRANSACTIONS,successEvent:g.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:a,actionId:i})}}async _trackTransactionMetricsEvent(e,t,r,n={}){if(!e)return;const{properties:i,sensitiveProperties:a}=await this._buildEventFragmentProperties(e,n);let s;switch(this._createTransactionEventFragment(e,t,i,a,r),t){case g.TRANSACTION_EVENTS.APPROVED:s=`transaction-added-${e.id}`,this.updateEventFragment(s,{properties:i,sensitiveProperties:a}),this.finalizeEventFragment(s);break;case g.TRANSACTION_EVENTS.REJECTED:s=`transaction-added-${e.id}`,this.updateEventFragment(s,{properties:i,sensitiveProperties:a}),this.finalizeEventFragment(s,{abandoned:!0});break;case g.TRANSACTION_EVENTS.FINALIZED:s=`transaction-submitted-${e.id}`,this.updateEventFragment(s,{properties:i,sensitiveProperties:a}),this.finalizeEventFragment(`transaction-submitted-${e.id}`)}}_getTransactionCompletionTime(e){return Math.round((Date.now()-e)/1e3).toString()}_getGasValuesInGWEI(e){const t={};for(const r in e)(0,a.isHexString)(e[r])?t[r]=(0,_.hexWEIToDecGWEI)(e[r]):t[r]=e[r];return t}_failTransaction(e,t,r){this.txStateManager.setTxStatusFailed(e,t);const n=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(n,g.TRANSACTION_EVENTS.FINALIZED,r,{error:t.message})}_dropTransaction(e){this.txStateManager.setTxStatusDropped(e);const t=this.txStateManager.getTransaction(e);this._trackTransactionMetricsEvent(t,g.TRANSACTION_EVENTS.FINALIZED,undefined,{dropped:!0})}}r.default=L}}},{package:"$root$"}],[34,{"fast-json-patch":4658,lodash:5626},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.generateHistoryEntry=s,r.migrateFromSnapshotsToDiffs=function(e){return e.map(((t,r)=>0===r?t:s(e[r-1],t)))},r.replayHistory=function(e){return(0,a.cloneDeep)(e).reduce(((e,t)=>i.default.applyPatch(e,t).newDocument))},r.snapshotFromTxMeta=function(e){const t={...e};return delete t.history,(0,a.cloneDeep)(t)};var n,i=(n=e("fast-json-patch"))&&n.__esModule?n:{default:n},a=e("lodash");function s(e,t,r){const n=i.default.compare(e,t);return n[0]&&(r&&(n[0].note=r),n[0].timestamp=Date.now()),n}}}},{package:"$root$"}],[35,{"../../../../../shared/constants/transaction":6596,"../../../../../shared/modules/hexstring-utils":6610,"../../../../../shared/modules/transaction.utils":6619,"../../../lib/util":85,"eth-rpc-errors":2421},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getFinalStates=function(){return[a.TRANSACTION_STATUSES.REJECTED,a.TRANSACTION_STATUSES.CONFIRMED,a.TRANSACTION_STATUSES.FAILED,a.TRANSACTION_STATUSES.DROPPED]},r.normalizeAndValidateTxParams=function(e,t=!0){const r=u(e,t);return f(r),r},r.normalizeTxParams=u,r.normalizeTxReceiptGasUsed=function(e){return"string"==typeof e?e:e.toString(16)},r.validateConfirmedExternalTransaction=void 0,r.validateFrom=p,r.validateRecipient=m,r.validateTxParams=f;var n=e("eth-rpc-errors"),i=e("../../../lib/util"),a=e("../../../../../shared/constants/transaction"),s=e("../../../../../shared/modules/transaction.utils"),o=e("../../../../../shared/modules/hexstring-utils");const c={from:i.addHexPrefix,to:(e,t)=>t?(0,i.addHexPrefix)(e).toLowerCase():(0,i.addHexPrefix)(e),nonce:i.addHexPrefix,value:i.addHexPrefix,data:i.addHexPrefix,gas:i.addHexPrefix,gasPrice:i.addHexPrefix,maxFeePerGas:i.addHexPrefix,maxPriorityFeePerGas:i.addHexPrefix,type:i.addHexPrefix,estimateSuggested:e=>e,estimateUsed:e=>e};function u(e,t=!0){const r={};for(const n in c)e[n]&&(r[n]=c[n](e[n],t));return r}function l(e,t,r){if(void 0!==e[r])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: specified ${t} but also included ${r}, these cannot be mixed`)}function d(e,t){if("string"!=typeof e[t])throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a string. got: (${e[t]})`)}function h(e,t){switch(t){case"maxFeePerGas":case"maxPriorityFeePerGas":if(e.type&&e.type!==a.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but including maxFeePerGas and maxPriorityFeePerGas requires type: "${a.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET}"`);break;default:if(e.type&&e.type===a.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET)throw n.ethErrors.rpc.invalidParams(`Invalid transaction envelope type: specified type "${e.type}" but included a gasPrice instead of maxFeePerGas and maxPriorityFeePerGas`)}}function f(e,t=!0){if(!e||"object"!=typeof e||Array.isArray(e))throw n.ethErrors.rpc.invalidParams("Invalid transaction params: must be an object.");if(!e.to&&!e.data)throw n.ethErrors.rpc.invalidParams('Invalid transaction params: must specify "data" for contract deployments, or "to" (and optionally "data") for all other types of transactions.');if((0,s.isEIP1559Transaction)({txParams:e})&&!t)throw n.ethErrors.rpc.invalidParams("Invalid transaction params: params specify an EIP-1559 transaction but the current network does not support EIP-1559");Object.entries(e).forEach((([t,r])=>{switch(t){case"from":p(e);break;case"to":m(e);break;case"gasPrice":h(e,"gasPrice"),l(e,"gasPrice","maxFeePerGas"),l(e,"gasPrice","maxPriorityFeePerGas"),d(e,"gasPrice");break;case"maxFeePerGas":h(e,"maxFeePerGas"),l(e,"maxFeePerGas","gasPrice"),d(e,"maxFeePerGas");break;case"maxPriorityFeePerGas":h(e,"maxPriorityFeePerGas"),l(e,"maxPriorityFeePerGas","gasPrice"),d(e,"maxPriorityFeePerGas");break;case"value":if(d(e,"value"),r.toString().includes("-"))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value "${r}": not a positive number.`);if(r.toString().includes("."))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": number must be in wei.`);if(!r.match(/^0x[a-fA-F0-9]+$/u))throw n.ethErrors.rpc.invalidParams(`Invalid transaction value of "${r}": not a valid hex string.`);break;case"chainId":if("number"!=typeof r&&"string"!=typeof r)throw n.ethErrors.rpc.invalidParams(`Invalid transaction params: ${t} is not a Number or hex string. got: (${r})`);break;default:d(e,t)}}))}function p(e){if("string"!=typeof e.from)throw n.ethErrors.rpc.invalidParams(`Invalid "from" address "${e.from}": not a string.`);if(!(0,o.isValidHexAddress)(e.from,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "from" address.')}function m(e){if("0x"===e.to||null===e.to){if(!e.data)throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');delete e.to}else if(e.to!==undefined&&!(0,o.isValidHexAddress)(e.to,{allowNonPrefixed:!1}))throw n.ethErrors.rpc.invalidParams('Invalid "to" address.');return e}r.validateConfirmedExternalTransaction=({txMeta:e,pendingTransactions:t,confirmedTransactions:r}={})=>{if(!e||!e.txParams)throw n.ethErrors.rpc.invalidParams('"txMeta" or "txMeta.txParams" is missing');if(e.status!==a.TRANSACTION_STATUSES.CONFIRMED)throw n.ethErrors.rpc.invalidParams('External transaction status should be "confirmed"');const i=e.txParams.nonce;if(t&&t.length>0){if(t.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in pending txs")}if(r&&r.length>0){if(r.find((e=>{var t;return(null===(t=e.txParams)||void 0===t?void 0:t.nonce)===i})))throw n.ethErrors.rpc.invalidParams("External transaction nonce should not be in confirmed txs")}}}}},{package:"$root$"}],[36,{"../../../../shared/constants/transaction":6596,"./tx-state-manager":38,"ethjs-query":2933,loglevel:5639,"safe-event-emitter":6179},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("safe-event-emitter")),i=c(e("loglevel")),a=c(e("ethjs-query")),s=e("../../../../shared/constants/transaction"),o=e("./tx-state-manager");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends n.default{constructor(e){super(),u(this,"DROPPED_BUFFER_COUNT",3),u(this,"droppedBlocksBufferByHash",new Map),this.query=e.query||new a.default(e.provider),this.nonceTracker=e.nonceTracker,this.getPendingTransactions=e.getPendingTransactions,this.getCompletedTransactions=e.getCompletedTransactions,this.publishTransaction=e.publishTransaction,this.approveTransaction=e.approveTransaction,this.confirmTransaction=e.confirmTransaction}async updatePendingTxs(){const e=await this.nonceTracker.getGlobalLock();try{const e=this.getPendingTransactions();await Promise.all(e.map((e=>this._checkPendingTx(e))))}catch(e){i.default.error("PendingTransactionTracker - Error updating pending transactions"),i.default.error(e)}e.releaseLock()}async resubmitPendingTxs(e){const t=this.getPendingTransactions();if(t.length)for(const i of t)try{await this._resubmitTx(i,e)}catch(e){var r,n;const t=(null===(r=e.value)||void 0===r||null===(n=r.message)||void 0===n?void 0:n.toLowerCase())||e.message.toLowerCase();if(t.includes("replacement transaction underpriced")||t.includes("known transaction")||t.includes("gas price too low to replace")||t.includes("transaction with the same hash was already imported")||t.includes("gateway timeout")||t.includes("nonce too low"))return;i.warning={error:t,message:o.ERROR_SUBMITTING},this.emit("tx:warning",i,e)}}async _resubmitTx(e,t){e.firstRetryBlockNumber||this.emit("tx:block-update",e,t);const r=e.firstRetryBlockNumber||t,n=Number.parseInt(t,16)-Number.parseInt(r,16),i=e.retryCount||0;if(n<Math.min(50,Math.pow(2,i)))return undefined;if(!("rawTx"in e))return this.approveTransaction(e.id);const{rawTx:a}=e,s=await this.publishTransaction(a);return this.emit("tx:retry",e),s}async _checkPendingTx(e){const t=e.hash,r=e.id;if(e.status===s.TRANSACTION_STATUSES.SUBMITTED){if(!t){const e=new Error("We had an error while submitting this transaction, please try again.");return e.name="NoTxHashError",void this.emit("tx:failed",r,e)}if(await this._checkIfNonceIsTaken(e))this.emit("tx:dropped",r);else{try{const e=await this.query.getTransactionReceipt(t);if(null!=e&&e.blockNumber){const{baseFeePerGas:t,timestamp:n}=await this.query.getBlockByHash(null==e?void 0:e.blockHash,!1);return void this.emit("tx:confirmed",r,e,t,n)}}catch(t){return e.warning={error:t.message,message:"There was a problem loading this transaction."},void this.emit("tx:warning",e,t)}await this._checkIfTxWasDropped(e)&&this.emit("tx:dropped",r)}}}async _checkIfTxWasDropped(e){const{hash:t,txParams:{nonce:r,from:n}}=e,i=await this.query.getTransactionCount(n);if(parseInt(r,16)>=i.toNumber())return!1;this.droppedBlocksBufferByHash.has(t)||this.droppedBlocksBufferByHash.set(t,0);const a=this.droppedBlocksBufferByHash.get(t);return a<this.DROPPED_BUFFER_COUNT?(this.droppedBlocksBufferByHash.set(t,a+1),!1):(this.droppedBlocksBufferByHash.delete(t),!0)}async _checkIfNonceIsTaken(e){const t=e.txParams.from;return this.getCompletedTransactions(t).some((t=>!(t.id===e.id)&&t.txParams.nonce===e.txParams.nonce))}}r.default=l}}},{package:"$root$"}],[37,{"../../lib/util":85,"ethereumjs-util":2496,"ethjs-query":2933,lodash:5626,loglevel:5639},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("ethjs-query")),i=c(e("loglevel")),a=e("ethereumjs-util"),s=e("lodash"),o=e("../../lib/util");function c(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(e){this.query=new n.default(e)}async analyzeGasUsage(e){const t=await this.query.getBlockByNumber("latest",!1),r=(0,o.hexToBn)(t.gasLimit),n=(0,o.BnMultiplyByFraction)(r,19,20);let a,s=(0,o.bnToHex)(n);try{s=await this.estimateTxGas(e)}catch(e){i.default.warn(e),a={reason:e.message,errorKey:e.errorKey,debug:{blockNumber:t.number,blockGasLimit:t.gasLimit}}}return{blockGasLimit:t.gasLimit,estimatedGasHex:s,simulationFails:a}}async estimateTxGas(e){const t=(0,s.cloneDeep)(e.txParams);return delete t.gasPrice,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,await this.query.estimateGas(t)}addGasBuffer(e,t,r=1.5){const n=(0,o.hexToBn)(e),i=(0,o.hexToBn)(t).muln(.9),a=n.muln(r);return n.gt(i)?(0,o.bnToHex)(n):a.lt(i)?(0,o.bnToHex)(a):(0,o.bnToHex)(i)}async getBufferedGasLimit(e,t){const{blockGasLimit:r,estimatedGasHex:n,simulationFails:i}=await this.analyzeGasUsage(e);return{gasLimit:this.addGasBuffer((0,a.addHexPrefix)(n),r,t),simulationFails:i}}}}}},{package:"$root$"}],[38,{"../../../../shared/constants/app":6584,"../../../../shared/constants/transaction":6596,"../../../../shared/modules/random-id":6614,"../../../../shared/modules/transaction.utils":6619,"../../metamask-controller":86,"./lib/tx-state-history-helpers":34,"./lib/util":35,"@metamask/obs-store":1217,lodash:5626,loglevel:5639,"safe-event-emitter":6179},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ERROR_SUBMITTING=void 0;var n=p(e("safe-event-emitter")),i=e("@metamask/obs-store"),a=p(e("loglevel")),s=e("lodash"),o=p(e("../../../../shared/modules/random-id")),c=e("../../../../shared/constants/transaction"),u=e("../../metamask-controller"),l=e("../../../../shared/modules/transaction.utils"),d=e("../../../../shared/constants/app"),h=e("./lib/tx-state-history-helpers"),f=e("./lib/util");function p(e){return e&&e.__esModule?e:{default:e}}const m="There was an error when resubmitting this transaction.";r.ERROR_SUBMITTING=m;class g extends n.default{constructor({initState:e,txHistoryLimit:t,getNetwork:r,getCurrentChainId:n}){super(),this.store=new i.ObservableStore({transactions:{},...e}),this.txHistoryLimit=t,this.getNetwork=r,this.getCurrentChainId=n}generateTxMeta(e={}){var t;const r=this.getNetwork(),n=this.getCurrentChainId();if("loading"===r)throw new Error("MetaMask is having trouble connecting to the network");let i=null;return e.txParams&&"string"==typeof e.origin&&e.origin!==d.ORIGIN_METAMASK&&(void 0!==e.txParams.gasPrice?i={gasPrice:e.txParams.gasPrice}:void 0===e.txParams.maxFeePerGas&&void 0===e.txParams.maxPriorityFeePerGas||(i={maxPriorityFeePerGas:e.txParams.maxPriorityFeePerGas,maxFeePerGas:e.txParams.maxFeePerGas}),void 0!==e.txParams.gas&&(i={...i,gas:e.txParams.gas})),{id:(0,o.default)(),time:(new Date).getTime(),status:c.TRANSACTION_STATUSES.UNAPPROVED,metamaskNetworkId:r,originalGasEstimate:null===(t=e.txParams)||void 0===t?void 0:t.gas,userEditedGasLimit:!1,chainId:n,loadingDefaults:!0,dappSuggestedGasFees:i,sendFlowHistory:[],...e}}getUnapprovedTxList(){const e=this.getCurrentChainId(),t=this.getNetwork();return(0,s.pickBy)(this.store.getState().transactions,(r=>r.status===c.TRANSACTION_STATUSES.UNAPPROVED&&(0,l.transactionMatchesNetwork)(r,e,t)))}getApprovedTransactions(e){const t={status:c.TRANSACTION_STATUSES.APPROVED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getPendingTransactions(e){const t={status:c.TRANSACTION_STATUSES.SUBMITTED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getConfirmedTransactions(e){const t={status:c.TRANSACTION_STATUSES.CONFIRMED};return e&&(t.from=e),this.getTransactions({searchCriteria:t})}getTransactionWithActionId(e){return(0,s.values)((0,s.pickBy)(this.store.getState().transactions,(t=>t.actionId===e)))[0]}addTransaction(e){e.txParams&&(e.txParams=(0,f.normalizeAndValidateTxParams)(e.txParams,!1)),this.once(`${e.id}:signed`,(()=>{this.removeAllListeners(`${e.id}:rejected`)})),this.once(`${e.id}:rejected`,(()=>{this.removeAllListeners(`${e.id}:signed`)})),e.history=[];const t=(0,h.snapshotFromTxMeta)(e);e.history.push(t);const r=this.getTransactions({filterToCurrentNetwork:!1}),{txHistoryLimit:n}=this,i=new Set,a=r.reverse().filter((e=>{const{nonce:t,from:r}=e.txParams,{chainId:a,metamaskNetworkId:s,status:o}=e,c=`${t}-${null!=a?a:s}-${r}`;return!i.has(c)&&(!(i.size<n-1||!1===(0,f.getFinalStates)().includes(o))||(i.add(c),!1))})).map((e=>e.id));return this._deleteTransactions(a),this._addTransactionsToState([e]),e}addExternalTransaction(e){var t;const r=null==e||null===(t=e.txParams)||void 0===t?void 0:t.from,n=this.getConfirmedTransactions(r),i=this.getPendingTransactions(r);return(0,f.validateConfirmedExternalTransaction)({txMeta:e,pendingTransactions:i,confirmedTransactions:n}),this._addTransactionsToState([e]),e}getTransaction(e){const{transactions:t}=this.store.getState();return t[e]}updateTransaction(e,t){if(e.txParams)try{e.txParams=(0,f.normalizeAndValidateTxParams)(e.txParams,!1)}catch(t){if(e.warning.message!==m)throw t;return void this.setTxStatusFailed(e.id,t)}this._updateTransactionHistory(e,t)}_updateTransactionHistory(e,t){const r=(0,h.snapshotFromTxMeta)(e),n=(0,h.replayHistory)(e.history),i=(0,h.generateHistoryEntry)(n,r,t);i.length&&e.history.push(i);const a=e.id;this.store.updateState({transactions:{...this.store.getState().transactions,[a]:e}})}getTransactions({searchCriteria:e={},initialList:t,filterToCurrentNetwork:r=!0,limit:n}={}){const i=this.getCurrentChainId(),a=this.getNetwork(),o=(0,s.mapValues)(e,(e=>"function"==typeof e?e:t=>t===e)),c=t?(0,s.keyBy)(t,"id"):this.store.getState().transactions,u=(0,s.sortBy)((0,s.pickBy)(c,(e=>{if(r&&!1===(0,l.transactionMatchesNetwork)(e,i,a))return!1;for(const[t,r]of Object.entries(o))if(t in e.txParams){if(!1===r(e.txParams[t]))return!1}else if(!1===r(e[t]))return!1;return!0})),"time");if(n!==undefined){const e=new Set,t=[];for(let r=u.length-1;r>-1;r--){const i=u[r],{nonce:a}=i.txParams;if(!e.has(a)){if(!(e.size<n))continue;e.add(a)}t.unshift(i)}return t}return u}setTxStatusRejected(e){this._setTransactionStatus(e,c.TRANSACTION_STATUSES.REJECTED),this._deleteTransaction(e)}setTxStatusUnapproved(e){this._setTransactionStatus(e,c.TRANSACTION_STATUSES.UNAPPROVED)}setTxStatusApproved(e){this._setTransactionStatus(e,c.TRANSACTION_STATUSES.APPROVED)}setTxStatusSigned(e){this._setTransactionStatus(e,c.TRANSACTION_STATUSES.SIGNED)}setTxStatusSubmitted(e){const t=this.getTransaction(e);t.submittedTime=(new Date).getTime(),this.updateTransaction(t,"txStateManager - add submitted time stamp"),this._setTransactionStatus(e,c.TRANSACTION_STATUSES.SUBMITTED)}setTxStatusConfirmed(e){this._setTransactionStatus(e,c.TRANSACTION_STATUSES.CONFIRMED)}setTxStatusDropped(e){this._setTransactionStatus(e,c.TRANSACTION_STATUSES.DROPPED)}setTxStatusFailed(e,t){var r;const n=t||new Error("Internal metamask failure"),i=this.getTransaction(e);i.err={message:(null===(r=n.message)||void 0===r?void 0:r.toString())||n.toString(),rpc:n.value,stack:n.stack},this._updateTransactionHistory(i,"transactions:tx-state-manager#fail - add error"),this._setTransactionStatus(e,c.TRANSACTION_STATUSES.FAILED)}wipeTransactions(e){const{transactions:t}=this.store.getState(),r=this.getNetwork(),n=this.getCurrentChainId();this.store.updateState({transactions:(0,s.omitBy)(t,(t=>t.txParams.from===e&&(0,l.transactionMatchesNetwork)(t,n,r)))})}clearUnapprovedTxs(){this.store.updateState({transactions:(0,s.omitBy)(this.store.getState().transactions,(e=>e.status===c.TRANSACTION_STATUSES.UNAPPROVED))})}_setTransactionStatus(e,t){const r=this.getTransaction(e);if(r){r.status=t;try{this._updateTransactionHistory(r,`txStateManager: setting status to ${t}`),this.emit(`${r.id}:${t}`,e),this.emit("tx:status-update",e,t),[c.TRANSACTION_STATUSES.SUBMITTED,c.TRANSACTION_STATUSES.REJECTED,c.TRANSACTION_STATUSES.FAILED].includes(t)&&this.emit(`${r.id}:finished`,r),this.emit(u.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE)}catch(e){a.default.error(e)}}}_addTransactionsToState(e){this.store.updateState({transactions:e.reduce(((e,t)=>(e[t.id]=t,e)),this.store.getState().transactions)})}_deleteTransaction(e){const{transactions:t}=this.store.getState();delete t[e],this.store.updateState({transactions:t})}_deleteTransactions(e){const{transactions:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({transactions:t})}}r.default=g}}},{package:"$root$"}],[39,{"../../shared/constants/app":6584,"./lib/util":85,"webextension-polyfill":6558},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.onMessageReceived=r.checkForMultipleVersionsRunning=void 0;var n,i=(n=e("webextension-polyfill"))&&n.__esModule?n:{default:n},a=e("../../shared/constants/app"),s=e("./lib/util");const o="isRunning";r.onMessageReceived=e=>{e===o&&console.warn("Warning! You have multiple instances of MetaMask running!")};r.checkForMultipleVersionsRunning=async()=>{if((0,s.getPlatform)()!==a.PLATFORM_CHROME&&(0,s.getPlatform)()!==a.PLATFORM_FIREFOX)return;const e=(0,s.getPlatform)()===a.PLATFORM_CHROME?a.CHROME_BUILD_IDS:a.FIREFOX_BUILD_IDS,t=i.default.runtime.id;for(const r of e)if(r!==t)try{await i.default.runtime.sendMessage(r,o)}catch(e){}}}}},{package:"$root$"}],[4,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA=r.SINGLE_CALL_BALANCES_ADDRESS_POLYGON=r.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM=r.SINGLE_CALL_BALANCES_ADDRESS_GOERLI=r.SINGLE_CALL_BALANCES_ADDRESS_FANTOM=r.SINGLE_CALL_BALANCES_ADDRESS_BSC=r.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE=r.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM=r.SINGLE_CALL_BALANCES_ADDRESS=void 0;r.SINGLE_CALL_BALANCES_ADDRESS="0xb1f8e55c7f64d203c1400b9d8555d050f94adf39";r.SINGLE_CALL_BALANCES_ADDRESS_GOERLI="0x9788C4E93f9002a7ad8e72633b11E8d1ecd51f9b";r.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA="";r.SINGLE_CALL_BALANCES_ADDRESS_BSC="0x2352c63A83f9Fd126af8676146721Fa00924d7e4";r.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM="0xB1c568e9C3E6bdaf755A60c7418C269eb11524FC";r.SINGLE_CALL_BALANCES_ADDRESS_POLYGON="0x2352c63A83f9Fd126af8676146721Fa00924d7e4";r.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE="0xD023D153a0DFa485130ECFdE2FAA7e612EF94818";r.SINGLE_CALL_BALANCES_ADDRESS_FANTOM="0x07f697424ABe762bB808c109860c04eA488ff92B";r.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM="0x151E24A486D7258dd7C33Fb67E4bB01919B7B32c"}}},{package:"$root$"}],[40,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={config:{},PreferencesController:{frequentRpcListDetail:[{rpcUrl:"http://localhost:8545",chainId:"0x539",ticker:"ETH",nickname:"Localhost 8545",rpcPrefs:{}}]}};r.default=n}}},{package:"$root$"}],[41,{"@metamask/controllers":1071,"@metamask/obs-store":1217},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/obs-store"),i=e("@metamask/controllers");class a extends n.ObservableStore{constructor({config:e,controllerMessenger:t,state:r,persist:n}){var i,a,s;super(r),s={},(a="config")in(i=this)?Object.defineProperty(i,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):i[a]=s,this.persist=n,this.controllerMessenger=t,e&&this.updateStructure(e)}updateStructure(e){this.config=e,this.removeAllListeners();for(const t of Object.keys(e)){if(!e[t])throw new Error(`Undefined '${t}'`);const r=e[t];r.subscribe?e[t].subscribe((e=>{this.updateState({[t]:e})})):this.controllerMessenger.subscribe(`${r.name}:stateChange`,(r=>{let n=r;this.persist&&(n=(0,i.getPersistentState)(r,e[t].metadata)),this.updateState({[t]:n})}))}}getFlatState(){if(!this.config)return{};let e={};for(const t of Object.keys(this.config)){const r=this.config[t],n=r.getState?r.getState():r.state;e={...e,...n}}return e}}r.default=a}}},{package:"$root$"}],[42,{"../../../shared/constants/network":6589,"../constants/contracts":4,"@metamask/obs-store":1217,"eth-query":2417,ethers:2520,loglevel:5639,pify:5865,"single-call-balance-checker-abi":6286},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=d(e("eth-query")),i=e("@metamask/obs-store"),a=d(e("loglevel")),s=d(e("pify")),o=e("ethers"),c=d(e("single-call-balance-checker-abi")),u=e("../../../shared/constants/network"),l=e("../constants/contracts");function d(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(e={}){this.store=new i.ObservableStore({accounts:{},currentBlockGasLimit:""}),this._provider=e.provider,this._query=(0,s.default)(new n.default(this._provider)),this._blockTracker=e.blockTracker,this._currentBlockNumber=this._blockTracker.getCurrentBlock(),this._blockTracker.once("latest",(e=>{this._currentBlockNumber=e})),this._updateForBlock=this._updateForBlock.bind(this),this.getCurrentChainId=e.getCurrentChainId,this.ethersProvider=new o.ethers.providers.Web3Provider(this._provider)}start(){this._blockTracker.removeListener("latest",this._updateForBlock),this._blockTracker.addListener("latest",this._updateForBlock),this._updateAccounts()}stop(){this._blockTracker.removeListener("latest",this._updateForBlock)}syncWithAddresses(e){const{accounts:t}=this.store.getState(),r=Object.keys(t),n=[];e.forEach((e=>{r.includes(e)||n.push(e)}));const i=[];r.forEach((t=>{e.includes(t)||i.push(t)})),this.addAccounts(n),this.removeAccount(i)}addAccounts(e){const{accounts:t}=this.store.getState();e.forEach((e=>{t[e]={}})),this.store.updateState({accounts:t}),this._currentBlockNumber&&this._updateAccounts()}removeAccount(e){const{accounts:t}=this.store.getState();e.forEach((e=>{delete t[e]})),this.store.updateState({accounts:t})}clearAccounts(){this.store.updateState({accounts:{}})}async _updateForBlock(e){this._currentBlockNumber=e;const t=await this._query.getBlockByNumber(e,!1);if(!t)return;const r=t.gasLimit;this.store.updateState({currentBlockGasLimit:r});try{await this._updateAccounts()}catch(e){a.default.error(e)}}async _updateAccounts(){const{accounts:e}=this.store.getState(),t=Object.keys(e);switch(this.getCurrentChainId()){case u.CHAIN_IDS.MAINNET:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS);break;case u.CHAIN_IDS.GOERLI:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_GOERLI);break;case u.CHAIN_IDS.SEPOLIA:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_SEPOLIA);break;case u.CHAIN_IDS.BSC:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_BSC);break;case u.CHAIN_IDS.OPTIMISM:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_OPTIMISM);break;case u.CHAIN_IDS.POLYGON:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_POLYGON);break;case u.CHAIN_IDS.AVALANCHE:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_AVALANCHE);break;case u.CHAIN_IDS.FANTOM:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_FANTOM);break;case u.CHAIN_IDS.ARBITRUM:await this._updateAccountsViaBalanceChecker(t,l.SINGLE_CALL_BALANCES_ADDRESS_ARBITRUM);break;default:await Promise.all(t.map(this._updateAccount.bind(this)))}}async _updateAccount(e){let t="0x0";try{t=await this._query.getBalance(e)}catch(e){var r,n;if("eth_getBalance"!==(null===(r=e.data)||void 0===r||null===(n=r.request)||void 0===n?void 0:n.method))throw e}const i={address:e,balance:t},{accounts:a}=this.store.getState();a[e]&&(a[e]=i,this.store.updateState({accounts:a}))}async _updateAccountsViaBalanceChecker(e,t){const{accounts:r}=this.store.getState();this.ethersProvider=new o.ethers.providers.Web3Provider(this._provider);const n=await new o.ethers.Contract(t,c.default,this.ethersProvider),i=["0x0000000000000000000000000000000000000000"];try{const t=await n.balances(e,i);e.forEach(((e,n)=>{const i=t[n]?t[n].toHexString():"0x0";r[e]={address:e,balance:i}})),this.store.updateState({accounts:r})}catch(t){a.default.warn("MetaMask - Account Tracker single call balance fetch failed",t),Promise.all(e.map(this._updateAccount.bind(this)))}}}}}},{package:"$root$"}],[44,{},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){let{name:t}=e;t=t===undefined?"Error":String(t);let r=e.message;r=r===undefined?"":String(r),""===t?e.stack=e.message:""===r?e.stack=e.name:e.stack||(e.stack=`${e.name}: ${e.message}`);return e}}}},{package:"$root$"}],[45,{loglevel:5639},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){n((n=>{r.error&&i.default.error("Error in RPC response:\n",r),t.isMetamaskInternal||(i.default.info(`RPC (${e.origin}):`,t,"->",r),n())}))}};var n,i=(n=e("loglevel"))&&n.__esModule?n:{default:n}}}},{package:"$root$"}],[46,{"eth-rpc-errors":2421},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("eth-rpc-errors");var i=(e,t)=>async r=>{if(t._writableState.ended)return;if(!e[r.method])return void t.write({jsonrpc:"2.0",error:n.ethErrors.rpc.methodNotFound({message:`${r.method} not found`}),id:r.id});let i,a;try{i=await e[r.method](...r.params)}catch(e){a=e}t._writableState.ended?a&&console.error(a):a?t.write({jsonrpc:"2.0",error:(0,n.serializeError)(a,{shouldIncludeStack:!0}),id:r.id}):t.write({jsonrpc:"2.0",result:i,id:r.id})};r.default=i}}},{package:"$root$"}],[4657,{"./helpers":4659,"fast-deep-equal":4660},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var n=e("fast-deep-equal"),i=e("./helpers");r.JsonPatchError=i.PatchError,r.deepClone=i._deepClone;var a={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=o(r,this.path);n&&(n=i._deepClone(n));var a=c(r,{op:"remove",path:this.from}).removed;return c(r,{op:"add",path:this.path,value:a}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=o(r,this.from);return c(r,{op:"add",path:this.path,value:i._deepClone(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:n(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},s={add:function(e,t,r){return i.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:a.move,copy:a.copy,test:a.test,_get:a._get};function o(e,t){if(""==t)return e;var r={op:"_get",path:t};return c(e,r),r.value}function c(e,t,c,u,l,h){if(void 0===c&&(c=!1),void 0===u&&(u=!0),void 0===l&&(l=!0),void 0===h&&(h=0),c&&("function"==typeof c?c(t,0,e,t.path):d(t,0)),""===t.path){var f={newDocument:e};if("add"===t.op)return f.newDocument=t.value,f;if("replace"===t.op)return f.newDocument=t.value,f.removed=e,f;if("move"===t.op||"copy"===t.op)return f.newDocument=o(e,t.from),"move"===t.op&&(f.removed=e),f;if("test"===t.op){if(f.test=n(e,t.value),!1===f.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return f.newDocument=e,f}if("remove"===t.op)return f.removed=e,f.newDocument=null,f;if("_get"===t.op)return t.value=e,f;if(c)throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",h,t,e);return f}u||(e=i._deepClone(e));var p=(t.path||"").split("/"),m=e,g=1,v=p.length,b=undefined,y=void 0,w=void 0;for(w="function"==typeof c?c:d;;){if(y=p[g],l&&"__proto__"==y)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(c&&b===undefined&&(m[y]===undefined?b=p.slice(0,g).join("/"):g==v-1&&(b=t.path),b!==undefined&&w(t,0,e,b)),g++,Array.isArray(m)){if("-"===y)y=m.length;else{if(c&&!i.isInteger(y))throw new r.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",h,t,e);i.isInteger(y)&&(y=~~y)}if(g>=v){if(c&&"add"===t.op&&y>m.length)throw new r.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",h,t,e);if(!1===(f=s[t.op].call(t,m,y,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return f}}else if(y&&-1!=y.indexOf("~")&&(y=i.unescapePathComponent(y)),g>=v){if(!1===(f=a[t.op].call(t,m,y,e)).test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",h,t,e);return f}m=m[y]}}function u(e,t,n,a,s){if(void 0===a&&(a=!0),void 0===s&&(s=!0),n&&!Array.isArray(t))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");a||(e=i._deepClone(e));for(var o=new Array(t.length),u=0,l=t.length;u<l;u++)o[u]=c(e,t[u],n,!0,s,u),e=o[u].newDocument;return o.newDocument=e,o}function l(e,t,n){var i=c(e,t);if(!1===i.test)throw new r.JsonPatchError("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function d(e,t,n,s){if("object"!=typeof e||null===e||Array.isArray(e))throw new r.JsonPatchError("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!a[e.op])throw new r.JsonPatchError("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new r.JsonPatchError("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new r.JsonPatchError('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new r.JsonPatchError("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&e.value===undefined)throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&i.hasUndefined(e.value))throw new r.JsonPatchError("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var o=e.path.split("/").length,c=s.split("/").length;if(o!==c+1&&o!==c)throw new r.JsonPatchError("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==s)throw new r.JsonPatchError("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var u=h([{op:"_get",path:e.from,value:undefined}],n);if(u&&"OPERATION_PATH_UNRESOLVABLE"===u.name)throw new r.JsonPatchError("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function h(e,t,n){try{if(!Array.isArray(e))throw new r.JsonPatchError("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)u(i._deepClone(t),i._deepClone(e),n||!0);else{n=n||d;for(var a=0;a<e.length;a++)n(e[a],a,t,undefined)}}catch(e){if(e instanceof r.JsonPatchError)return e;throw e}}r.getValueByPointer=o,r.applyOperation=c,r.applyPatch=u,r.applyReducer=l,r.validator=d,r.validate=h,r.default={JsonPatchError:r.JsonPatchError,deepClone:r.deepClone,getValueByPointer:o,applyOperation:c,applyPatch:u,applyReducer:l,validator:d,validate:h}}}},{package:"fast-json-patch"}],[4658,{"./core":4657,"./helpers":4659},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0});
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var i=e("./helpers"),a=e("./core"),s=e("./core");r.applyOperation=s.applyOperation,r.applyPatch=s.applyPatch,r.applyReducer=s.applyReducer,r.getValueByPointer=s.getValueByPointer,r.validate=s.validate,r.validator=s.validator;var o=e("./helpers");r.JsonPatchError=o.PatchError,r.deepClone=o._deepClone,r.escapePathComponent=o.escapePathComponent,r.unescapePathComponent=o.unescapePathComponent;var c=new WeakMap,u=function(e){this.observers=new Map,this.obj=e},l=function(e,t){this.callback=e,this.observer=t};function d(e,t){t.unobserve()}function h(e,t){var r,n=function(e){return c.get(e)}(e);if(n){var a=function(e,t){return e.observers.get(t)}(n,t);r=a&&a.observer}else n=new u(e),c.set(e,n);if(r)return r;if(r={},n.value=i._deepClone(e),t){r.callback=t,r.next=null;var s=function(){f(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(s)};"undefined"!=typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=[],r.object=e,r.unobserve=function(){f(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},n.observers.set(t,new l(t,r)),r}function f(e,t){void 0===t&&(t=!1);var r=c.get(e.object);p(r.value,e.object,e.patches,"",t),e.patches.length&&a.applyPatch(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function p(e,t,r,n,a){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=i._objectKeys(t),o=i._objectKeys(e),c=!1,u=o.length-1;u>=0;u--){var l=e[h=o[u]];if(!i.hasOwnProperty(t,h)||t[h]===undefined&&l!==undefined&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&r.push({op:"test",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(l)}),r.push({op:"remove",path:n+"/"+i.escapePathComponent(h)}),c=!0):(a&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}),!0);else{var d=t[h];"object"==typeof l&&null!=l&&"object"==typeof d&&null!=d?p(l,d,r,n+"/"+i.escapePathComponent(h),a):l!==d&&(!0,a&&r.push({op:"test",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(l)}),r.push({op:"replace",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(d)}))}}if(c||s.length!=o.length)for(u=0;u<s.length;u++){var h=s[u];i.hasOwnProperty(e,h)||t[h]===undefined||r.push({op:"add",path:n+"/"+i.escapePathComponent(h),value:i._deepClone(t[h])})}}}function m(e,t,r){void 0===r&&(r=!1);var n=[];return p(e,t,n,"",r),n}r.unobserve=d,r.observe=h,r.generate=f,r.compare=m;var g=e("./core"),v=e("./helpers");r.default=n({},g,{unobserve:d,observe:h,generate:f,compare:m,JsonPatchError:v.PatchError,deepClone:i._deepClone,escapePathComponent:i.escapePathComponent,unescapePathComponent:v.unescapePathComponent})}}},{package:"fast-json-patch"}],[4659,{},function(){with(this)return function(){"use strict";return function(e,t,r){
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */
var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a=Object.prototype.hasOwnProperty;function s(e,t){return a.call(e,t)}function o(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);t=[];for(var n in e)s(e,n)&&t.push(n);return t}function c(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function u(e,t){var r;for(var n in e)if(s(e,n)){if(e[n]===t)return c(n)+"/";if("object"==typeof e[n]&&""!=(r=u(e[n],t)))return c(n)+"/"+r}return""}function l(e,t){var r=[e];for(var n in t){var i="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==i&&r.push(n+": "+i)}return r.join("\n")}Object.defineProperty(r,"hasOwnProperty",{value:s}),r._objectKeys=o,r._deepClone=function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},r.isInteger=function(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0},r.escapePathComponent=c,r.unescapePathComponent=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},r._getPathRecursive=u,r.getPath=function(e,t){if(e===t)return"/";var r=u(e,t);if(""===r)throw new Error("Object not found in root");return"/"+r},r.hasUndefined=function e(t){if(t===undefined)return!0;if(t)if(Array.isArray(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0}else if("object"==typeof t){var i=o(t),a=i.length;for(r=0;r<a;r++)if(e(t[i[r]]))return!0}return!1};var d=function(e){function t(t,r,n,i,a){var s=this.constructor,o=e.call(this,l(t,{name:r,index:n,operation:i,tree:a}))||this;return o.name=r,o.index=n,o.operation=i,o.tree=a,Object.setPrototypeOf(o,s.prototype),o.message=l(t,{name:r,index:n,operation:i,tree:a}),o}return i(t,e),t}(Error);r.PatchError=d}}},{package:"fast-json-patch"}],[4660,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty;t.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){var s,o,c,u=n(t),l=n(r);if(u&&l){if((o=t.length)!=r.length)return!1;for(s=o;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(u!=l)return!1;var d=t instanceof Date,h=r instanceof Date;if(d!=h)return!1;if(d&&h)return t.getTime()==r.getTime();var f=t instanceof RegExp,p=r instanceof RegExp;if(f!=p)return!1;if(f&&p)return t.toString()==r.toString();var m=i(t);if((o=m.length)!==i(r).length)return!1;for(s=o;0!=s--;)if(!a.call(r,m[s]))return!1;for(s=o;0!=s--;)if(!e(t[c=m[s]],r[c]))return!1;return!0}return t!=t&&r!=r}}}},{package:"fast-json-patch>fast-deep-equal"}],[4663,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e){for(var t=n.BASE,r=0,i=e.length;r<i;r++)t^=e.charCodeAt(r),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}n.BASE=2166136261,t.exports=n}}},{package:"3box>ipfs>fnv1a"}],[4665,{assert:1594,events:1967,fsm:4666},function(){with(this)return function(){"use strict";return function(e,t,r){const n=e("events").EventEmitter,i=e("assert"),a=e("fsm");t.exports=function(e,t){"object"==typeof e&&(t=e,e="START");i.equal(typeof e,"string"),i.equal(typeof t,"object"),i.ok(t[e],"invalid starting state "+e),i.ok(a.validate(t));const r=new n;return s._graph=a.reachable(t),s._emitter=r,s._events=t,s._state=e,s.emit=s,s.on=function(e,t){r.on(e,t)},s;function s(e){const t=s._events[s._state][e];if(!function(e,t,r){if(!t)return!1;if(!e)return!0;const n=r[e];return!(!n||!n[t])&&1===n[t].length}(s._state,t,s._graph)){const t="invalid transition: "+s._state+" -> "+e;return r.emit("error",t)}const n=s._state+":leave",i=t+":enter";return s._state?void(r._events[n]?r.emit(n,a):a()):a();function a(){r._events[i]?r.emit(i,o):o()}function o(){s._state=t,r.emit(t),r.emit("done")}}}}}},{package:"3box>ipfs>fsm-event"}],[4666,{},function(){with(this)return function(){"use strict";return function(e,t,r){function n(e,t){for(var r in e){t(e[r],r,e)}}function i(e){return Object.keys(e).sort()}function a(e,t){return~e.indexOf(t)}function s(e,t){return e.filter((function(e){return a(t,e)}))}r.validate=function(e){Object.keys(e);return n(e,(function(t,r){n(t,(function(t,n){if(!e[t])throw new Error("invalid transition from state:"+r+" to state:"+t+" on event:"+n)}))})),!0};var o=r.reachable=function(e){var t={},r=!1;do{r=!1,n(e,(function(e,i){var a=t[i]=t[i]||{};n(e,(function(e,t){a[e]||(a[e]=[t],r=!0)})),n(e,(function(e,i){n(t[e],(function(e,t){a[t]||(a[t]=[i].concat(e),r=!0)}))}))}))}while(r);return t};r.terminal=r.deadlock=function(e){var t=[];return n(e,(function(e,r){(function(e){for(var t in e)return!1;return!0})(e)&&t.push(r)})),t};r.livelock=function(e,t){var r=o(e),i=[];return n(r,(function(e,r){a(t,r)||n(t,(function(t){e[t]||a(i,r)||i.push(r)}))})),i.sort()};function c(e){var t=[];return n(e,(function(e,r){n(e,(function(e,r){a(t,r)||t.push(r)}))})),t.sort()}r.combine=function(e,t,r,n){var o,u,l={},d=c(e),h=c(t),f=(u=h,(o=d).filter((function(e){return!a(u,e)})).concat(u.filter((function(e){return!a(o,e)}))).sort());return function r(n,a){var o,c=n+"-"+a;l[c]||(l[c]={}),o=l[c];var u=i(e[n]),d=i(t[a]);return s(u,d).forEach((function(i){o[i]=e[n][i]+"-"+t[a][i],l[o[i]]||r(e[n][i],t[a][i])})),s(f,u).forEach((function(t){o[t]=e[n][t]+"-"+a,l[o[t]]||r(e[n][t],a)})),s(f,d).forEach((function(e){o[e]=n+"-"+t[a][e],l[o[e]]||r(n,t[a][e])})),l[c]}(r,n),l}}}},{package:"3box>ipfs>fsm-event>fsm"}],[4671,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(){if("undefined"==typeof window)return null;var e={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}}}},{package:"3box>ipfs>libp2p-webrtc-star>simple-peer>get-browser-rtc"}],[4673,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports=function(e){if(e){if("function"==typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"==typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"==typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}}}},{package:"3box>ipfs>async-iterator-to-pull-stream>get-iterator"}],[4681,{"./types":4682,"cross-fetch/polyfill":2071},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[0,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&(r[n[i]]=e[n[i]])}return r};Object.defineProperty(r,"__esModule",{value:!0});var o=e("./types"),c=e("./types");r.ClientError=c.ClientError,e("cross-fetch/polyfill");var u=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t){return i(this,void 0,void 0,(function(){var r,i,c,u,l,h,f,p,m;return a(this,(function(a){switch(a.label){case 0:return r=this.options,i=r.headers,c=s(r,["headers"]),u=JSON.stringify({query:e,variables:t||undefined}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:u},c))];case 1:return[4,d(l=a.sent())];case 2:if(h=a.sent(),l.ok&&!h.errors&&h.data)return f=l.headers,p=l.status,[2,n({},h,{headers:f,status:p})];throw m="string"==typeof h?{error:h}:h,new o.ClientError(n({},m,{status:l.status,headers:l.headers}),{query:e,variables:t})}}))}))},e.prototype.request=function(e,t){return i(this,void 0,void 0,(function(){var r,i,c,u,l,h,f;return a(this,(function(a){switch(a.label){case 0:return r=this.options,i=r.headers,c=s(r,["headers"]),u=JSON.stringify({query:e,variables:t||undefined}),[4,fetch(this.url,n({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:u},c))];case 1:return[4,d(l=a.sent())];case 2:if(h=a.sent(),l.ok&&!h.errors&&h.data)return[2,h.data];throw f="string"==typeof h?{error:h}:h,new o.ClientError(n({},f,{status:l.status}),{query:e,variables:t})}}))}))},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var r,n=this.options.headers;return n?n[e]=t:this.options.headers=((r={})[e]=t,r),this},e}();function l(e,t,r){return i(this,void 0,void 0,(function(){return a(this,(function(n){return[2,new u(e).request(t,r)]}))}))}function d(e){return i(this,void 0,void 0,(function(){var t;return a(this,(function(r){return(t=e.headers.get("Content-Type"))&&t.startsWith("application/json")?[2,e.json()]:[2,e.text()]}))}))}r.GraphQLClient=u,r.rawRequest=function(e,t,r){return i(this,void 0,void 0,(function(){return a(this,(function(n){return[2,new u(e).rawRequest(t,r)]}))}))},r.request=l,r.default=l}}},{package:"3box>graphql-request"}],[4682,{},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a=function(e){function t(r,n){var i=this,a=t.extractMessage(r)+": "+JSON.stringify({response:r,request:n});return(i=e.call(this,a)||this).response=r,i.request=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,t),i}return i(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);r.ClientError=a}}},{package:"3box>graphql-request"}],[4683,{"./constants":4687,bech32:4802,bs58check:1975,buffer:1966,"hash.js/lib/hash/ripemd":4845,"hash.js/lib/hash/sha":4846},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var i=e("bech32"),a=n(e("bs58check")),s=e("hash.js/lib/hash/ripemd"),o=e("hash.js/lib/hash/sha"),c=e("./constants"),u=t.from("01","hex"),l=c.BIP_CONSTANTS.PURPOSES,d=c.BIP_CONSTANTS.COINS,h=0,f=169,p=118,m=135,g=136,v=172,b=208,y=240;function w(e,r){return t.concat([e,r])}function E(e){var r=t.alloc(4);return r.writeUInt32LE(e,0),r}function k(e){var r;return e<253?(r=t.alloc(1)).writeUInt8(e,0):e<=65535?((r=t.alloc(3)).writeUInt8(253,0),r.writeUInt16LE(e,1)):e<4294967295?((r=t.alloc(5)).writeUInt8(254,0),r.writeUInt32LE(e,1)):((r=t.alloc(9)).writeUInt8(255,0),r.writeUInt32LE(e>>>0,1),r.writeUInt32LE(e/4294967296|0,5)),r}function S(e,r,n){"number"==typeof e&&(e=e.toString(16));var i=t.alloc(8),a=e.length%2==0?e.toString(16):"0".concat(e.toString(16));return t.from(a,"hex").reverse().copy(i,0),i.copy(r,n),i}function T(e){var r,n;try{r=a.default.decode(e)[0],n=a.default.decode(e).slice(1)}catch(a){try{var s=i.bech32.decode(e);if("bc"===s.prefix)r=b;else{if("tb"!==s.prefix)throw new Error("Unsupported prefix: must be bc or tb.");r=y}if(0!==s.words[0])throw new Error("Unsupported segwit version: must be 0, got ".concat(s.words[0]));n=t.from(i.bech32.fromWords(s.words.slice(1)))}catch(t){throw new Error("Unable to decode address: ".concat(e,": ").concat(t.message))}}return{versionByte:r,pkh:n}}function _(e){if(e.length<2)throw new Error("Path must be >1 index");var t=e[0],r=e[1];if(t===l.BTC_SEGWIT&&r===d.BTC)return b;if(t===l.BTC_SEGWIT&&r===d.BTC_TESTNET)return y;if(t===l.BTC_WRAPPED_SEGWIT&&r===d.BTC)return 5;if(t===l.BTC_WRAPPED_SEGWIT&&r===d.BTC_TESTNET)return 196;if(t===l.BTC_LEGACY&&r===d.BTC)return 0;if(t===l.BTC_LEGACY&&r===d.BTC_TESTNET)return 111;throw new Error("Invalid Bitcoin path provided. Cannot determine address format.")}function x(e){switch(e.signerPath[0]){case l.BTC_LEGACY:return 1;case l.BTC_WRAPPED_SEGWIT:return 3;case l.BTC_SEGWIT:return 4;default:throw new Error("Unsupported path purpose (".concat(e.signerPath[0],"): cannot determine BTC script type."))}}r.default={buildBitcoinTxRequest:function(e){try{var r=e.prevOuts,n=e.recipient,i=e.value,a=e.changePath,s=e.fee;if(!a)throw new Error("No changePath provided.");if(5!==a.length)throw new Error("Please provide a full change path.");var o=t.alloc(59+69*r.length),u=0,l=_(a);o.writeUInt8(l,0),u++,o.writeUInt32LE(a.length,u),u+=4;for(var d=0;d<a.length;d++)o.writeUInt32LE(a[d],u),u+=4;o.writeUInt32LE(s,u),u+=4;var h=T(n);o.writeUInt8(h.versionByte,u),u++,h.pkh.copy(o,u),u+=h.pkh.length,S(i,o,u),u+=8,o.writeUInt8(r.length,u),u++;var f=0;return r.forEach((function(e){if(!e.signerPath||5!==e.signerPath.length)throw new Error("Full recipient path not specified ");o.writeUInt32LE(e.signerPath.length,u),u+=4;for(var r=0;r<e.signerPath.length;r++)o.writeUInt32LE(e.signerPath[r],u),u+=4;o.writeUInt32LE(e.index,u),u+=4,S(e.value,o,u),u+=8,f+=e.value;var n=x(e);o.writeUInt8(n,u),u++,t.isBuffer(e.txHash)||(e.txHash=t.from(e.txHash,"hex")),e.txHash.copy(o,u),u+=e.txHash.length})),{payload:o,schema:c.signingSchema.BTC_TRANSFER,origData:e,changeData:{value:f-(i+s)}}}catch(e){return{err:e}}},serializeTx:function(e){var r=e.inputs,n=e.outputs,i=e.lockTime,a=void 0===i?0:i,c=t.alloc(4),d=0,_=function(e){var t=!1;return e.forEach((function(e){e.signerPath[0]!==l.BTC_SEGWIT&&e.signerPath[0]!==l.BTC_WRAPPED_SEGWIT||(t=!0)})),t}(r);c.writeUInt32LE(2,d),d+=4,_&&(c=w(c,t.from("00","hex")),c=w(c,t.from("01","hex")));var A=k(r.length);c=w(c,A),d+=A.length,r.forEach((function(e){c=w(c,e.hash.reverse()),d+=e.hash.length;var r=E(e.index);c=w(c,r),d+=r.length;var n=x(e);if(3===n){var i=function(e){var r=t.alloc(22),n=t.from((0,o.sha256)().update(e).digest("hex"),"hex"),i=t.from((0,s.ripemd160)().update(n).digest("hex"),"hex");return r.writeUInt8(h,0),r.writeUInt8(i.length,1),i.copy(r,2),r}(e.pubkey),a=k(i.length),l=k((f=t.concat([a,i])).length);c=w(c,l),d+=l.length,c=w(c,f),d+=f.length}else if(1===n){var f=function(e,r){var n=k((e=t.concat([e,u])).length),i=k(r.length),a=t.concat([n,e,i,r]),s=k(a.length);return t.concat([s,a])}(e.sig,e.pubkey);c=w(c,f),d+=f.length}else if(4===n){var p=t.from("00","hex");c=w(c,p),d+=1}var m=E(4294967295);c=w(c,m),d+=m.length}));var P=k(n.length);if(c=w(c,P),d+=P.length,n.forEach((function(e){var r,n,i=(r=e.value,n=t.alloc(8),S(r,n,0),n);c=w(c,i),d+=i.length;var a=function(e){var r=T(e);switch(r.versionByte){case b:case y:return n=r.pkh,(i=t.alloc(2+n.length)).writeUInt8(h,0),i.writeUInt8(n.length,1),n.copy(i,2),i;case 5:case 196:return function(e){var r=t.alloc(3+e.length),n=0;return r.writeUInt8(f,n),n++,r.writeUInt8(e.length,n),n++,e.copy(r,n),n+=e.length,r.writeUInt8(m,n),n++,r}(r.pkh);case 0:case 111:return function(e){var r=t.alloc(5+e.length),n=0;return r.writeUInt8(p,n),n++,r.writeUInt8(f,n),n++,r.writeUInt8(e.length,n),n++,e.copy(r,n),n+=e.length,r.writeUInt8(g,n),n++,r.writeUInt8(v,n),n++,r}(r.pkh);default:throw new Error("Unknown version byte: ".concat(r.versionByte,". Cannot build BTC transaction."))}var n,i}(e.recipient),s=k(a.length);c=w(c,s),d+=s.length,c=w(c,a),d+=a.length})),_){for(var I=[],R=[],M=0;M<r.length;M++)I.push(r[M].sig),R.push(r[M].pubkey);var C=function(e,r){var n=t.alloc(0),i=t.alloc(1);i.writeUInt8(2,0);for(var a=0;a<e.length;a++){var s=t.concat([e[a],u]),o=k(s.length),c=r[a],l=k(c.length);n=t.concat([n,i,o,s,l,c])}return n}(I,R);c=w(c,C),d+=C.length}return t.concat([c,E(a)]).toString("hex")},getBitcoinAddress:function(e,r){var n=null,s=null;if(r===b?(n="bc",s=0):r===y&&(n="tb",s=0),null!==n&&null!==s){var o=i.bech32.toWords(e);return o.unshift(s),i.bech32.encode(n,o)}return a.default.encode(t.concat([t.from([r]),e]))},getAddressFormat:_}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4684,{"@ethersproject/abi":438,buffer:1966,"js-sha3":5199},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.replaceNestedDefs=r.getNestedCalldata=r.parseCanonicalName=r.parseSolidityJSONABI=void 0;var n=e("js-sha3"),i=e("@ethersproject/abi");r.parseSolidityJSONABI=function(e,t){e=s(e);var r=t.filter((function(e){return"function"===e.type})).find((function(t){return a(l(t).canonicalName)===e}));if(r)return{def:l(r).def};throw new Error("Unable to find matching function in ABI")};r.parseCanonicalName=function(e,t){if((e=s(e))!==a(t))throw new Error("Name does not match provided sig.");var r=[],n=t.indexOf("(");if(n<0)throw new Error(b);r.push(t.slice(0,n)),t=t.slice(n+1);for(var i=[];t.length>1;){var u=o(t);i=i.concat(c(u)),t=t.slice(u.length+1)}var l=d(i);return r.concat(l)};r.getNestedCalldata=function(e,r){var n=[],a=e.slice(1),s=function(e){for(var t=[],r=function(r){var n=e[r],i=y[n[1]];n[2]&&(i="".concat(i).concat(8*n[2])),n[3].length>0&&n[3].forEach((function(e){i=0===n[3][e]?"".concat(i,"[]"):"".concat(i,"[").concat(n[3][e],"]")})),t.push(i)},n=0;n<e.length;n++)r(n);return t}(a);function o(e){return(e.length-4)%32==0}return(new i.AbiCoder).decode(s,"0x"+r.slice(4).toString("hex")).forEach((function(e,r){if(m(a[r])){var i=!0;if(v(a[r]))e.forEach((function(e){o(t.from(e.slice(2),"hex"))||(i=!1)}));else if(g(a[r])){var s=t.from(e.slice(2),"hex");i=o(s)}else i=!1;n.push(i?e:null)}else n.push(null)})),n};function a(e){return"0x".concat((0,n.keccak256)(e).slice(0,8))}function s(e){if("string"!=typeof e||10!==e.length&&8!==e.length)throw new Error("`sig` must be a hex string with 4 bytes of data.");return 8===e.length&&(e="0x".concat(e)),e}function o(e){if(p(e))return f(e);if(e.indexOf(",")>-1)return e.slice(0,e.indexOf(","));if(e.indexOf(")")>-1)return e.slice(0,e.indexOf(")"));throw new Error(b)}function c(e){if(!p(e))return[u(e)];var t={szBytes:0,typeIdx:y.indexOf("tuple"),arraySzs:[]},r=f(e,!1),n=e.slice(r.length);t.arraySzs=h(n),r=r.slice(1);for(var i=[];r.length>0;){var a=o(r);r=r.slice(a.length+1),i=i.concat(c(a))}if(!i.length)throw new Error(b);return[t,i]}function u(e){var t={szBytes:0,typeIdx:0,arraySzs:[]},r=!1;if(y.forEach((function(n,i){if(e.indexOf(n)>-1&&!r){t.typeIdx=i,t.arraySzs=h(e);var a=t.arraySzs.length>0?e.indexOf("["):e.length,s=e.slice(n.length,a);if(parseInt(s)&&(t.szBytes=parseInt(s)/8,t.szBytes>32))throw new Error(b);r=!0}})),!r)throw new Error(b);return t}function l(e,t,r,n){if(void 0===t&&(t=""),void 0===r&&(r=[]),void 0===n&&(n=!1),!n){var i=e.name||"";r.push(i),t+=i}return e.inputs&&(t+="(",e.inputs.forEach((function(e){var n=function(e){if(!e.type)throw new Error("No type in input");var t=[e.name],r=function(e){var t,r={szBytes:0,typeIdx:0,arraySzs:[]};y.forEach((function(n,i){e.indexOf(n)>-1&&!t&&(t=n,r.typeIdx=i)})),r.arraySzs=h(e);var n=r.arraySzs.length>0?e.indexOf("["):e.length;if(["uint","int","bytes"].indexOf(t)>-1){var i=parseInt(e.slice(t.length,n))||0;if(i>256)throw new Error("Invalid param size");r.szBytes=i/8}else r.szBytes=0;return r}(e.type),n=r.typeIdx,i=r.szBytes,a=r.arraySzs;return t.push(n),t.push(i),t.push(a),t}(e);if(e.type.indexOf("tuple")>-1&&e.components){var i=l({inputs:e.components},t,[],!0);t=i.canonicalName,t+="".concat(e.type.slice(5),","),n.push(i.def)}else t+=e.type,t+=",";r.push(n)})),","===t[t.length-1]&&(t=t.slice(0,t.length-1)),t+=")"),{def:r,canonicalName:t}}function d(e,t){void 0===t&&(t="");var r=[],n=0;return e.forEach((function(e,i){Array.isArray(e)?r[r.length-1].push(d(e,"".concat(i,"-"))):r.push(["#".concat(t).concat(i+1-n),e.typeIdx,e.szBytes,e.arraySzs]),e.typeIdx===y.indexOf("tuple")&&(n+=1)})),r}function h(e){if("string"!=typeof e)throw new Error("Invalid type");for(var t=[],r=e;r.length>0;){var n=r.indexOf("[");if(n<0)return t;var i=r.slice(n),a=i.indexOf("]");if(a<0)throw new Error("Bad param type");var s=i.slice(1,a);0===s.length?t.push(0):t.push(parseInt(s)),r=i.slice(a+1)}return t}function f(e,t){void 0===t&&(t=!0);for(var r=0,n=!1,i=0;i<e.length;i++){"("===e[i]?(r+=1,n=!0):")"===e[i]&&(r-=1);var a=","===e[i+1]||")"===e[i+1]||i===e.length-1;if(t||"["!==e[i+1]||(a=!0),!r&&n&&a)return e.slice(0,i+1)}throw new Error(b)}function p(e){return"("===e[0]}function m(e){return"bytes"===y[e[1]]}function g(e){return m(e)&&0===e[3].length}function v(e){return m(e)&&1===e[3].length&&0===e[3][0]}r.replaceNestedDefs=function(e,t){for(var r=0;r<t.length;r++){var n=v(e[1+r]),i=g(e[1+r]);if(null!==t[r]&&(n||i)){e[1+r][1]=y.indexOf("nestedDef");var a=n?t[r]:[t[r]];e[1+r]=e[1+r].concat([a])}}return e};var b="Could not parse canonical function name.",y=[null,"address","bool","uint","int","bytes","string","tuple","nestedDef"]}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4685,{"./evm":4684},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CALLDATA=void 0;var n=e("./evm");r.CALLDATA={EVM:{type:1,parsers:{parseSolidityJSONABI:n.parseSolidityJSONABI,parseCanonicalName:n.parseCanonicalName},processors:{getNestedCalldata:n.getNestedCalldata,replaceNestedDefs:n.replaceNestedDefs}}}}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4686,{"./constants":4687,"./functions/index":4694,"./shared/functions":4701,"./shared/validators":4704,"./util":4705,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.Client=void 0;var a=e("./constants"),s=e("./functions/index"),o=e("./shared/functions"),c=e("./shared/validators"),u=e("./util"),l=function(){function e(e){var t=e.baseUrl,r=e.name,n=e.privKey,i=e.stateData,s=e.timeout,c=e.retryCount,l=e.skipRetryOnWrongWallet;this.name=r||"Unknown",this.baseUrl=t||a.BASE_URL,this.deviceId=null,this.isPaired=!1,this.activeWallets=a.DEFAULT_ACTIVE_WALLETS,this.timeout=s||6e4,this.retryCount=c||3,this.skipRetryOnWrongWallet=l||!1,this.privKey=n||(0,u.randomBytes)(32),this.key=(0,u.getP256KeyPair)(this.privKey),this.retryWrapper=(0,o.buildRetryWrapper)(this,this.retryCount),i&&this.unpackAndApplyStateData(i)}return Object.defineProperty(e.prototype,"sharedSecret",{get:function(){return t.from(this.key.derive(this.ephemeralPub.getPublic()).toArray("be",32))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ephemeralPub",{get:function(){return this._ephemeralPub},set:function(e){(0,c.validateEphemeralPub)(e),this._ephemeralPub=e},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.retryWrapper(s.connect,{id:e})]}))}))},e.prototype.pair=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.retryWrapper(s.pair,{pairingSecret:e})]}))}))},e.prototype.getAddresses=function(e){var t=e.startPath,r=e.n,a=void 0===r?1:r,o=e.flag,c=void 0===o?0:o;return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.retryWrapper(s.getAddresses,{startPath:t,n:a,flag:c})]}))}))},e.prototype.sign=function(e){var t=e.data,r=e.currency,a=e.cachedData,o=e.nextCode;return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.retryWrapper(s.sign,{data:t,currency:r,cachedData:a,nextCode:o})]}))}))},e.prototype.fetchActiveWallet=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.retryWrapper(s.fetchActiveWallet)]}))}))},e.prototype.addKvRecords=function(e){var t=e.type,r=void 0===t?0:t,a=e.records,o=e.caseSensitive,c=void 0!==o&&o;return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.retryWrapper(s.addKvRecords,{type:r,records:a,caseSensitive:c})]}))}))},e.prototype.getKvRecords=function(e){var t=e.type,r=void 0===t?0:t,a=e.n,o=void 0===a?1:a,c=e.start,u=void 0===c?0:c;return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.retryWrapper(s.getKvRecords,{type:r,n:o,start:u})]}))}))},e.prototype.removeKvRecords=function(e){var t=e.type,r=void 0===t?0:t,a=e.ids,o=void 0===a?[]:a;return n(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.retryWrapper(s.removeKvRecords,{type:r,ids:o})]}))}))},e.prototype.getActiveWallet=function(){return this.activeWallets.external.uid&&!a.EMPTY_WALLET_UID.equals(this.activeWallets.external.uid)?this.activeWallets.external:this.activeWallets.internal.uid&&!a.EMPTY_WALLET_UID.equals(this.activeWallets.internal.uid)?this.activeWallets.internal:undefined},e.prototype.hasActiveWallet=function(){return!!this.getActiveWallet()},e.prototype.resetActiveWallets=function(){this.activeWallets=a.DEFAULT_ACTIVE_WALLETS},e.prototype.getStateData=function(){return this.packStateData()},e.prototype.getFwConstants=function(){var e;return(0,a.getFwVersionConst)(null!==(e=this.fwVersion)&&void 0!==e?e:t.alloc(0))},e.prototype.getFwVersion=function(){return this.fwVersion&&this.fwVersion.length>=3?{fix:this.fwVersion[0],minor:this.fwVersion[1],major:this.fwVersion[2]}:{fix:0,minor:0,major:0}},e.prototype.getAppName=function(){return this.name},e.prototype.packStateData=function(){var e,t,r,n,i;try{var a={activeWallets:{internal:{uid:null===(e=this.activeWallets.internal.uid)||void 0===e?void 0:e.toString("hex"),name:null===(t=this.activeWallets.internal.name)||void 0===t?void 0:t.toString(),capabilities:this.activeWallets.internal.capabilities},external:{uid:null===(r=this.activeWallets.external.uid)||void 0===r?void 0:r.toString("hex"),name:null===(n=this.activeWallets.external.name)||void 0===n?void 0:n.toString(),capabilities:this.activeWallets.external.capabilities}},ephemeralPub:this.ephemeralPub.getPublic().encode("hex"),fwVersion:null===(i=this.fwVersion)||void 0===i?void 0:i.toString("hex"),deviceId:this.deviceId,name:this.name,baseUrl:this.baseUrl,privKey:this.privKey.toString("hex"),retryCount:this.retryCount,timeout:this.timeout};return JSON.stringify(a)}catch(e){return console.warn("Could not pack state data."),null}},e.prototype.unpackAndApplyStateData=function(e){try{var r=JSON.parse(e),n={uid:t.from(r.activeWallets.internal.uid,"hex"),name:t.from(r.activeWallets.internal.name),capabilities:r.activeWallets.internal.capabilities,external:!1},i={uid:t.from(r.activeWallets.external.uid,"hex"),name:t.from(r.activeWallets.external.name),capabilities:r.activeWallets.external.capabilities,external:!0},a=t.from(r.ephemeralPub,"hex"),s=t.from(r.fwVersion,"hex"),c=t.from(r.privKey,"hex");this.activeWallets.internal=n,this.activeWallets.external=i,this.ephemeralPub=(0,u.getP256KeyPairFromPub)(a),this.fwVersion=s,this.deviceId=r.deviceId,this.name=r.name,this.baseUrl=r.baseUrl,this.url="".concat(this.baseUrl,"/").concat(this.deviceId),this.privKey=c,this.key=(0,u.getP256KeyPair)(this.privKey),this.retryCount=r.retryCount,this.timeout=r.timeout,this.retryWrapper=(0,o.buildRetryWrapper)(this,this.retryCount)}catch(e){console.warn("Could not apply state data.")}},e}();r.Client=l}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4687,{buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){var t,n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),r.ETH_ABI_LATTICE_FW_TYPE_MAP=r.MAX_CHAIN_ID_BYTES=r.HANDLE_LARGER_CHAIN_ID=r.HARDENED_OFFSET=r.VERSION_BYTE=r.REQUEST_TYPE_BYTE=r.signingSchema=r.responseMsgs=r.responseCodes=r.messageConstants=r.ethMsgProtocol=r.encReqCodes=r.deviceCodes=r.decResLengths=r.addressSizes=r.ENC_MSG_LEN=r.EXTERNAL_NETWORKS_BY_CHAIN_ID_URL=r.NETWORKS_BY_CHAIN_ID=r.MAX_ADDR=r.CURRENCIES=r.BASE_URL=r.BIP_CONSTANTS=r.AES_IV=r.ADDR_STR_LEN=r.getFwVersionConst=r.ASCII_REGEX=r.DEFAULT_ACTIVE_WALLETS=r.EMPTY_WALLET_UID=r.EXTERNAL=void 0;r.AES_IV=[109,121,115,101,99,114,101,116,112,97,115,115,119,111,114,100];r.ADDR_STR_LEN=129;var i={empty:0,getAddresses:1290,sign:1090,getWallets:142,getKvRecords:1395,getDecoders:1608,removeDecoders:4,test:1646};r.decResLengths=i;var a=0;r.ENC_MSG_LEN=a,Object.keys(i).forEach((function(e){i[e]+82>a&&(r.ENC_MSG_LEN=a=i[e]+82)}));r.deviceCodes={CONNECT:1,ENCRYPTED_REQUEST:2};r.encReqCodes={FINALIZE_PAIRING:0,GET_ADDRESSES:1,ADD_PERMISSION:2,SIGN_TRANSACTION:3,GET_WALLETS:4,ADD_PERMISSION_V0:5,ADD_DECODERS:6,GET_KV_RECORDS:7,ADD_KV_RECORDS:8,REMOVE_KV_RECORDS:9,GET_DECODERS:10,REMOVE_DECODERS:11,TEST:12};r.messageConstants={NOT_PAIRED:0,PAIRED:1};r.addressSizes={BTC:20,ETH:20};var s={RESP_SUCCESS:0,RESP_ERR_INVALID_MSG:128,RESP_ERR_UNSUPPORTED_VER:129,RESP_ERR_DEV_BUSY:130,RESP_ERR_USER_TIMEOUT:131,RESP_ERR_USER_DECLINED:132,RESP_ERR_PAIR_FAIL:133,RESP_ERR_PAIR_DISABLED:134,RESP_ERR_PERMISSION_DISABLED:135,RESP_ERR_INTERNAL:136,RESP_ERR_GCE_TIMEOUT:137,RESP_ERR_WRONG_WALLET:138,RESP_ERR_DEV_LOCKED:139,RESP_ERR_DISABLED:140,RESP_ERR_ALREADY:141,RESP_ERR_INVALID_EPHEM_ID:142};r.responseCodes=s;r.CURRENCIES={ETH:"ETH",BTC:"BTC",ETH_MSG:"ETH_MSG"};var o=((t={})[s.RESP_SUCCESS]=0,t[s.RESP_ERR_INVALID_MSG]="Invalid request",t[s.RESP_ERR_UNSUPPORTED_VER]="Unsupported version",t[s.RESP_ERR_DEV_BUSY]="Device busy",t[s.RESP_ERR_USER_TIMEOUT]="Timeout waiting for user",t[s.RESP_ERR_USER_DECLINED]="Request declined by user",t[s.RESP_ERR_PAIR_FAIL]="Pairing failed",t[s.RESP_ERR_PAIR_DISABLED]="Pairing is currently disabled",t[s.RESP_ERR_PERMISSION_DISABLED]="Automated signing is currently disabled",t[s.RESP_ERR_INTERNAL]="Device error",t[s.RESP_ERR_GCE_TIMEOUT]="Timeout",t[s.RESP_ERR_WRONG_WALLET]="Active wallet does not match request",t[s.RESP_ERR_DEV_LOCKED]="Device locked",t[s.RESP_ERR_DISABLED]="Disabled",t[s.RESP_ERR_ALREADY]="Record already exists. You must first remove it on your device.",t[s.RESP_ERR_INVALID_EPHEM_ID]="Could not find requester. Please reconnect.",t);r.responseMsgs=o;r.signingSchema={BTC_TRANSFER:0,ETH_TRANSFER:1,ERC20_TRANSFER:2,ETH_MSG:3,EXTRA_DATA:4,GENERAL_SIGNING:5};var c=2147483648;r.HARDENED_OFFSET=c;var u={PURPOSES:{ETH:2147483692,BTC_LEGACY:2147483692,BTC_WRAPPED_SEGWIT:2147483697,BTC_SEGWIT:2147483732},COINS:{ETH:2147483708,BTC:c,BTC_TESTNET:2147483649}};r.BIP_CONSTANTS=u;r.REQUEST_TYPE_BYTE=2;r.VERSION_BYTE=1;r.HANDLE_LARGER_CHAIN_ID=255;r.MAX_CHAIN_ID_BYTES=8;r.BASE_URL="https://signing.gridpl.us";var l={address:1,bool:2,uint8:3,uint16:4,uint24:5,uint32:6,uint40:7,uint48:8,uint56:9,uint64:10,uint72:11,uint80:12,uint88:13,uint96:14,uint104:15,uint112:16,uint120:17,uint128:18,uint136:19,uint144:20,uint152:21,uint160:22,uint168:23,uint176:24,uint184:25,uint192:26,uint200:27,uint208:28,uint216:29,uint224:30,uint232:31,uint240:32,uint248:33,uint256:34,int8:35,int16:36,int24:37,int32:38,int40:39,int48:40,int56:41,int64:42,int72:43,int80:44,int88:45,int96:46,int104:47,int112:48,int120:49,int128:50,int136:51,int144:52,int152:53,int160:54,int168:55,int176:56,int184:57,int192:58,int200:59,int208:60,int216:61,int224:62,int232:63,int240:64,int248:65,int256:66,uint:67,bytes1:69,bytes2:70,bytes3:71,bytes4:72,bytes5:73,bytes6:74,bytes7:75,bytes8:76,bytes9:77,bytes10:78,bytes11:79,bytes12:80,bytes13:81,bytes14:82,bytes15:83,bytes16:84,bytes17:85,bytes18:86,bytes19:87,bytes20:88,bytes21:89,bytes22:90,bytes23:91,bytes24:92,bytes25:93,bytes26:94,bytes27:95,bytes28:96,bytes29:97,bytes30:98,bytes31:99,bytes32:100,bytes:101,string:102},d=n(n({},l),{tuple1:103,tuple2:104,tuple3:105,tuple4:106,tuple5:107,tuple6:108,tuple7:109,tuple8:110,tuple9:111,tuple10:112,tuple11:113,tuple12:114,tuple13:115,tuple14:116,tuple15:117,tuple16:118,tuple17:119});r.ETH_ABI_LATTICE_FW_TYPE_MAP=d;var h={SIGN_PERSONAL:{str:"signPersonal",enumIdx:0},TYPED_DATA:{str:"typedData",enumIdx:1,rawDataMaxLen:1629,typeCodes:l}};r.ethMsgProtocol=h,r.EXTERNAL={GET_ADDR_FLAGS:{SECP256K1_PUB:3,ED25519_PUB:4},SIGNING:{HASHES:{NONE:0,KECCAK256:1,SHA256:2},CURVES:{SECP256K1:0,ED25519:1},ENCODINGS:{NONE:1,SOLANA:2,TERRA:3,EVM:4}}},r.getFwVersionConst=function(e){var t={extraDataFrameSz:0,extraDataMaxFrames:0,genericSigning:{}};function n(e,t){return e[2]>t[0]||e[2]===t[0]&&e[1]>t[1]||e[2]===t[0]&&e[1]===t[1]&&e[0]>t[2]||e[2]===t[0]&&e[1]===t[1]&&e[0]===t[2]}var i=0===e.length;return!i&&n(e,[0,10,4])||!i&&n(e,[0,10,0])?(t.reqMaxDataSz=1678,t.ethMaxGasPrice=2e13,t.addrFlagsAllowed=!0):(t.reqMaxDataSz=1152,t.ethMaxGasPrice=5e11,t.addrFlagsAllowed=!1),t.ethMaxDataSz=t.reqMaxDataSz-128,t.ethMaxMsgSz=t.ethMaxDataSz,t.eip712MaxTypeParams=18,!i&&n(e,[0,10,4])&&(t.extraDataFrameSz=1500,t.extraDataMaxFrames=1),!i&&n(e,[0,10,5])&&(t.varAddrPathSzAllowed=!0,t.eip712Supported=!0),!i&&n(e,[0,10,8])&&(t.prehashAllowed=!0),!i&&n(e,[0,10,10])&&(t.ethMsgPreHashAllowed=!0),!i&&n(e,[0,11,0])&&(t.allowedEthTxTypes=[1,2],t.ethMaxDataSz-=10,t.ethMaxMsgSz=t.ethMaxDataSz),!i&&n(e,[0,11,2])&&(t.personalSignHeaderSz=72),!i&&n(e,[0,12,0])&&(t.kvActionsAllowed=!0,t.kvKeyMaxStrSz=63,t.kvValMaxStrSz=63,t.kvActionMaxNum=10,t.kvRemoveMaxNum=100),!i&&n(e,[0,13,0])&&(t.allowBtcLegacyAndSegwitAddrs=!0,t.contractDeployKey="0x08002e0fec8e6acf00835f43c9764f7364fa3f42"),!i&&n(e,[0,14,0])&&(t.abiCategorySz=32,t.abiMaxRmv=200,t.genericSigning.baseReqSz=1552,t.genericSigning.baseDataSz=1519,t.genericSigning.hashTypes=r.EXTERNAL.SIGNING.HASHES,t.genericSigning.curveTypes=r.EXTERNAL.SIGNING.CURVES,t.genericSigning.encodingTypes={NONE:r.EXTERNAL.SIGNING.ENCODINGS.NONE,SOLANA:r.EXTERNAL.SIGNING.ENCODINGS.SOLANA},t.getAddressFlags=[r.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB,r.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB],t.eip712MaxTypeParams=36),!i&&n(e,[0,14,1])&&(t.genericSigning.encodingTypes.TERRA=r.EXTERNAL.SIGNING.ENCODINGS.TERRA),!i&&n(e,[0,15,0])&&(t.genericSigning.encodingTypes.EVM=r.EXTERNAL.SIGNING.ENCODINGS.EVM,t.ethMaxDataSz=1519,t.maxDecoderBufSz=1600,t.genericSigning.calldataDecoding={reserved:2895728,maxSz:1024}),t};r.ASCII_REGEX=/^[\x00-\x7F]+$/;r.EXTERNAL_NETWORKS_BY_CHAIN_ID_URL="https://gridplus.github.io/chains/chains.json";r.MAX_ADDR=10;r.NETWORKS_BY_CHAIN_ID={1:{name:"ethereum",baseUrl:"https://api.etherscan.io",apiRoute:"api?module=contract&action=getabi"},137:{name:"polygon",baseUrl:"https://api.polygonscan.com",apiRoute:"api?module=contract&action=getabi"},56:{name:"binance",baseUrl:"https://api.bscscan.com",apiRoute:"api?module=contract&action=getabi"},43114:{name:"avalanche",baseUrl:"https://api.snowtrace.io",apiRoute:"api?module=contract&action=getabi"}},r.EMPTY_WALLET_UID=e.alloc(32),r.DEFAULT_ACTIVE_WALLETS={internal:{uid:r.EMPTY_WALLET_UID,external:!1,name:e.alloc(0),capabilities:0},external:{uid:r.EMPTY_WALLET_UID,external:!0,name:e.alloc(0),capabilities:0}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4688,{"./constants":4687,"./util":4705,"@ethereumjs/common":4738,"@ethereumjs/tx":4742,"bignumber.js":4803,borc:1929,buffer:1966,"eth-eip712-util-browser":2248,"js-sha3":5199,rlp:4804,secp256k1:4805},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var o=a(e("@ethereumjs/common")),c=e("@ethereumjs/tx"),u=s(e("bignumber.js")),l=s(e("borc")),d=e("eth-eip712-util-browser"),h=e("js-sha3"),f=e("rlp"),p=s(e("secp256k1")),m=e("./constants"),g=e("./util");function v(e){for(var t=e[0];e.length>0&&"0"===t.toString();)t=(e=e.slice(1))[0];return e}function b(e,r,n,i){void 0===i&&(i={});try{var a=new Uint8Array(e),s=0,o=(0,g.fixLen)(r.r,32);r.r=o;var c=(0,g.fixLen)(r.s,32);r.s=c;var u=new Uint8Array(t.concat([o,c])),l=p.default.ecdsaRecover(u,s,a,!1).slice(1);if(y(l)===n.toString("hex"))return r.v=w(s,i),r;if(s=1,y(l=p.default.ecdsaRecover(u,s,a,!1).slice(1))===n.toString("hex"))return r.v=w(s,i),r;throw new Error("Invalid Ethereum signature returned.")}catch(e){throw new Error(e)}}function y(e){return(0,h.keccak256)(e).slice(-40)}function w(e,r){void 0===r&&(r={});var n=r.chainId,i=r.useEIP155,a=r.type;if(1===a||2===a)return(0,g.ensureHexBuffer)(e,!0);if(!1===i||null===n)return t.from(new u.default(e).plus(27).toString(16),"hex");var s=k(n),o=new u.default(s.toString("hex"),16);return(0,g.ensureHexBuffer)("0x".concat(o.times(2).plus(35).plus(e).toString(16)))}var E={mainnet:1,roptsten:3,rinkeby:4,kovan:42,goerli:5};function k(e){var r,n;if((r=!0===S(e)?(0,g.ensureHexBuffer)(e):(0,g.ensureHexBuffer)("0x".concat(new u.default(e).toString(16)))).length>8)throw new Error("ChainID provided is too large.");return r.length<=2||4===r.length||8===r.length?r:(3===r.length?(n=t.alloc(4)).writeUInt32BE(e):r.length<=8&&(n=t.alloc(8),r.copy(n,8-r.length)),n)}function S(e){if("string"!=typeof e)return!1;if("0x"!==e.slice(0,2))return!1;try{return!1===new u.default(e,16).isNaN()}catch(e){return!1}}function T(e,r){var n=r.fwConstants,i=n.ethMaxMsgSz,a=n.extraDataFrameSz,s=n.extraDataMaxFrames,o=i,c=a>0&&s>0,u=[];if(e.length>o){var l=o+s*a;if(!c)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(o));if(c&&e.length>l)throw new Error("Your message is ".concat(e.length," bytes, but can only be a maximum of ").concat(l));(0,g.splitFrames)(e.slice(o),a).forEach((function(e){var r=t.alloc(4);r.writeUInt32LE(e.length,0),u.push(t.concat([r,e]))}))}return u}function _(e,t,r,n){return void 0===n&&(n=!1),r[t].forEach((function(t){var i=t.type.indexOf("[")>-1,a=i?t.type.slice(0,t.type.indexOf("[")):t.type,s=Object.keys(r).indexOf(a)>-1;if(s&&Array.isArray(e))for(var o=0;o<e.length;o++)e[o][t.name]=_(e[o][t.name],a,r,n);else if(s)e[t.name]=_(e[t.name],a,r,n);else if(Array.isArray(e))for(o=0;o<e.length;o++)if(i)for(var c=0;c<e[o][t.name].length;c++)e[o][t.name][c]=x(e[o][t.name][c],a,n);else e[o][t.name]=x(e[o][t.name],a,n);else if(i)for(o=0;o<e[t.name].length;o++)e[t.name][o]=x(e[t.name][o],a,n);else e[t.name]=x(e[t.name],a,n)})),e}function x(e,r,n){if(void 0===n&&(n=!1),"bytes"===r)e=(0,g.ensureHexBuffer)(e),n&&(e="0x".concat(e.toString("hex")));else if("bytes"===r.slice(0,5)){var i=parseInt(r.slice(5));if((e=(0,g.ensureHexBuffer)(e)).length!==i)throw new Error("Expected ".concat(r," type, but got ").concat(e.length," bytes"));n&&(e="0x".concat(e.toString("hex")))}else if("address"===r){if(0===(e=(0,g.ensureHexBuffer)(e)).length&&(e=t.alloc(20)),20!==e.length)throw new Error("Address type must be 20 bytes, but got ".concat(e.length," bytes"));n&&(e="0x".concat(e.toString("hex")))}else if(m.ethMsgProtocol.TYPED_DATA.typeCodes[r]&&(r.indexOf("uint")>-1||r.indexOf("int")>-1)){var a=(0,g.ensureHexBuffer)(e);0===a.length&&(a=t.from("00","hex")),e=n?"0x".concat(a.toString("hex")):(new l.default.Encoder).semanticTypes[1][0](a.toString("hex"),16)}else"bool"===r&&(e=!0===e?1:0);return e}function A(e){return t.from("Ethereum Signed Message:\n".concat(e.toString()),"utf-8")}function P(e,r){return r?t.concat([t.from([r]),t.from((0,f.encode)(e))]):t.from((0,f.encode)(e))}r.default={buildEthereumMsgRequest:function(e){if(!e.payload||!e.protocol||!e.signerPath)throw new Error("You must provide `payload`, `signerPath`, and `protocol` arguments in the messsage request");if(e.signerPath.length>5||e.signerPath.length<2)throw new Error("Please provide a signer path with 2-5 indices");var r={schema:m.signingSchema.ETH_MSG,payload:null,input:e,msg:null};switch(e.protocol){case"signPersonal":return function(e,r){var n=r.fwConstants.ethMaxMsgSz,i=r.fwConstants.varAddrPathSzAllowed,a=24+n+4,s=0;e.payload=t.alloc(a),e.payload.writeUInt8(m.ethMsgProtocol.SIGN_PERSONAL,0),s+=1;var o=(0,g.buildSignerPathBuf)(r.signerPath,i);o.copy(e.payload,s),s+=o.length;var c=r.payload,u=!1;if("string"==typeof r.payload)if("0x"===r.payload.slice(0,2))c=(0,g.ensureHexBuffer)(r.payload),u=!1===m.ASCII_REGEX.test(t.from(r.payload.slice(2),"hex").toString());else{if(!1===(0,g.isAsciiStr)(r.payload))throw new Error("Currently, the Lattice can only display ASCII strings.");c=t.from(r.payload)}else if("boolean"==typeof r.displayHex)u=r.displayHex;else{if(!r.payload.toString)throw new Error("Unsupported input data type");u=!1===m.ASCII_REGEX.test(r.payload.toString())}var l=r.fwConstants,d=n+l.extraDataMaxFrames*l.extraDataFrameSz;l.personalSignHeaderSz&&(d-=l.personalSignHeaderSz);if(l.ethMsgPreHashAllowed&&c.length>d){e.payload.writeUInt8(u,s),s+=1,e.payload.writeUInt16LE(c.length,s),s+=2;var f=t.from((0,h.keccak256)(t.concat([A(c.length),c])),"hex");f.copy(e.payload,s),e.prehash=f}else{var p=T(c,r);e.extraDataPayloads=p,e.msg=c,e.payload.writeUInt8(u,s),s+=1,e.payload.writeUInt16LE(c.length,s),s+=2,c.copy(e.payload,s)}return e}(r,e);case"eip712":if(!e.fwConstants.eip712Supported)throw new Error("EIP712 is not supported by your Lattice firmware version. Please upgrade.");return function(e,r){var n=r.fwConstants,i=n.ethMaxMsgSz,a=n.varAddrPathSzAllowed,s=n.eip712MaxTypeParams,o=m.ethMsgProtocol.TYPED_DATA,c=24+i+4,u=0;e.payload=t.alloc(c),e.payload.writeUInt8(o.enumIdx,0),u+=1;var h=(0,g.buildSignerPathBuf)(r.signerPath,a);h.copy(e.payload,u),u+=h.length;var f=JSON.parse(JSON.stringify(r.payload));if(!f.primaryType||!f.types[f.primaryType])throw new Error("primaryType must be specified and the type must be included.");if(!f.message||!f.domain)throw new Error("message and domain must be specified.");if(0>Object.keys(f.types).indexOf("EIP712Domain"))throw new Error("EIP712Domain type must be defined.");r.payload.message=_(JSON.parse(JSON.stringify(f.message)),JSON.parse(JSON.stringify(f.primaryType)),JSON.parse(JSON.stringify(f.types)),!0),r.payload.domain=_(JSON.parse(JSON.stringify(f.domain)),"EIP712Domain",JSON.parse(JSON.stringify(f.types)),!0),f.domain=_(f.domain,"EIP712Domain",f.types,!1),f.message=_(f.message,f.primaryType,f.types,!1);var p=t.from(l.default.encode(f)),v=r.fwConstants,b=i+v.extraDataMaxFrames*v.extraDataFrameSz,y=p.length>b;if(Object.keys(f.types).forEach((function(e){f.types[e].length>s&&(y=!0)})),v.ethMsgPreHashAllowed&&y){e.payload.writeUInt16LE(p.length,u),u+=2;var w=d.TypedDataUtils.hash(e.input.payload);t.from(w).copy(e.payload,u),e.prehash=w}else{var E=T(p,r);e.extraDataPayloads=E,e.payload.writeUInt16LE(p.length,u),u+=2,p.copy(e.payload,u),u+=p.length,e.payload=e.payload.slice(0,u)}return e}(r,e);default:throw new Error("Unsupported protocol")}},validateEthereumMsgResponse:function(e,r){var n=e.signer,i=e.sig,a=r.input,s=r.msg,o=r.prehash,c=void 0===o?null:o;if("signPersonal"===a.protocol)return b(c||t.from((0,h.keccak256)(t.concat([A(s.length),s])),"hex"),i,n,{chainId:1,useEIP155:!1});if("eip712"===a.protocol){var u=d.TypedDataUtils.hash(r.input.payload);return b(c||u,i,n,{useEIP155:!1})}throw new Error("Unsupported protocol")},buildEthereumTxRequest:function(e){try{var r=e.chainId,n=void 0===r?1:r,i=e.signerPath,a=e.eip155,s=void 0===a?null:a,o=e.fwConstants,c=e.type,u=void 0===c?null:c,l=o.contractDeployKey,d=o.extraDataFrameSz,f=o.extraDataMaxFrames,p=o.prehashAllowed,v=d>0&&f>0,b=o.ethMaxDataSz,y=o.varAddrPathSzAllowed;if("number"!=typeof n&&!1===S(n)&&(n=E[n]),!n)throw new Error("Unsupported chain ID or name");if(!i)throw new Error("`signerPath` not provided");if(null===e.to&&!l)throw new Error("Contract deployment not supported. Please update your Lattice firmware.");var w=null===e.to&&l,T=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(2)>-1,_=o.allowedEthTxTypes&&o.allowedEthTxTypes.indexOf(1)>-1,x=T&&(2===u||"eip1559"===u),A=_&&(1===u||"eip2930"===u);if(null!==u&&!x&&!A)throw new Error("Unsupported Ethereum transaction type");var I=function(e){switch(e){case 3:case 4:return!1;default:return!0}}(n);null!==s&&"boolean"==typeof s?I=s:(x||A)&&(I=!1),e.value||(e.value=0);var R=[],M=(0,g.ensureHexBuffer)(n),C=(0,g.ensureHexBuffer)(e.nonce),N=void 0,O=(0,g.ensureHexBuffer)(e.gasLimit),L=void 0,D=void 0;w?(L=t.alloc(0),D=(0,g.ensureHexBuffer)(l)):(L=(0,g.ensureHexBuffer)(e.to),D=(0,g.ensureHexBuffer)(e.to));var B=(0,g.ensureHexBuffer)(e.value),U=(0,g.ensureHexBuffer)(e.data);(x||A)&&R.push(M),R.push(C);var F=void 0,G=void 0;if(x){if(!e.maxPriorityFeePerGas)throw new Error("EIP1559 transactions must include `maxPriorityFeePerGas`");F=(0,g.ensureHexBuffer)(e.maxPriorityFeePerGas),R.push(F),G=(0,g.ensureHexBuffer)(e.maxFeePerGas),R.push(G),N=G}else N=(0,g.ensureHexBuffer)(e.gasPrice),R.push(N);R.push(O),R.push(L),R.push(B),R.push(U);var j=!1;if(x||A){var H=[];Array.isArray(e.accessList)&&e.accessList.forEach((function(e){var t=[];e.storageKeys.forEach((function(e){t.push((0,g.ensureHexBuffer)(e))})),H.push([(0,g.ensureHexBuffer)(e.address),t]),j=!0})),R.push(H)}else!0===I&&(R.push(M),R.push((0,g.ensureHexBuffer)(null)),R.push((0,g.ensureHexBuffer)(null)));var K=t.alloc(b+122),q=0;K.writeUInt8(Number(I),q),q++;var V=void 0,W=0;if(!0==(1!==(re=k(n)).length||255===re.readUInt8(0))){if((W=(V=k(n)).length)>m.MAX_CHAIN_ID_BYTES)throw new Error("ChainID provided is too large.");K.writeUInt8(m.HANDLE_LARGER_CHAIN_ID,q),q++}else{if(1!==(V=(0,g.ensureHexBuffer)(n)).length)throw new Error("Error parsing chainID");V.copy(K,q),q+=V.length}var z=(0,g.buildSignerPathBuf)(i,y);if(z.copy(K,q),q+=z.length,C.length>4)throw new Error("Nonce too large");if(C.copy(K,q+(4-C.length)),q+=4,N.length>8)throw new Error("Gas price too large");if(N.copy(K,q+(8-N.length)),q+=8,O.length>4)throw new Error("Gas limit too large");if(O.copy(K,q+(4-O.length)),q+=4,20!==D.length)throw new Error("Invalid `to` address");if(D.copy(K,q),q+=20,B.length>32)throw new Error("Value too large");B.copy(K,q+(32-B.length)),q+=32;var Y=!1;if(o.allowedEthTxTypes)if(j&&(Y=!0),K.writeUInt8(Y?1:0,q),q+=1,x){if(K.writeUInt8(2,q),q+=1,F.length>8)throw new Error("maxPriorityFeePerGasBytes too large");F.copy(K,q+(8-F.length)),q+=8}else A?(K.writeUInt8(1,q),q+=1,q+=8):q+=9;var $=[],J=null,Q=U.length||0,Z=W>0?W+1:0,X=t.alloc(Q+Z);if(Z>0&&(X.writeUInt8(W,0),V.copy(X,1)),U.copy(X,Z),Q>b){var ee=Q+Z,te=b+f*d;if(p&&ee>te)J=t.from((0,h.keccak256)(P(R,u)),"hex");else{if(!v||v&&ee>te)throw new Error("Data field too large (got ".concat(U.length,"; must be <=").concat(te-Z," bytes)"));(0,g.splitFrames)(X.slice(b),d).forEach((function(e){var r=t.alloc(4);r.writeUInt32LE(e.length,0),$.push(t.concat([r,e]))}))}}else Y&&(J=t.from((0,h.keccak256)(P(R,u)),"hex"));return K.writeUInt16BE(U.length,q),q+=2,W>0&&(K.writeUInt8(W,q),q++,V.copy(K,q),q+=W),J?(J.copy(K,q),q+=b):(U.slice(0,b).copy(K,q),q+=b),{rawTx:R,type:u,payload:K.slice(0,q),extraDataPayloads:$,schema:m.signingSchema.ETH_TRANSFER,chainId:n,useEIP155:I,signerPath:i}}catch(e){return{err:e.message}}var re},buildEthRawTx:function(e,r,n){var i=b(t.from((0,h.keccak256)(P(e.rawTx,e.type)),"hex"),r,n,e),a=e.useEIP155?e.rawTx.slice(0,-3):e.rawTx;a.push(i.v),a.push(v(i.r)),a.push(v(i.s));var s=t.from((0,f.encode)(a));return e.type&&(s=t.concat([t.from([e.type]),s])),{rawTx:s.toString("hex"),sigWithV:i}},hashTransaction:function(e){return(0,h.keccak256)(t.from(e,"hex"))},chainIds:E,ensureHexBuffer:g.ensureHexBuffer,ethConvertLegacyToGenericReq:function(e){var r;r=e.chainId&&"01"!==(0,g.ensureHexBuffer)(e.chainId).toString("hex")?o.default.custom({chainId:Number(e.chainId)},{hardfork:o.Hardfork.London,eips:[1559,2930]}):new o.default({chain:o.Chain.Mainnet,hardfork:o.Hardfork.London});var n=c.TransactionFactory.fromTxData(e,{common:r});return e.type?n.getMessageToSign(!1):t.from((0,f.encode)(n.getMessageToSign(!1)))}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4689,{"../constants":4687,"../shared/functions":4701,"../shared/validators":4704,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.decryptAddKvRecordsResponse=r.requestAddKvRecords=r.encryptAddKvRecordsRequest=r.encodeAddKvRecordsRequest=r.validateAddKvRequest=r.addKvRecords=void 0;var a=e("../constants"),s=e("../shared/functions"),o=e("../shared/validators");r.addKvRecords=function(e){var t=e.type,a=void 0===t?0:t,s=e.records,o=e.caseSensitive,c=void 0!==o&&o,u=e.client;return n(this,void 0,void 0,(function(){var e,t,n,o,l,d,h,f,p,m,g;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateAddKvRequest)({url:u.url,fwConstants:u.getFwConstants(),sharedSecret:u.sharedSecret,records:s}),t=e.url,n=e.sharedSecret,o=e.fwConstants,l=e.validRecords,d=(0,r.encodeAddKvRecordsRequest)({records:l,fwConstants:o,type:a,caseSensitive:c}),h=(0,r.encryptAddKvRecordsRequest)({payload:d,sharedSecret:n}),[4,(0,r.requestAddKvRecords)(h,t)];case 1:return f=i.sent(),p=(0,r.decryptAddKvRecordsResponse)(f,n),m=p.decryptedData,g=p.newEphemeralPub,u.ephemeralPub=g,[2,m]}}))}))};r.validateAddKvRequest=function(e){var t=e.url,r=e.fwConstants,n=e.sharedSecret,i=e.records,a=(0,o.validateUrl)(t),s=(0,o.validateFwConstants)(r);return{url:a,fwConstants:s,sharedSecret:(0,o.validateSharedSecret)(n),validRecords:(0,o.validateKvRecords)(i,s)}};r.encodeAddKvRecordsRequest=function(e){var r=e.records,n=e.fwConstants,i=e.type,a=e.caseSensitive,s=t.alloc(1+139*n.kvActionMaxNum);s.writeUInt8(Object.keys(r).length,0);var c=1;return Object.entries(r).forEach((function(e){var r=e[0],u=e[1],l=(0,o.validateKvRecord)({key:r,val:u},n),d=l.key,h=l.val;s.writeUInt32LE(0,c),c+=4,s.writeUInt32LE(i,c),c+=4,s.writeUInt8(a?1:0,c),c+=1,s.writeUInt8(String(d).length+1,c),c+=1,t.from(String(d)).copy(s,c),c+=n.kvKeyMaxStrSz+1,s.writeUInt8(String(h).length+1,c),c+=1,t.from(String(h)).copy(s,c),c+=n.kvValMaxStrSz+1})),s};r.encryptAddKvRecordsRequest=function(e){var t=e.payload,r=e.sharedSecret;return(0,s.encryptRequest)({requestCode:"ADD_KV_RECORDS",payload:t,sharedSecret:r})};r.requestAddKvRecords=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,s.request)({payload:e,url:t})]}))}))};r.decryptAddKvRecordsResponse=function(e,t){var r=(0,s.decryptResponse)(e,a.decResLengths.empty,t);return{decryptedData:r.decryptedData,newEphemeralPub:r.newEphemeralPub}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4690,{"../constants":4687,"../shared/functions":4701,"../shared/predicates":4702,"../shared/utilities":4703,"../shared/validators":4704,"../util":4705},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.decodeConnectResponse=r.requestConnect=r.encodeConnectRequest=r.validateConnectRequest=r.connect=void 0;var a=e("../constants"),s=e("../shared/functions"),o=e("../shared/predicates"),c=e("../shared/utilities"),u=e("../shared/validators"),l=e("../util");r.connect=function(e){var t=e.id,a=e.client;return n(this,void 0,void 0,(function(){var e,n,s,c,u,l,d,h,f,p,m,g;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateConnectRequest)({deviceId:t,key:a.key,baseUrl:a.baseUrl}),n=e.deviceId,s=e.key,c=e.baseUrl,u="".concat(c,"/").concat(n),[4,(0,r.encodeConnectRequest)(s)];case 1:return l=i.sent(),[4,(0,r.requestConnect)(l,u)];case 2:return d=i.sent(),[4,(0,r.decodeConnectResponse)(d,s)];case 3:return h=i.sent(),f=h.isPaired,p=h.fwVersion,m=h.activeWallets,g=h.ephemeralPub,a.deviceId=n,a.ephemeralPub=g,a.url="".concat(a.baseUrl,"/").concat(n),a.isPaired=f,a.fwVersion=p,m&&(a.activeWallets=m),!f||(0,o.doesFetchWalletsOnLoad)(a.getFwVersion())?[3,5]:[4,a.fetchActiveWallet()];case 4:i.sent(),i.label=5;case 5:return[2,f]}}))}))};r.validateConnectRequest=function(e){var t=e.deviceId,r=e.key,n=e.baseUrl;return{deviceId:(0,u.validateDeviceId)(t),key:(0,u.validateKey)(r),baseUrl:(0,u.validateBaseUrl)(n)}};r.encodeConnectRequest=function(e){var t=a.deviceCodes.CONNECT,r=(0,c.getPubKeyBytes)(e);return(0,s.buildRequest)(t,r)};r.requestConnect=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,s.request)({payload:e,url:t})]}))}))};r.decodeConnectResponse=function(e,t){var r=0,n=e.readUInt8(r)===a.messageConstants.PAIRED;r++;var i=e.slice(r,r+65).toString("hex");r+=65;var s=(0,l.getP256KeyPairFromPub)(i),o=e.slice(r,r+4);if(r+=4,n){var u=e.slice(r,r+160);r+=160;var d=(0,c.getSharedSecret)(t,s),h=(0,l.aes256_decrypt)(u,d);if(0!==h[h.length-2]||0!==h[h.length-1])throw new Error("Failed to connect to Lattice.");return{isPaired:n,fwVersion:o,activeWallets:(0,c.parseWallets)(h),ephemeralPub:s}}return{isPaired:n,fwVersion:o,activeWallets:undefined,ephemeralPub:s}}}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4691,{"../constants":4687,"../shared/functions":4701,"../shared/validators":4704,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.decryptFetchActiveWalletResponse=r.decodeFetchActiveWalletResponse=r.requestFetchActiveWallet=r.encryptFetchActiveWalletRequest=r.validateFetchActiveWallet=r.fetchActiveWallet=void 0;var a=e("../constants"),s=e("../shared/functions"),o=e("../shared/validators");r.fetchActiveWallet=function(e){var t=e.client;return n(this,void 0,void 0,(function(){var e,n,a,s,c,u,l,d,h,f;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateFetchActiveWallet)({url:t.url,sharedSecret:t.sharedSecret}),n=e.url,a=e.sharedSecret,s=(0,r.encryptFetchActiveWalletRequest)({sharedSecret:a}),[4,(0,r.requestFetchActiveWallet)(s,n).catch((function(e){throw t.resetActiveWallets(),e}))];case 1:return c=i.sent(),u=(0,r.decryptFetchActiveWalletResponse)(c,a),l=u.decryptedData,d=u.newEphemeralPub,h=(0,r.decodeFetchActiveWalletResponse)(l),f=(0,o.validateActiveWallets)(h),t.activeWallets=f,t.ephemeralPub=d,[2,f]}}))}))};r.validateFetchActiveWallet=function(e){var t=e.url,r=e.sharedSecret;return{url:(0,o.validateUrl)(t),sharedSecret:(0,o.validateSharedSecret)(r)}};r.encryptFetchActiveWalletRequest=function(e){var r=e.sharedSecret;return(0,s.encryptRequest)({requestCode:"GET_WALLETS",payload:t.alloc(0),sharedSecret:r})};r.requestFetchActiveWallet=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,s.request)({payload:e,url:t})]}))}))};r.decodeFetchActiveWalletResponse=function(e){var r=e.slice(65),n={internal:{uid:a.EMPTY_WALLET_UID,external:!1,name:t.alloc(0),capabilities:0},external:{uid:a.EMPTY_WALLET_UID,external:!0,name:t.alloc(0),capabilities:0}},i=0;return n.internal.uid=r.slice(i,i+32),n.internal.capabilities=r.readUInt32BE(i+32),n.internal.name=r.slice(i+36,i+71),i+=71,n.external.uid=r.slice(i,i+32),n.external.capabilities=r.readUInt32BE(i+32),n.external.name=r.slice(i+36,i+71),n};r.decryptFetchActiveWalletResponse=function(e,t){var r=(0,s.decryptResponse)(e,a.decResLengths.getWallets,t);return{decryptedData:r.decryptedData,newEphemeralPub:r.newEphemeralPub}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4692,{"../constants":4687,"../shared/functions":4701,"../shared/validators":4704,"../util":4705,bitwise:1890,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.decryptGetAddressesResponse=r.decodeGetAddresses=r.requestGetAddresses=r.encryptGetAddressesRequest=r.encodeGetAddressesRequest=r.validateGetAddressesRequest=r.getAddresses=void 0;var s=a(e("bitwise")),o=e("../constants"),c=e("../shared/functions"),u=e("../shared/validators"),l=e("../util");r.getAddresses=function(e){var t=e.startPath,a=e.n,s=e.flag,o=e.client;return n(this,void 0,void 0,(function(){var e,n,c,u,l,d,h,f,p,m,g;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateGetAddressesRequest)({startPath:t,n:a,flag:s,url:o.url,fwVersion:o.fwVersion,wallet:o.getActiveWallet(),sharedSecret:o.sharedSecret}),n=e.url,c=e.fwVersion,u=e.wallet,l=e.sharedSecret,d=(0,r.encodeGetAddressesRequest)({startPath:t,n:a,flag:s,fwVersion:c,wallet:u}),h=(0,r.encryptGetAddressesRequest)({payload:d,sharedSecret:l}),[4,(0,r.requestGetAddresses)(h,n)];case 1:return f=i.sent(),p=(0,r.decryptGetAddressesResponse)(f,l),m=p.decryptedData,g=p.newEphemeralPub,o.ephemeralPub=g,[2,(0,r.decodeGetAddresses)(m,s)]}}))}))};r.validateGetAddressesRequest=function(e){var t=e.startPath,r=e.n,n=e.flag,i=e.url,a=e.fwVersion,s=e.wallet,o=e.sharedSecret;return(0,u.validateStartPath)(t),(0,u.validateNAddresses)(r),(0,u.validateIsUInt4)(n),{url:(0,u.validateUrl)(i),fwVersion:(0,u.validateFwVersion)(a),wallet:(0,u.validateWallet)(s),sharedSecret:(0,u.validateSharedSecret)(o)}};r.encodeGetAddressesRequest=function(e){var r,n=e.fwVersion,i=e.startPath,a=e.n,c=e.wallet,u=e.flag,d=(0,o.getFwVersionConst)(n);if(!((d.getAddressFlags||[]).indexOf(u)>-1&&(u===o.EXTERNAL.GET_ADDR_FLAGS.ED25519_PUB||u===o.EXTERNAL.GET_ADDR_FLAGS.SECP256K1_PUB))&&!(0,l.isValidAssetPath)(i,d))throw new Error("Parent derivation path is not supported");var h=53;if(d.varAddrPathSzAllowed)h+=1;else if(5!==i.length)throw new Error("Your Lattice firmware only supports derivation paths with 5 indices. Please upgrade.");var f=t.alloc(h),p=0;c.uid.copy(f,p),p+=32,d.varAddrPathSzAllowed&&(f.writeUInt8(i.length,p),p+=1);for(var m=0;m<5;m++){if(m<=i.length){var g=null!==(r=i[m])&&void 0!==r?r:0;f.writeUInt32BE(g,p)}p+=4}var v,b=0;if(d.addrFlagsAllowed){b=d.getAddressFlags&&d.getAddressFlags.indexOf(u)>-1?u:0;var y=s.default.nibble.read(b),w=s.default.nibble.read(a);v=s.default.byte.write(y.concat(w))}else v=a;return f.writeUInt8(v,p),p++,f};r.encryptGetAddressesRequest=function(e){var t=e.payload,r=e.sharedSecret;return(0,c.encryptRequest)({requestCode:"GET_ADDRESSES",payload:t,sharedSecret:r})};r.requestGetAddresses=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,c.request)({payload:e,url:t})]}))}))};r.decodeGetAddresses=function(e,t){var r=65,n=[],i=o.EXTERNAL.GET_ADDR_FLAGS,a=i.ED25519_PUB,s=i.SECP256K1_PUB,c=t===a||t===s;for(c&&(r+=1);r+4<o.decResLengths.getAddresses;)if(c){var u=e.slice(r,r+65),l=u.every((function(e){return 0===e}));l||t!==a?l||n.push(u):n.push(u.slice(0,32)),r+=65}else{var d=e.slice(r,r+o.ADDR_STR_LEN);r+=o.ADDR_STR_LEN;var h=d.indexOf(0);h>0&&n.push(d.slice(0,h).toString())}return n};r.decryptGetAddressesResponse=function(e,t){var r=(0,c.decryptResponse)(e,o.decResLengths.getAddresses,t);return{decryptedData:r.decryptedData,newEphemeralPub:r.newEphemeralPub}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4693,{"../constants":4687,"../shared/functions":4701,"../shared/validators":4704,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.decodeGetKvRecordsResponse=r.decryptGetKvRecordsResponse=r.requestGetKvRecords=r.encryptGetKvRecordsRequest=r.encodeGetKvRecordsRequest=r.validateGetKvRequest=r.getKvRecords=void 0;var a=e("../constants"),s=e("../shared/functions"),o=e("../shared/validators");r.getKvRecords=function(e){var t=e.type,a=e.n,s=e.start,o=e.client;return n(this,void 0,void 0,(function(){var e,n,c,u,l,d,h,f,p,m,g,v,b;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateGetKvRequest)({url:o.url,fwConstants:o.getFwConstants(),sharedSecret:o.sharedSecret,type:t,n:a,start:s}),n=e.url,c=e.sharedSecret,u=e.fwConstants,l=e.type,d=e.n,h=e.start,f=(0,r.encodeGetKvRecordsRequest)({type:l,n:d,start:h}),p=(0,r.encryptGetKvRecordsRequest)({payload:f,sharedSecret:c}),[4,(0,r.requestGetKvRecords)(p,n)];case 1:return m=i.sent(),g=(0,r.decryptGetKvRecordsResponse)(m,c),v=g.decryptedData,b=g.newEphemeralPub,o.ephemeralPub=b,[2,(0,r.decodeGetKvRecordsResponse)(v,u)]}}))}))};r.validateGetKvRequest=function(e){var t=e.url,r=e.fwConstants,n=e.sharedSecret,i=e.n,a=e.type,s=e.start,c=(0,o.validateUrl)(t),u=(0,o.validateFwConstants)(r),l=(0,o.validateSharedSecret)(n);if(!u.kvActionsAllowed)throw new Error("Unsupported. Please update firmware.");if(!i||i<1)throw new Error("You must request at least one record.");if(i>u.kvActionMaxNum)throw new Error("You may only request up to ".concat(u.kvActionMaxNum," records at once."));if(0!==a&&!a)throw new Error("You must specify a type.");if(0!==s&&!s)throw new Error("You must specify a type.");return{url:c,fwConstants:u,sharedSecret:l,type:a,n:i,start:s}};r.encodeGetKvRecordsRequest=function(e){var r=e.type,n=e.n,i=e.start,a=t.alloc(9);return a.writeUInt32LE(r,0),a.writeUInt8(n,4),a.writeUInt32LE(i,5),a};r.encryptGetKvRecordsRequest=function(e){var t=e.payload,r=e.sharedSecret;return(0,s.encryptRequest)({requestCode:"GET_KV_RECORDS",payload:t,sharedSecret:r})};r.requestGetKvRecords=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,s.request)({payload:e,url:t})]}))}))};r.decryptGetKvRecordsResponse=function(e,t){var r=(0,s.decryptResponse)(e,a.decResLengths.getKvRecords,t);return{decryptedData:r.decryptedData,newEphemeralPub:r.newEphemeralPub}};r.decodeGetKvRecordsResponse=function(e,t){var r=65,n=parseInt(e.slice(r,r+4).toString("hex"),16);r+=4;var i=parseInt(e.slice(r,r+1).toString("hex"),16);if(r+=1,i>t.kvActionMaxNum)throw new Error("Too many records fetched. Firmware error.");for(var a=[],s=0;s<i;s++){var o={};o.id=parseInt(e.slice(r,r+4).toString("hex"),16),r+=4,o.type=parseInt(e.slice(r,r+4).toString("hex"),16),r+=4,o.caseSensitive=1===parseInt(e.slice(r,r+1).toString("hex"),16),r+=1;var c=parseInt(e.slice(r,r+1).toString("hex"),16);r+=1,o.key=e.slice(r,r+c-1).toString(),r+=t.kvKeyMaxStrSz+1;var u=parseInt(e.slice(r,r+1).toString("hex"),16);r+=1,o.val=e.slice(r,r+u-1).toString(),r+=t.kvValMaxStrSz+1,a.push(o)}return{records:a,total:n,fetched:i}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4694,{"./addKvRecords":4689,"./connect":4690,"./fetchActiveWallet":4691,"./getAddresses":4692,"./getKvRecords":4693,"./pair":4695,"./removeKvRecords":4696,"./sign":4697},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./addKvRecords"),r),i(e("./connect"),r),i(e("./fetchActiveWallet"),r),i(e("./getAddresses"),r),i(e("./getKvRecords"),r),i(e("./pair"),r),i(e("./removeKvRecords"),r),i(e("./sign"),r)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4695,{"../constants":4687,"../shared/functions":4701,"../shared/utilities":4703,"../shared/validators":4704,"../util":4705,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.decryptPairResponse=r.requestPair=r.encryptPairRequest=r.encodePairRequest=r.pair=void 0;var a=e("../constants"),s=e("../shared/functions"),o=e("../shared/utilities"),c=e("../shared/validators"),u=e("../util");r.pair=function(e){var t=e.pairingSecret,a=e.client;return n(this,void 0,void 0,(function(){var e,n,s,o,u,l;return i(this,(function(i){switch(i.label){case 0:return e=(0,c.validateAppName)(a.name),n=(0,c.validateUrl)(a.url),s=(0,r.encodePairRequest)(a.key,t,e),o=(0,r.encryptPairRequest)({payload:s,sharedSecret:a.sharedSecret}),[4,(0,r.requestPair)(o,n)];case 1:return u=i.sent(),l=(0,r.decryptPairResponse)(u,a.sharedSecret).newEphemeralPub,a.isPaired=!0,a.ephemeralPub=l,[4,a.fetchActiveWallet()];case 2:return i.sent(),[2,a.hasActiveWallet()]}}))}))};r.encodePairRequest=function(e,r,n){var i=(0,o.getPubKeyBytes)(e),a=t.alloc(25);r.length>0&&a.write(n);var s=(0,u.generateAppSecret)(i,a,t.from(r)),c=e.sign(s),l=(0,u.toPaddedDER)(c);return t.concat([a,l])};r.encryptPairRequest=function(e){var t=e.payload,r=e.sharedSecret;return(0,s.encryptRequest)({requestCode:"FINALIZE_PAIRING",payload:t,sharedSecret:r})};r.requestPair=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,s.request)({payload:e,url:t})]}))}))};r.decryptPairResponse=function(e,t){return(0,s.decryptResponse)(e,a.decResLengths.empty,t)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4696,{"../constants":4687,"../shared/functions":4701,"../shared/validators":4704,buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(r,"__esModule",{value:!0}),r.decryptRemoveKvRecordsResponse=r.requestRemoveKvRecords=r.encryptRemoveKvRecordsRequest=r.encodeRemoveKvRecordsRequest=r.validateRemoveKvRequest=r.removeKvRecords=void 0;var a=e("../constants"),s=e("../shared/functions"),o=e("../shared/validators");r.removeKvRecords=function(e){var t=e.type,a=e.ids,s=e.client;return n(this,void 0,void 0,(function(){var e,n,o,c,u,l,d,h,f,p,m,g;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateRemoveKvRequest)({url:s.url,fwConstants:s.getFwConstants(),sharedSecret:s.sharedSecret,type:t,ids:a}),n=e.url,o=e.sharedSecret,c=e.fwConstants,u=e.type,l=e.ids,d=(0,r.encodeRemoveKvRecordsRequest)({type:u,ids:l,fwConstants:c}),h=(0,r.encryptRemoveKvRecordsRequest)({payload:d,sharedSecret:o}),[4,(0,r.requestRemoveKvRecords)(h,n)];case 1:return f=i.sent(),p=(0,r.decryptRemoveKvRecordsResponse)(f,o),m=p.decryptedData,g=p.newEphemeralPub,s.ephemeralPub=g,[2,m]}}))}))};r.validateRemoveKvRequest=function(e){var t=e.url,r=e.fwConstants,n=e.sharedSecret,i=e.ids,a=e.type,s=(0,o.validateUrl)(t),c=(0,o.validateFwConstants)(r),u=(0,o.validateSharedSecret)(n);if(!c.kvActionsAllowed)throw new Error("Unsupported. Please update firmware.");if(!Array.isArray(i)||i.length<1)throw new Error("You must include one or more `ids` to removed.");if(i.length>c.kvRemoveMaxNum)throw new Error("Only up to ".concat(c.kvRemoveMaxNum," records may be removed at once."));if(0!==a&&!a)throw new Error("You must specify a type.");return{url:s,fwConstants:c,sharedSecret:u,type:a,ids:i}};r.encodeRemoveKvRecordsRequest=function(e){var r=e.type,n=e.ids,i=e.fwConstants,a=t.alloc(5+4*i.kvRemoveMaxNum);a.writeUInt32LE(r,0),a.writeUInt8(n.length,4);for(var s=0;s<n.length;s++){var o=parseInt(n[s]);a.writeUInt32LE(o,5+4*s)}return a};r.encryptRemoveKvRecordsRequest=function(e){var t=e.payload,r=e.sharedSecret;return(0,s.encryptRequest)({requestCode:"REMOVE_KV_RECORDS",payload:t,sharedSecret:r})};r.requestRemoveKvRecords=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,s.request)({payload:e,url:t})]}))}))};r.decryptRemoveKvRecordsResponse=function(e,t){var r=(0,s.decryptResponse)(e,a.decResLengths.empty,t);return{decryptedData:r.decryptedData,newEphemeralPub:r.newEphemeralPub}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4697,{"../bitcoin":4683,"../constants":4687,"../ethereum":4688,"../genericSigning":4698,"../shared/functions":4701,"../shared/validators":4704,"../util":4705,buffer:1966,"hash.js":4842},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.decryptSignResponse=r.decodeSignResponse=r.requestSign=r.encryptSignRequest=r.encodeSignRequest=r.validateSignRequest=r.sign=void 0;var s=e("hash.js"),o=a(e("../bitcoin")),c=e("../constants"),u=a(e("../ethereum")),l=e("../genericSigning"),d=e("../shared/functions"),h=e("../shared/validators"),f=e("../util");r.sign=function(e){var t=e.data,a=e.currency,s=e.cachedData,o=e.nextCode,c=e.client;return n(this,void 0,void 0,(function(){var e,n,u,l,h,f,p,m,g,v,b,y,w,E,k,S,T,_,x;return i(this,(function(i){switch(i.label){case 0:return e=(0,r.validateSignRequest)({url:c.url,fwConstants:c.getFwConstants(),wallet:c.getActiveWallet(),sharedSecret:c.sharedSecret}),n=e.url,u=e.wallet,l=e.sharedSecret,h=e.fwConstants,f=(0,d.buildTransaction)({data:t,currency:a,fwConstants:h}),p=f.request,m=f.isGeneric,g=(0,r.encodeSignRequest)({request:p,fwConstants:h,wallet:u,cachedData:s,nextCode:o}),v=g.payload,b=g.hasExtraPayloads,y=(0,r.encryptSignRequest)({payload:v,sharedSecret:l}),[4,(0,r.requestSign)(y,n)];case 1:return w=i.sent(),b?(E=(0,r.decryptSignResponse)(w,l),k=E.decryptedData,S=E.newEphemeralPub,c.ephemeralPub=S,[2,c.sign({data:t,currency:a,cachedData:p,nextCode:k.slice(65,73)})]):(T=(0,r.decryptSignResponse)(w,l),_=T.decryptedData,x=T.newEphemeralPub,c.ephemeralPub=x,[2,(0,r.decodeSignResponse)({data:_,request:p,isGeneric:m,currency:a})])}}))}))};r.validateSignRequest=function(e){var t=e.url,r=e.fwConstants,n=e.sharedSecret,i=e.wallet;return{url:(0,h.validateUrl)(t),fwConstants:(0,h.validateFwConstants)(r),sharedSecret:(0,h.validateSharedSecret)(n),wallet:(0,h.validateWallet)(i)}};r.encodeSignRequest=function(e){var r,n,i,a,s,o=e.request,u=e.fwConstants,l=e.wallet,d=e.cachedData,f=e.nextCode;d&&f?(o=d,a=t.concat([f,o.extraDataPayloads.shift()]),s=c.signingSchema.EXTRA_DATA):(a=o.payload,s=o.schema);var p=t.alloc(2+u.reqMaxDataSz),m=0,g=o.extraDataPayloads&&Number(o.extraDataPayloads.length>0);p.writeUInt8(g,m),m+=1,p.writeUInt8(s,m),m+=1;var v=(0,h.validateWallet)(l);return null===(r=v.uid)||void 0===r||r.copy(p,m),m+=null!==(i=null===(n=v.uid)||void 0===n?void 0:n.length)&&void 0!==i?i:0,a.copy(p,m),{payload:p,hasExtraPayloads:g}};r.encryptSignRequest=function(e){var t=e.payload,r=e.sharedSecret;return(0,d.encryptRequest)({requestCode:"SIGN_TRANSACTION",payload:t,sharedSecret:r})};r.requestSign=function(e,t){return n(void 0,void 0,void 0,(function(){return i(this,(function(r){return[2,(0,d.request)({payload:e,url:t})]}))}))};r.decodeSignResponse=function(e){var r,n=e.data,i=e.request,a=e.isGeneric,d=e.currency,h=65;if(d===c.CURRENCIES.BTC){var p=i,m=o.default.getAddressFormat(p.origData.changePath),g=n.slice(h,h+20);h+=20,r=o.default.getBitcoinAddress(g,m);for(var v=[],b=[],y=0;h<n.length&&48===n[h];){var w=h,E=h+2+n[h+1];b.push(n.slice(w,E));var k=33*y+825,S=33*(y+1)+825;v.push(n.slice(k,S)),h+=74,y+=1}var T={inputs:[],outputs:[]};T.outputs.push({value:p.origData.value,recipient:p.origData.recipient}),p.changeData.value>0&&T.outputs.push({value:p.changeData.value,recipient:r});for(var _=0;_<b.length;_++)T.inputs.push({hash:p.origData.prevOuts[_].txHash,index:p.origData.prevOuts[_].index,sig:b[_],pubkey:v[_],signerPath:p.origData.prevOuts[_].signerPath});var x=o.default.serializeTx(T),A=x,P=t.from((0,s.sha256)().update(t.from(A,"hex")).digest("hex"),"hex");return{tx:x,txHash:(0,s.sha256)().update(P).digest("hex"),changeRecipient:r,sigs:b}}if(d!==c.CURRENCIES.ETH||a){if(d===c.CURRENCIES.ETH_MSG){M=(0,f.parseDER)(n.slice(h,h+2+n[h+1]));h+=74;var I=n.slice(h,h+20),R=u.default.validateEthereumMsgResponse({signer:I,sig:M},i);return{sig:{v:R.v,r:R.r.toString("hex"),s:R.s.toString("hex")},signer:I}}return(0,l.parseGenericSigningResponse)(n,h,i)}var M=(0,f.parseDER)(n.slice(h,h+2+n[h+1]));h+=74;var C=n.slice(h,h+20),N=u.default.buildEthRawTx(i,M,C),O=N.rawTx,L=N.sigWithV;return{tx:"0x".concat(O),txHash:"0x".concat(u.default.hashTransaction(O)),sig:{v:L.v,r:L.r.toString("hex"),s:L.s.toString("hex")},signer:C}};r.decryptSignResponse=function(e,t){var r=(0,d.decryptResponse)(e,c.decResLengths.sign,t);return{decryptedData:r.decryptedData,newEphemeralPub:r.newEphemeralPub}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4698,{"./constants":4687,"./index":4699,"./util":4705,buffer:1966,"hash.js/lib/hash/sha":4846,"js-sha3":5199},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.getEncodedPayload=r.parseGenericSigningResponse=r.buildGenericSigningMsgRequest=void 0;var n=e("hash.js/lib/hash/sha"),i=e("js-sha3"),a=e("./constants"),s=e("./index"),o=e("./util");r.buildGenericSigningMsgRequest=function(e){var s=e.signerPath,c=e.curveType,u=e.hashType,l=e.encodingType,d=void 0===l?null:l,h=e.decoder,f=void 0===h?null:h,p=e.omitPubkey,m=void 0!==p&&p,g=e.fwConstants,v=g.extraDataFrameSz,b=g.extraDataMaxFrames,y=g.prehashAllowed,w=g.genericSigning,E=g.varAddrPathSzAllowed,k=w.curveTypes,S=w.encodingTypes,T=w.hashTypes,_=w.baseDataSz,x=w.baseReqSz,A=w.calldataDecoding,P=(0,r.getEncodedPayload)(e.payload,d,S),I=P.encoding,R=P.payloadBuf,M=R,C=R.length,N=_+b*v;if(!C)throw new Error("Payload could not be handled.");if(!(w&&v&&b&&y))throw new Error("Unsupported. Please update your Lattice firmware.");if(!(0,o.existsIn)(c,k))throw new Error("Unsupported curve type.");if(!(0,o.existsIn)(u,T))throw new Error("Unsupported hash type.");var O=f&&A&&f.length<=A.maxSz,L=O&&R.length+f.length<=N;if(O&&L){var D=t.alloc(8+f.length);D.writeUInt32LE(A.reserved,0),D.writeUInt32LE(f.length,4),t.from(f).copy(D,8),R=t.concat([R,D])}if(c===k.ED25519){if(u!==T.NONE)throw new Error("Signing on ed25519 requires unhashed message");s.forEach((function(e){if(e<a.HARDENED_OFFSET)throw new Error("Signing on ed25519 requires all signer path indices be hardened.")}))}var B=t.alloc(x),U=0;B.writeUInt32LE(I,U),U+=4,B.writeUInt8(u,U),U+=1,B.writeUInt8(c,U),U+=1;var F=(0,o.buildSignerPathBuf)(s,E);F.copy(B,U),U+=F.length,B.writeUInt8(m?1:0,U),U+=1;var G=[],j=null,H=!1;if(R.length>_)if(y&&R.length>N){B.writeUInt16LE(R.length,U),U+=2,H=!0;var K=R.slice(0,C);if(u===T.NONE)throw new Error("Message too large to send and could not be prehashed (hashType=NONE).");if(u===T.KECCAK256)j=t.from((0,i.keccak256)(K),"hex");else{if(u!==T.SHA256)throw new Error("Unsupported hash type.");j=t.from((0,n.sha256)().update(K).digest("hex"),"hex")}}else{(0,o.splitFrames)(R.slice(_),v).forEach((function(e){var r=t.alloc(4);r.writeUInt32LE(e.length,0),G.push(t.concat([r,e]))}))}return H||(B.writeUInt16LE(C,U),U+=2),(j||R).copy(B,U),{payload:B,extraDataPayloads:G,schema:a.signingSchema.GENERAL_SIGNING,curveType:c,encodingType:d,hashType:u,omitPubkey:m,origPayloadBuf:M}};r.parseGenericSigningResponse=function(e,r,n){var i={pubkey:null,sig:null};if(n.curveType===s.Constants.SIGNING.CURVES.SECP256K1){if(n.omitPubkey)r+=65;else{var a=e.readUInt8(r);if(r+=1,2===a||3===a)i.pubkey=t.alloc(33),i.pubkey.writeUInt8(a,0),e.slice(r,r+32).copy(i.pubkey,1);else{if(4!==a)throw new Error("Bad compression byte in signing response.");i.pubkey=t.alloc(65),i.pubkey.writeUInt8(a,0),e.slice(r).copy(i.pubkey,1)}r+=64}if(i.sig=(0,o.parseDER)(e.slice(r,r+2+e[r+1])),i.sig.r=(0,o.fixLen)(i.sig.r,32),i.sig.s=(0,o.fixLen)(i.sig.s,32),n.encodingType===s.Constants.SIGNING.ENCODINGS.EVM){var c=(0,o.getV)(n.origPayloadBuf,i);i.sig.v=c.toArrayLike(t)}}else{if(n.curveType!==s.Constants.SIGNING.CURVES.ED25519)throw new Error("Unsupported curve.");n.omitPubkey||(i.pubkey=t.alloc(32),e.slice(r,r+32).copy(i.pubkey)),r+=32,i.sig={r:e.slice(r,r+32),s:e.slice(r+32,r+64)}}return i};r.getEncodedPayload=function(e,r,n){if(r||(r=s.Constants.SIGNING.ENCODINGS.NONE),!(0,o.existsIn)(r,n))throw new Error("Encoding not supported by Lattice firmware. You may want to update.");return{payloadBuf:"string"==typeof e&&"0x"===e.slice(0,2)?t.from(e.slice(2),"hex"):t.from(e),encoding:r}}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4699,{"./calldata/index":4685,"./client":4686,"./constants":4687,"./util":4705},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Utils=r.Constants=r.Client=r.Calldata=void 0;var n=e("./calldata/index");Object.defineProperty(r,"Calldata",{enumerable:!0,get:function(){return n.CALLDATA}});var i=e("./client");Object.defineProperty(r,"Client",{enumerable:!0,get:function(){return i.Client}});var a=e("./constants");Object.defineProperty(r,"Constants",{enumerable:!0,get:function(){return a.EXTERNAL}});var s=e("./util");Object.defineProperty(r,"Utils",{enumerable:!0,get:function(){return s.EXTERNAL}})}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[47,{loglevel:5639,"webextension-polyfill":6558},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({location:e,registerOnboarding:t}){return async function(r,a,s,o){try{if("wallet_registerOnboarding"!==r.method)return void s();r.tabId&&r.tabId!==i.default.tabs.TAB_ID_NONE?await t(e,r.tabId):n.default.debug(`'wallet_registerOnboarding' message from ${e} ignored due to missing tabId`),a.result=!0,o()}catch(e){o(e)}}};var n=a(e("loglevel")),i=a(e("webextension-polyfill"));function a(e){return e&&e.__esModule?e:{default:e}}}}},{package:"$root$"}],[4700,{"../constants":4687},function(){with(this)return function(){"use strict";return function(e,t,r){var n,i=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.LatticeResponseError=void 0;var a=e("../constants"),s=function(e){function t(t,r){var n=this,i=function(e){var t=e.responseCode,r=e.errorMessage,n=[];return t&&n.push("".concat(a.responseMsgs[t])),r&&(n.push("Error Message: "),n.push(r)),n.join("\n")}({responseCode:t,errorMessage:r});return(n=e.call(this,i)||this).responseCode=t,n.errorMessage=r,n.name="LatticeResponseError",n.responseCode=t,n.errorMessage=r,n}return i(t,e),t}(Error);r.LatticeResponseError=s}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4701,{"../bitcoin":4683,"../constants":4687,"../ethereum":4688,"../genericSigning":4698,"../util":4705,"./errors":4700,"./predicates":4702,"./validators":4704,buffer:1966,"hash.js/lib/hash/sha":4846,superagent:4809},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t){(function(){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.getEphemeralId=r.decryptResponse=r.retryWrapper=r.buildRetryWrapper=r.request=r.buildTransaction=r.encryptRequest=r.buildRequest=void 0;var o=e("hash.js/lib/hash/sha"),c=s(e("superagent")),u=s(e("../bitcoin")),l=e("../constants"),d=s(e("../ethereum")),h=e("../genericSigning"),f=e("../util"),p=e("./errors"),m=e("./predicates"),g=e("./validators");r.buildRequest=function(e,r){var n=r&&t.isBuffer(r)?r.length+1:1;e===l.deviceCodes.ENCRYPTED_REQUEST&&(n=1+r.length);var i=0,a=t.alloc(n+8);i=a.writeUInt8(l.VERSION_BYTE,i),i=a.writeUInt8(l.REQUEST_TYPE_BYTE,i);var s=(0,f.randomBytes)(4);i=a.writeUInt32BE(parseInt("0x".concat(s.toString("hex"))),i),i=a.writeUInt16BE(n,i),i=a.writeUInt8(e,i),n>1&&(i=r.copy(a,i));var o=(0,f.checksum)(a),c=t.alloc(a.length+4);return i=a.copy(c),c.writeUInt32BE(o,i),c};r.encryptRequest=function(e){var n=e.payload,i=e.requestCode,a=e.sharedSecret,s=(0,r.getEphemeralId)(a),o=l.encReqCodes[i],c=t.concat([t.from([o]),n]),u=(0,f.checksum)(c),d=t.alloc(c.length+4);c.copy(d,0),d.writeUInt32LE(u,c.length);var h=(0,f.aes256_encrypt)(d,a),p=t.alloc(l.ENC_MSG_LEN+4);return p.writeUInt32LE(s,0),h.copy(p,4),(0,r.buildRequest)(l.deviceCodes.ENCRYPTED_REQUEST,p)};r.buildTransaction=function(e){var t=e.data,r=e.currency,i=e.fwConstants;if("ETH"===r&&(0,m.shouldUseEVMLegacyConverter)(i)){console.log("Using the legacy ETH signing path. This will soon be deprecated. "+"Please switch to general signing request.");var a=void 0;try{a=d.default.ethConvertLegacyToGenericReq(t)}catch(e){throw new Error("Could not convert legacy request. Please switch to a general signing "+"request. See gridplus-sdk docs for more information.")}return t={fwConstants:i,encodingType:l.EXTERNAL.SIGNING.ENCODINGS.EVM,curveType:l.EXTERNAL.SIGNING.CURVES.SECP256K1,hashType:l.EXTERNAL.SIGNING.HASHES.KECCAK256,signerPath:t.signerPath,payload:a},{request:(0,h.buildGenericSigningMsgRequest)(n(n({},t),{fwConstants:i})),isGeneric:!0}}return"ETH"===r?{request:d.default.buildEthereumTxRequest(n(n({},t),{fwConstants:i})),isGeneric:!1}:"ETH_MSG"===r?{request:d.default.buildEthereumMsgRequest(n(n({},t),{fwConstants:i})),isGeneric:!1}:"BTC"===r?{request:u.default.buildBitcoinTxRequest(n(n({},t),{fwConstants:i})),isGeneric:!1}:{request:(0,h.buildGenericSigningMsgRequest)(n(n({},t),{fwConstants:i})),isGeneric:!0}};r.request=function(e){var t=e.url,r=e.payload,n=e.timeout,s=void 0===n?6e4:n;return i(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,c.default.post(t).timeout(s).send({data:r}).catch(g.validateRequestError).then((function(e){return i(void 0,void 0,void 0,(function(){var t,r,n,i;return a(this,(function(a){if(!e.body||!e.body.message)throw new Error("Invalid response:  ".concat(e.body.message));if(200!==e.body.status)throw new Error("Error code ".concat(e.body.status,": ").concat(e.body.message));if(t=(0,f.parseLattice1Response)(e.body.message),r=t.data,n=t.errorMessage,i=t.responseCode,n||i)throw new p.LatticeResponseError(i,n);return[2,r]}))}))}))]}))}))};r.buildRetryWrapper=function(e,t){return function(i,a){return(0,r.retryWrapper)({fn:i,params:n(n({},a),{client:e}),retries:t,client:e})}};r.retryWrapper=function(e){var t=e.fn,s=e.params,o=e.retries,c=e.client;return i(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,t(n({},s)).catch((function(e){return i(void 0,void 0,void 0,(function(){var n,i;return a(this,(function(a){switch(a.label){case 0:return n=e.errorMessage,i=e.responseCode,(n||i)&&o?(0,m.isDeviceBusy)(i)?[4,(u=3e3,new Promise((function(e){return setTimeout(e,u)})))]:[3,2]:[3,8];case 1:case 3:case 5:return a.sent(),[3,7];case 2:return!(0,m.isWrongWallet)(i)||c.skipRetryOnWrongWallet?[3,4]:[4,c.fetchActiveWallet()];case 4:return(0,m.isInvalidEphemeralId)(i)?[4,c.connect(c.deviceId)]:[3,6];case 6:case 8:throw e;case 7:return[2,(0,r.retryWrapper)({fn:t,params:s,retries:o-1,client:c})]}var u}))}))}))]}))}))};r.decryptResponse=function(e,t,r){if(!e||e.length<t)return{decryptedData:null,newEphemeralPub:null};var n=e.slice(0,l.ENC_MSG_LEN),i=(0,f.aes256_decrypt)(n,r);(0,g.validateResponse)(i),t+=65,(0,g.validateChecksum)(i,t);var a=i.slice(0,65).toString("hex");return{decryptedData:i,newEphemeralPub:(0,f.getP256KeyPairFromPub)(a)}};r.getEphemeralId=function(e){var r=t.from((0,o.sha256)().update(e).digest("hex"),"hex");return parseInt(r.slice(0,4).toString("hex"),16)}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4702,{"../constants":4687,"./utilities":4703},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shouldUseEVMLegacyConverter=r.doesFetchWalletsOnLoad=r.isInvalidEphemeralId=r.isWrongWallet=r.isDeviceBusy=void 0;var n=e("../constants"),i=e("./utilities");r.isDeviceBusy=function(e){return e===n.responseCodes.RESP_ERR_DEV_BUSY||e===n.responseCodes.RESP_ERR_GCE_TIMEOUT};r.isWrongWallet=function(e){return e===n.responseCodes.RESP_ERR_WRONG_WALLET};r.isInvalidEphemeralId=function(e){return e===n.responseCodes.RESP_ERR_INVALID_EPHEM_ID};r.doesFetchWalletsOnLoad=function(e){return(0,i.isFWSupported)(e,{major:0,minor:14,fix:1})};r.shouldUseEVMLegacyConverter=function(e){return e.genericSigning&&e.genericSigning.encodingTypes&&e.genericSigning.encodingTypes.EVM}}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4703,{buffer:1966},function(){with(this)return function(){"use strict";return function(e,t,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.isFWSupported=r.parseWallets=r.getSharedSecret=r.getPubKeyBytes=void 0;r.getPubKeyBytes=function(t,r){void 0===r&&(r=!1);var n=t.getPublic().encode("hex"),i=e.from(n,"hex");if(!0===r){var a=i.slice(1,33).reverse(),s=i.slice(33,65).reverse();return e.concat([i[0],a,s])}return i};r.getSharedSecret=function(t,r){return e.from(t.derive(r.getPublic()).toArray("be",32))};r.parseWallets=function(e){var t=0,r={internal:{uid:undefined,capabilities:undefined,name:undefined,external:!1},external:{uid:undefined,capabilities:undefined,name:undefined,external:!0}};return r.internal.uid=e.slice(t,t+32),r.internal.capabilities=e.readUInt32BE(t+32),r.internal.name=e.slice(t+36,t+71),t+=71,r.external.uid=e.slice(t,t+32),r.external.capabilities=e.readUInt32BE(t+32),r.external.name=e.slice(t+36,t+71),r};r.isFWSupported=function(e,t){var r=e.major,n=e.minor,i=e.fix,a=t.major,s=t.minor,o=t.fix;return r>a||r>=a&&n>s||r>=a&&n>=s&&i>=o}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4704,{"../constants":4687,"../util":4705},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateRequestLength=r.validateKvRecord=r.validateKvRecords=r.validateActiveWallets=r.validateKey=r.validateSharedSecret=r.validateEphemeralPub=r.validateWallet=r.validateRequestError=r.validateChecksum=r.validateFwVersion=r.validateFwConstants=r.validateBaseUrl=r.validateUrl=r.validateResponse=r.validateAppName=r.validateEncryptRequestCode=r.validateDeviceId=r.validateStartPath=r.validateNAddresses=r.validateIsUInt4=r.validateValueExists=void 0;var n=e("../constants"),i=e("../util");r.validateValueExists=function(e){var t=Object.entries(e),r=t[0];if(!t[1][1])throw new Error("".concat(r," must be provided"))};r.validateIsUInt4=function(e){if("number"!=typeof e||!(0,i.isUInt4)(e))throw new Error("Must be an integer between 0 and 15 inclusive");return e};r.validateNAddresses=function(e){if(e>n.MAX_ADDR)throw new Error("You may only request ".concat(n.MAX_ADDR," addresses at once."))};r.validateStartPath=function(e){if(!e)throw new Error("Start path is required");if(e.length<2||e.length>5)throw new Error("Path must include between 2 and 5 indices")};r.validateDeviceId=function(e){if(!e)throw new Error("No device ID has been stored. Please connect with your device ID first.");return e};r.validateEncryptRequestCode=function(e){if(e&&n.encReqCodes[e]===undefined)throw new Error("Unknown encrypted request code.")};r.validateAppName=function(e){if(!e)throw new Error("Name is required.");if(e.length<5||e.length>24)throw new Error("Invalid length for name provided. Must be 5-24 characters.");return e};r.validateResponse=function(e){if(!e)throw new Error("Error decrypting response")};r.validateUrl=function(e){if(!e)throw new Error("Url does not exist. Please reconnect.");return e};r.validateBaseUrl=function(e){if(!e)throw new Error("Base URL is required.");return e};r.validateFwConstants=function(e){if(!e)throw new Error("Firmware constants do not exist. Please reconnect.");return e};r.validateFwVersion=function(e){if(!e||e.byteLength>4)throw new Error("Firmware version does not exist. Please reconnect.");return e};r.validateChecksum=function(e,t){var r=e.slice(0,t),n=parseInt("0x".concat(e.slice(t,t+4).toString("hex"))),a=(0,i.checksum)(r);if(n!==a)throw new Error("Checksum mismatch in response from Lattice (calculated ".concat(a,", wanted ").concat(n,")"))};r.validateRequestError=function(e){if("ECONNABORTED"===e.code&&"ETIME"===e.errno)throw new Error("Timeout waiting for device. Please ensure it is connected to the internet and try again in a minute.");throw new Error("Failed to make request to device:\n".concat(e.message))};r.validateWallet=function(e){if(!e||null===e)throw new Error("No active wallet.");return e};r.validateEphemeralPub=function(e){if(!e)throw new Error("`ephemeralPub` (ephemeral public key) is required. Please reconnect.");return e};r.validateSharedSecret=function(e){if(!e)throw new Error("Shared secret required. Please reconnect.");return e};r.validateKey=function(e){if(!e)throw new Error("Key is required. Please reconnect.");return e};r.validateActiveWallets=function(e){var t,r,i,a;if(!e||(null===(r=null===(t=null==e?void 0:e.internal)||void 0===t?void 0:t.uid)||void 0===r?void 0:r.equals(n.EMPTY_WALLET_UID))&&(null===(a=null===(i=null==e?void 0:e.external)||void 0===i?void 0:i.uid)||void 0===a?void 0:a.equals(n.EMPTY_WALLET_UID)))throw new Error("No active wallet.");return e};r.validateKvRecords=function(e,t){if(!t||!t.kvActionsAllowed)throw new Error("Unsupported. Please update firmware.");if("object"!=typeof e||Object.keys(e).length<1)throw new Error("One or more key-value mapping must be provided in `records` param.");if(Object.keys(e).length>t.kvActionMaxNum)throw new Error("Too many keys provided. Please only provide up to ".concat(t.kvActionMaxNum,"."));return e};r.validateKvRecord=function(e,t){var r=e.key,i=e.val;if("string"!=typeof r||String(r).length>t.kvKeyMaxStrSz)throw new Error("Key ".concat(r," too large. Must be <=").concat(t.kvKeyMaxStrSz," characters."));if("string"!=typeof i||String(i).length>t.kvValMaxStrSz)throw new Error("Value ".concat(i," too large. Must be <=").concat(t.kvValMaxStrSz," characters."));if(0===String(r).length||0===String(i).length)throw new Error("Keys and values must be >0 characters.");if(!n.ASCII_REGEX.test(r)||!n.ASCII_REGEX.test(i))throw new Error("Unicode characters are not supported.");return{key:r,val:i}};r.validateRequestLength=function(e,t){if(e.payload.length>t.reqMaxDataSz)throw new Error("Transaction is too large")}}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4705,{".":4699,"./constants":4687,"@ethereumjs/tx":4742,_process:5870,"aes-js":1545,"bignumber.js":4803,"bn.js":1922,buffer:1966,"crc-32":2038,elliptic:2198,"hash.js/lib/hash/sha":4846,"js-sha3":5199,"lodash/inRange":5606,"lodash/isInteger":5615,rlp:4804,secp256k1:4805,superagent:4809},function(){with(this)return function(){"use strict";return function(e,t,r){(function(t,n){(function(){var i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{c(n.next(e))}catch(e){a(e)}}function o(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},s=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.EXTERNAL=r.fetchCalldataDecoder=r.selectDefFrom4byteABI=r.getV=r.generateAppSecret=r.isUInt4=r.randomBytes=r.existsIn=r.isAsciiStr=r.buildSignerPathBuf=r.getP256KeyPairFromPub=r.getP256KeyPair=r.parseDER=r.aes256_decrypt=r.aes256_encrypt=r.fixLen=r.ensureHexBuffer=r.splitFrames=r.isValidAssetPath=r.toPaddedDER=r.checksum=r.parseLattice1Response=void 0;var c,u=e("@ethereumjs/tx"),l=o(e("aes-js")),d=o(e("bignumber.js")),h=e("bn.js"),f=o(e("crc-32")),p=o(e("elliptic")),m=e("hash.js/lib/hash/sha"),g=e("js-sha3"),v=o(e("lodash/inRange")),b=o(e("lodash/isInteger")),y=e("rlp"),w=e("secp256k1"),E=e("."),k=o(e("superagent")),S=e("./constants"),T=S.BIP_CONSTANTS.COINS,_=S.BIP_CONSTANTS.PURPOSES,x=p.default.ec;r.parseLattice1Response=function(e){var t={errorMessage:null,data:null},i=n.from(e,"hex"),a=0,s=i.readUInt8(a);if(a++,s!==S.VERSION_BYTE)return t.errorMessage="Incorrect protocol version. Please update your SDK",t;var o=i.readUInt8(a);if(a++,0!==o)return t.errorMessage="Incorrect response from Lattice1",t;i.readUInt32BE(a),a+=4;var c=i.readUInt16BE(a);a+=2;var u=i.slice(a,a+c);a+=c;var l=u.readUInt8(0);return l!==S.responseCodes.RESP_SUCCESS?(t.errorMessage="".concat(S.responseMsgs[l]?S.responseMsgs[l]:"Unknown Error"," (Lattice)"),t.responseCode=l,t):(t.data=u.slice(1,u.length),i.readUInt32BE(a)!==(0,r.checksum)(i.slice(0,i.length-4))?(t.errorMessage="Invalid checksum from device response",t.data=null,t):t)};r.checksum=function(e){return f.default.buf(e)>>>0};r.toPaddedDER=function(e){var t=n.alloc(74);return n.from(e.toDER()).copy(t),t};r.isValidAssetPath=function(e,t){var r=[_.ETH,_.BTC_LEGACY,_.BTC_WRAPPED_SEGWIT,_.BTC_SEGWIT],n=[T.ETH,T.BTC,T.BTC_TESTNET];return!((e[1]===T.BTC||e[1]===T.BTC_TESTNET)&&e[0]!==_.BTC_WRAPPED_SEGWIT&&!t.allowBtcLegacyAndSegwitAddrs)&&(r.indexOf(e[0])>=0&&(n.indexOf(e[1])>=0||[60,61,966,700,9006,9e3,1007,553,178,137,37310,108,40,889,1987,820,6060,1620,1313114,76,246529,246785,1001,227,916,464,2221,344,73799,246].indexOf(e[1]-S.HARDENED_OFFSET)>0))};r.splitFrames=function(e,t){for(var r=[],n=Math.ceil(e.length/t),i=0,a=0;a<n;a++)r.push(e.slice(i,i+t)),i+=t;return r};r.ensureHexBuffer=function(e,t){void 0===t&&(t=!0);try{if(null===e||0===e&&!0===t)return n.alloc(0);var r="number"==typeof e||function(e){var t=new d.default(e).toFixed().split(".").join(""),r=new String(e);return t.slice(0,8)===r.slice(0,8)}(e);return(e=r?"".concat(new d.default(e).toString(16)):"string"==typeof e&&"0x"===e.slice(0,2)?e.slice(2):e.toString("hex")).length%2>0&&(e="0".concat(e)),"00"!==e||r?n.from(e,"hex"):n.alloc(0)}catch(t){throw new Error("Cannot convert ".concat(e.toString()," to hex buffer (").concat(t.toString(),")"))}};r.fixLen=function(e,t){var r=n.alloc(t);return e.length<t?(e.copy(r,t-e.length),r):e.slice(-t)};r.aes256_encrypt=function(e,t){var r=n.from(S.AES_IV),i=new l.default.ModeOfOperation.cbc(t,r),a=e.length%16==0?e:l.default.padding.pkcs7.pad(e);return n.from(i.encrypt(a))};r.aes256_decrypt=function(e,t){var r=n.from(S.AES_IV),i=new l.default.ModeOfOperation.cbc(t,r);return n.from(i.decrypt(e))};r.parseDER=function(e){if(48!==e[0]||2!==e[2])throw new Error("Failed to decode DER signature");var t=3,r=e[t];t++;var n=e.slice(t,t+r);if(2!==e[t+=r])throw new Error("Failed to decode DER signature");var i=e[++t];return t++,{r:n,s:e.slice(t,t+i)}};r.getP256KeyPair=function(e){return c===undefined&&(c=new x("p256")),c.keyFromPrivate(e,"hex")};r.getP256KeyPairFromPub=function(e){return c===undefined&&(c=new x("p256")),c.keyFromPublic(e,"hex")};r.buildSignerPathBuf=function(e,t){var r=n.alloc(24),i=0;if(t&&e.length>5)throw new Error("Signer path must be <=5 indices.");if(!t&&5!==e.length)throw new Error("Your Lattice firmware only supports 5-index derivation paths. Please upgrade.");r.writeUInt32LE(e.length,i),i+=4;for(var a=0;a<5;a++)a<e.length?r.writeUInt32LE(e[a],i):r.writeUInt32LE(0,i),i+=4;return r};r.isAsciiStr=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)return!1;for(var r=t?[32,10]:[],n=0;n<e.length;n++){var i=e.charCodeAt(n);if(r.indexOf(i)<0&&(i<32||i>127))return!1}return!0};r.existsIn=function(e,t){return Object.keys(t).some((function(r){return t[r]===e}))};r.randomBytes=function(e){for(var t=n.alloc(e),r=0;r<e;r++)t[r]=Math.round(255*Math.random());return t};r.isUInt4=function(e){return(0,b.default)(e)&&(0,v.default)(e,0,16)};r.generateAppSecret=function(e,t,r){var i=n.concat([e,t,r]);return n.from((0,m.sha256)().update(i).digest("hex"),"hex")};function A(e){return i(this,void 0,void 0,(function(){var t,r;return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,k.default.get(S.EXTERNAL_NETWORKS_BY_CHAIN_ID_URL)];case 1:return(t=n.sent())&&t.body?[2,t.body[e]]:[2,undefined];case 2:return r=n.sent(),console.warn("Fetching external networks failed.\n",r),[3,3];case 3:return[2]}}))}))}function P(e,t){var r;if(e.length>1&&console.warn("WARNING: There are multiple results. Using the first one."),e.sort((function(e,t){return new Date(e.created_at).getTime()-new Date(t.created_at).getTime()})).find((function(e){try{return!!(r=E.Calldata.EVM.parsers.parseCanonicalName(t,e.text_signature))}catch(e){return!1}})),r)return r;throw new Error("Could not find definition for selector")}function I(e,r){return i(this,void 0,void 0,(function(){var n,s=this;return a(this,(function(o){return n=function(e){var r=e.supportedChain,n=e.address,i=r.baseUrl,a=r.apiRoute;return"".concat(i,"/").concat(a,"&address=").concat(n)+(t.env.ETHERSCAN_KEY?"&apiKey=".concat(t.env.ETHERSCAN_KEY):"")}({address:e,supportedChain:r}),[2,k.default.get(n).then((function(e){return i(s,void 0,void 0,(function(){return a(this,(function(t){if(e&&e.body&&e.body.result)return[2,JSON.parse(e.body.result)];throw new Error("Server response was malformed")}))}))})).catch((function(){throw new Error("Fetching data from external network failed")}))]}))}))}function R(e){return i(this,void 0,void 0,(function(){var t;return a(this,(function(r){switch(r.label){case 0:return t="https://www.4byte.directory/api/v1/signatures/?hex_signature=0x".concat(e),[4,k.default.get(t).then((function(e){if(e&&e.body&&e.body.results)return e.body.results;throw new Error("No results found")})).catch((function(e){throw new Error("Fetching data from 4byte failed: ".concat(e.message))}))];case 1:return[2,r.sent()]}}))}))}function M(e){return n.from((0,y.encode)(e))}function C(e,t,r,s){return void 0===s&&(s=!1),i(this,void 0,void 0,(function(){var i,o,c,u,l,d,h,f,p,m,g,v,b,y;return a(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,15,,16]),!e||e.length<2)throw new Error("Data is either undefined or less than two bytes");if(i="string"==typeof e&&"0x"===e.slice(0,2),(o=i?n.from(e.slice(2),"hex"):n.from(e,"hex")).length<4)throw new Error("Data must contain at least 4 bytes of data to define the selector");return c=n.from(o.slice(0,4)).toString("hex"),u=Number(r),(l=S.NETWORKS_BY_CHAIN_ID[u])?(h=l,[3,3]):[3,1];case 1:return[4,A(u)];case 2:h=a.sent(),a.label=3;case 3:d=h,a.label=4;case 4:return a.trys.push([4,10,,11]),d?[4,I(t,d)]:[3,8];case 5:return f=a.sent(),p=E.Calldata.EVM.parsers.parseSolidityJSONABI(c,f),m=p.def,s?[4,N(m,o)]:[3,7];case 6:m=a.sent(),a.label=7;case 7:return[2,{abi:f,def:M(m)}];case 8:throw new Error("Chain (id: ".concat(u,") is not supported"));case 9:return[3,11];case 10:return g=a.sent(),console.warn(g.message,"\n","Falling back to 4byte"),[3,11];case 11:return[4,R(c)];case 12:return v=a.sent(),b=P(v,c),s?[4,N(b,o)]:[3,14];case 13:b=a.sent(),a.label=14;case 14:return[2,{abi:v,def:M(b)}];case 15:return y=a.sent(),console.warn("Fetching calldata failed: ".concat(y.message)),[3,16];case 16:return[2,{def:null,abi:null}]}}))}))}function N(e,t){var r,o,c,u;return i(this,void 0,void 0,(function(){var i,l,d,h,f,p,m,g,v,b,y,w,k,S;return a(this,(function(a){switch(a.label){case 0:return[4,O(i=E.Calldata.EVM.processors.getNestedCalldata(e,t))];case 1:l=a.sent(),a.label=2;case 2:a.trys.push([2,22,23,28]),d=s(l.entries()),a.label=3;case 3:return[4,d.next()];case 4:if((h=a.sent()).done)return[3,21];if(f=h.value[0],!Array.isArray(l[f])||"string"==typeof l[f][0])return[3,18];a.label=5;case 5:a.trys.push([5,11,12,17]),c=void 0,p=s(l[f].entries()),a.label=6;case 6:return[4,p.next()];case 7:return(m=a.sent()).done?[3,10]:(g=m.value[0],null===l[f][g]?[3,9]:(v=l[f],b=g,[4,N(l[f][g],n.from(i[f][g].slice(2),"hex"))]));case 8:v[b]=a.sent(),a.label=9;case 9:return[3,6];case 10:return[3,17];case 11:return y=a.sent(),c={error:y},[3,17];case 12:return a.trys.push([12,,15,16]),m&&!m.done&&(u=p.return)?[4,u.call(p)]:[3,14];case 13:a.sent(),a.label=14;case 14:return[3,16];case 15:if(c)throw c.error;return[7];case 16:return[7];case 17:return[3,20];case 18:return null===l[f]?[3,20]:(w=l,k=f,[4,N(l[f],n.from(i[f].slice(2),"hex"))]);case 19:w[k]=a.sent(),a.label=20;case 20:return[3,3];case 21:return[3,28];case 22:return S=a.sent(),r={error:S},[3,28];case 23:return a.trys.push([23,,26,27]),h&&!h.done&&(o=d.return)?[4,o.call(d)]:[3,25];case 24:a.sent(),a.label=25;case 25:return[3,27];case 26:if(r)throw r.error;return[7];case 27:return[7];case 28:return[2,E.Calldata.EVM.processors.replaceNestedDefs(e,l)]}}))}))}function O(e){var t,r,n,o,c,u;return i(this,void 0,void 0,(function(){var i,l,d,h,f,p,m,g,v,b,y,w,E,k,S;return a(this,(function(a){switch(a.label){case 0:i=[],a.label=1;case 1:a.trys.push([1,26,27,32]),t=s(e),a.label=2;case 2:return[4,t.next()];case 3:if((r=a.sent()).done)return[3,25];if(null===(l=r.value))return[3,23];if(!Array.isArray(l))return[3,19];d=[],h=!0,a.label=4;case 4:a.trys.push([4,12,13,18]),c=void 0,f=s(l),a.label=5;case 5:return[4,f.next()];case 6:if((p=a.sent()).done)return[3,11];m=p.value,a.label=7;case 7:return a.trys.push([7,9,,10]),[4,R(g=m.slice(2,10))];case 8:return v=a.sent(),b=P(v,g),d.push(b),[3,10];case 9:return a.sent(),h=!1,d.push(null),[3,10];case 10:return[3,5];case 11:return[3,18];case 12:return y=a.sent(),c={error:y},[3,18];case 13:return a.trys.push([13,,16,17]),p&&!p.done&&(u=f.return)?[4,u.call(f)]:[3,15];case 14:a.sent(),a.label=15;case 15:return[3,17];case 16:if(c)throw c.error;return[7];case 17:return[7];case 18:return h?i.push(d):i.push(null),[3,22];case 19:return a.trys.push([19,21,,22]),[4,R(w=l.slice(2,10))];case 20:return E=a.sent(),k=P(E,w),i.push(k),[3,22];case 21:return a.sent(),i.push(null),[3,22];case 22:return[3,24];case 23:i.push(null),a.label=24;case 24:return[3,2];case 25:return[3,32];case 26:return S=a.sent(),n={error:S},[3,32];case 27:return a.trys.push([27,,30,31]),r&&!r.done&&(o=t.return)?[4,o.call(t)]:[3,29];case 28:a.sent(),a.label=29;case 29:return[3,31];case 30:if(n)throw n.error;return[7];case 31:return[7];case 32:return[2,i]}}))}))}r.getV=function(e,t){var r,i,a;if(n.isBuffer(e)){i=n.from((0,g.keccak256)(e),"hex");try{var s=(0,y.decode)(e);r=6===s.length?null:new h.BN(s[6]),a=0}catch(t){try{a=u.TransactionFactory.fromSerializedData(e)._type}catch(e){throw new Error("Could not recover V. Bad transaction data.")}}}else i=(a=e._type)?e.getMessageToSign(!0):(0,y.encode)(e.getMessageToSign(!1)),e.supports(u.Capability.EIP155ReplayProtection)&&(r=e.common.chainIdBN().toNumber());var o,c=new Uint8Array(n.concat([t.sig.r,t.sig.s])),l=new Uint8Array(t.pubkey),d=(0,w.ecdsaRecover)(c,0,i,!1),f=(0,w.ecdsaRecover)(c,1,i,!1),p=n.from(l).toString("hex"),m=n.from(d).toString("hex"),v=n.from(f).toString("hex");if(p===m)o=0;else{if(p!==v)throw new Error("Failed to recover V parameter. Bad signature or transaction data.");o=1}return a?new h.BN(o):r?r.muln(2).addn(35).addn(o):new h.BN(o).addn(27)},r.selectDefFrom4byteABI=P,r.fetchCalldataDecoder=C,r.EXTERNAL={getV:r.getV,generateAppSecret:r.generateAppSecret,fetchCalldataDecoder:C}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)}}},{package:"eth-lattice-keyring>gridplus-sdk"}],[4706,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"calaveras",chainId:123,networkId:123,defaultHardfork:"berlin",consensus:{type:"poa",algorithm:"clique",clique:{period:30,epoch:3e4}},comment:"The Calaveras testnet chain",url:"https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/client-integration-testnets/calaveras.md",genesis:{hash:"0xeb9233d066c275efcdfed8037f4fc082770176aefdbcb7691c71da412a5670f2",gasLimit:"0x47b760",difficulty:"0x1",nonce:"0x0000000000000000",extraData:"0x00000000000000000000000000000000000000000000000000000000000000005211cea3870c7ba7c6c44b185e62eecdb864cd8c560228ce57d31efbf64c200b2c200aacec78cf17a7148e784fe95a7a750335f8b9572ee28d72e7650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",stateRoot:"0x664c93de37eb4a72953ea42b8c046cdb64c9f0b0bca5505ade8d970d49ebdb8c",timestamp:"0x60b3877f"},hardforks:[{name:"chainstart",block:0,forkHash:"0xe34c4aff"},{name:"homestead",block:0,forkHash:"0xe34c4aff"},{name:"dao",block:null,forkHash:"0xe34c4aff"},{name:"tangerineWhistle",block:0,forkHash:"0xe34c4aff"},{name:"spuriousDragon",block:0,forkHash:"0xe34c4aff"},{name:"byzantium",block:0,forkHash:"0xe34c4aff"},{name:"constantinople",block:0,forkHash:"0xe34c4aff"},{name:"petersburg",block:0,forkHash:"0xe34c4aff"},{name:"istanbul",block:0,forkHash:"0xe34c4aff"},{name:"berlin",block:0,forkHash:"0xe34c4aff"},{name:"london",block:500,forkHash:"0x173783e4"}],bootstrapNodes:[{ip:"3.21.156.138",port:30303,id:"39eb08bbfad87481553c471a63ff2a4b4885fffa4ff50f1cf46744d9ad6e2f764ede146fe4df563fa9ccda1a46b9b1a88fb08135e1bf1d71b320912499da773d",location:"",comment:"Calaveras bootnode 1"},{ip:"3.9.20.133",port:30303,id:"9e1096aa59862a6f164994cb5cb16f5124d6c992cdbf4535ff7dea43ea1512afe5448dca9df1b7ab0726129603f1a3336b631e4d7a1a44c94daddd03241587f9",location:"",comment:"Calaveras bootnode 2"}]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4707,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"goerli",chainId:5,networkId:5,defaultHardfork:"istanbul",consensus:{type:"poa",algorithm:"clique",clique:{period:15,epoch:3e4}},comment:"Cross-client PoA test network",url:"https://github.com/goerli/testnet",genesis:{hash:"0xbf7e331f7f7c1dd2e05159666b3bf8bc7a8a3a9eb1d518969eab529dd9b88c1a",timestamp:"0x5c51a607",gasLimit:10485760,difficulty:1,nonce:"0x0000000000000000",extraData:"0x22466c6578692069732061207468696e6722202d204166726900000000000000e0a2bd4258d2768837baa26a28fe71dc079f84c70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",stateRoot:"0x5d6cded585e73c4e322c30c2f782a336316f17dd85a4863b9d838d2d4b8b3008"},hardforks:[{name:"chainstart",block:0,forkHash:"0xa3f5ab08"},{name:"homestead",block:0,forkHash:"0xa3f5ab08"},{name:"dao",block:null,forkHash:"0xa3f5ab08"},{name:"tangerineWhistle",block:0,forkHash:"0xa3f5ab08"},{name:"spuriousDragon",block:0,forkHash:"0xa3f5ab08"},{name:"byzantium",block:0,forkHash:"0xa3f5ab08"},{name:"constantinople",block:0,forkHash:"0xa3f5ab08"},{name:"petersburg",block:0,forkHash:"0xa3f5ab08"},{name:"istanbul",block:1561651,forkHash:"0xc25efa5c"},{name:"berlin",block:4460644,forkHash:"0x757a1c47"},{name:"london",block:5062605,forkHash:"0xb8c6299d"}],bootstrapNodes:[{ip:"51.141.78.53",port:30303,id:"011f758e6552d105183b1761c5e2dea0111bc20fd5f6422bc7f91e0fabbec9a6595caf6239b37feb773dddd3f87240d99d859431891e4a642cf2a0a9e6cbb98a",location:"",comment:"Upstream bootnode 1"},{ip:"13.93.54.137",port:30303,id:"176b9417f511d05b6b2cf3e34b756cf0a7096b3094572a8f6ef4cdcb9d1f9d00683bf0f83347eebdf3b81c3521c2332086d9592802230bf528eaf606a1d9677b",location:"",comment:"Upstream bootnode 2"},{ip:"94.237.54.114",port:30313,id:"46add44b9f13965f7b9875ac6b85f016f341012d84f975377573800a863526f4da19ae2c620ec73d11591fa9510e992ecc03ad0751f53cc02f7c7ed6d55c7291",location:"",comment:"Upstream bootnode 3"},{ip:"18.218.250.66",port:30313,id:"b5948a2d3e9d486c4d75bf32713221c2bd6cf86463302339299bd227dc2e276cd5a1c7ca4f43a0e9122fe9af884efed563bd2a1fd28661f3b5f5ad7bf1de5949",location:"",comment:"Upstream bootnode 4"},{ip:"3.11.147.67",port:30303,id:"a61215641fb8714a373c80edbfa0ea8878243193f57c96eeb44d0bc019ef295abd4e044fd619bfc4c59731a73fb79afe84e9ab6da0c743ceb479cbb6d263fa91",location:"",comment:"Ethereum Foundation bootnode"},{ip:"51.15.116.226",port:30303,id:"a869b02cec167211fb4815a82941db2e7ed2936fd90e78619c53eb17753fcf0207463e3419c264e2a1dd8786de0df7e68cf99571ab8aeb7c4e51367ef186b1dd",location:"",comment:"Goerli Initiative bootnode"},{ip:"51.15.119.157",port:30303,id:"807b37ee4816ecf407e9112224494b74dd5933625f655962d892f2f0f02d7fbbb3e2a94cf87a96609526f30c998fd71e93e2f53015c558ffc8b03eceaf30ee33",location:"",comment:"Goerli Initiative bootnode"},{ip:"51.15.119.157",port:40303,id:"a59e33ccd2b3e52d578f1fbd70c6f9babda2650f0760d6ff3b37742fdcdfdb3defba5d56d315b40c46b70198c7621e63ffa3f987389c7118634b0fefbbdfa7fd",location:"",comment:"Goerli Initiative bootnode"}],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.goerli.ethdisco.net"]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4708,{"./calaveras.json":4706,"./goerli.json":4707,"./kovan.json":4709,"./mainnet.json":4710,"./rinkeby.json":4711,"./ropsten.json":4712},function(){with(this)return function(){"use strict";return function(e,t,r){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.chains=r._getInitializedChains=void 0;var a=i(e("./mainnet.json")),s=i(e("./ropsten.json")),o=i(e("./rinkeby.json")),c=i(e("./kovan.json")),u=i(e("./goerli.json")),l=i(e("./calaveras.json"));function d(e){var t,r,i={1:"mainnet",3:"ropsten",4:"rinkeby",42:"kovan",5:"goerli",123:"calaveras"},d={mainnet:a.default,ropsten:s.default,rinkeby:o.default,kovan:c.default,goerli:u.default,calaveras:l.default};if(e)try{for(var h=n(e),f=h.next();!f.done;f=h.next()){var p=f.value,m=p.name;i[p.chainId.toString()]=m,d[m]=p}}catch(e){t={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(t)throw t.error}}return d.names=i,d}r._getInitializedChains=d,r.chains=d()}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4709,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"kovan",chainId:42,networkId:42,defaultHardfork:"istanbul",consensus:{type:"poa",algorithm:"aura",aura:{}},comment:"Parity PoA test network",url:"https://kovan-testnet.github.io/website/",genesis:{hash:"0xa3c565fc15c7478862d50ccd6561e3c06b24cc509bf388941c25ea985ce32cb9",timestamp:null,gasLimit:6e6,difficulty:131072,nonce:"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",extraData:"0x",stateRoot:"0x2480155b48a1cea17d67dbfdfaafe821c1d19cdd478c5358e8ec56dec24502b2"},hardforks:[{name:"chainstart",block:0,forkHash:"0x010ffe56"},{name:"homestead",block:0,forkHash:"0x010ffe56"},{name:"dao",block:null,forkHash:"0x010ffe56"},{name:"tangerineWhistle",block:0,forkHash:"0x010ffe56"},{name:"spuriousDragon",block:0,forkHash:"0x010ffe56"},{name:"byzantium",block:5067e3,forkHash:"0x7f83c620"},{name:"constantinople",block:92e5,forkHash:"0xa94e3dc4"},{name:"petersburg",block:10255201,forkHash:"0x186874aa"},{name:"istanbul",block:14111141,forkHash:"0x7f6599a6"},{name:"berlin",block:null,forkHash:null},{name:"london",block:null,forkHash:null}],bootstrapNodes:[{ip:"116.203.116.241",port:30303,id:"16898006ba2cd4fa8bf9a3dfe32684c178fa861df144bfc21fe800dc4838a03e342056951fa9fd533dcb0be1219e306106442ff2cf1f7e9f8faa5f2fc1a3aa45",location:"",comment:"1"},{ip:"3.217.96.11",port:30303,id:"2909846f78c37510cc0e306f185323b83bb2209e5ff4fdd279d93c60e3f365e3c6e62ad1d2133ff11f9fd6d23ad9c3dad73bb974d53a22f7d1ac5b7dea79d0b0",location:"",comment:"2"},{ip:"108.61.170.124",port:30303,id:"740e1c8ea64e71762c71a463a04e2046070a0c9394fcab5891d41301dc473c0cff00ebab5a9bc87fbcb610ab98ac18225ff897bc8b7b38def5975d5ceb0a7d7c",location:"",comment:"3"},{ip:"157.230.31.163",port:30303,id:"2909846f78c37510cc0e306f185323b83bb2209e5ff4fdd279d93c60e3f365e3c6e62ad1d2133ff11f9fd6d23ad9c3dad73bb974d53a22f7d1ac5b7dea79d0b0",location:"",comment:"4"}]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4710,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"mainnet",chainId:1,networkId:1,defaultHardfork:"istanbul",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"The Ethereum main chain",url:"https://ethstats.net/",genesis:{hash:"0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3",timestamp:null,gasLimit:5e3,difficulty:17179869184,nonce:"0x0000000000000042",extraData:"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa",stateRoot:"0xd7f8974fb5ac78d9ac099b9ad5018bedc2ce0a72dad1827a1709da30580f0544"},hardforks:[{name:"chainstart",block:0,forkHash:"0xfc64ec04"},{name:"homestead",block:115e4,forkHash:"0x97c2c34c"},{name:"dao",block:192e4,forkHash:"0x91d1f948"},{name:"tangerineWhistle",block:2463e3,forkHash:"0x7a64da13"},{name:"spuriousDragon",block:2675e3,forkHash:"0x3edd5b10"},{name:"byzantium",block:437e4,forkHash:"0xa00bc324"},{name:"constantinople",block:728e4,forkHash:"0x668db0af"},{name:"petersburg",block:728e4,forkHash:"0x668db0af"},{name:"istanbul",block:9069e3,forkHash:"0x879d6e30"},{name:"muirGlacier",block:92e5,forkHash:"0xe029e991"},{name:"berlin",block:12244e3,forkHash:"0x0eb440f6"},{name:"london",block:12965e3,forkHash:"0xb715077d"}],bootstrapNodes:[{ip:"18.138.108.67",port:30303,id:"d860a01f9722d78051619d1e2351aba3f43f943f6f00718d1b9baa4101932a1f5011f16bb2b1bb35db20d6fe28fa0bf09636d26a87d31de9ec6203eeedb1f666",location:"ap-southeast-1-001",comment:"bootnode-aws-ap-southeast-1-001"},{ip:"3.209.45.79",port:30303,id:"22a8232c3abc76a16ae9d6c3b164f98775fe226f0917b0ca871128a74a8e9630b458460865bab457221f1d448dd9791d24c4e5d88786180ac185df813a68d4de",location:"us-east-1-001",comment:"bootnode-aws-us-east-1-001"},{ip:"34.255.23.113",port:30303,id:"ca6de62fce278f96aea6ec5a2daadb877e51651247cb96ee310a318def462913b653963c155a0ef6c7d50048bba6e6cea881130857413d9f50a621546b590758",location:"eu-west-1-001",comment:"bootnode-aws-eu-west-1-001"},{ip:"35.158.244.151",port:30303,id:"279944d8dcd428dffaa7436f25ca0ca43ae19e7bcf94a8fb7d1641651f92d121e972ac2e8f381414b80cc8e5555811c2ec6e1a99bb009b3f53c4c69923e11bd8",location:"eu-central-1-001",comment:"bootnode-aws-eu-central-1-001"},{ip:"52.187.207.27",port:30303,id:"8499da03c47d637b20eee24eec3c356c9a2e6148d6fe25ca195c7949ab8ec2c03e3556126b0d7ed644675e78c4318b08691b7b57de10e5f0d40d05b09238fa0a",location:"australiaeast-001",comment:"bootnode-azure-australiaeast-001"},{ip:"191.234.162.198",port:30303,id:"103858bdb88756c71f15e9b5e09b56dc1be52f0a5021d46301dbbfb7e130029cc9d0d6f73f693bc29b665770fff7da4d34f3c6379fe12721b5d7a0bcb5ca1fc1",location:"brazilsouth-001",comment:"bootnode-azure-brazilsouth-001"},{ip:"52.231.165.108",port:30303,id:"715171f50508aba88aecd1250af392a45a330af91d7b90701c436b618c86aaa1589c9184561907bebbb56439b8f8787bc01f49a7c77276c58c1b09822d75e8e8",location:"koreasouth-001",comment:"bootnode-azure-koreasouth-001"},{ip:"104.42.217.25",port:30303,id:"5d6d7cd20d6da4bb83a1d28cadb5d409b64edf314c0335df658c1a54e32c7c4a7ab7823d57c39b6a757556e68ff1df17c748b698544a55cb488b52479a92b60f",location:"westus-001",comment:"bootnode-azure-westus-001"}],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.mainnet.ethdisco.net"]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4711,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"rinkeby",chainId:4,networkId:4,defaultHardfork:"istanbul",consensus:{type:"poa",algorithm:"clique",clique:{period:15,epoch:3e4}},comment:"PoA test network",url:"https://www.rinkeby.io",genesis:{hash:"0x6341fd3daf94b748c72ced5a5b26028f2474f5f00d824504e4fa37a75767e177",timestamp:"0x58ee40ba",gasLimit:47e5,difficulty:1,nonce:"0x0000000000000000",extraData:"0x52657370656374206d7920617574686f7269746168207e452e436172746d616e42eb768f2244c8811c63729a21a3569731535f067ffc57839b00206d1ad20c69a1981b489f772031b279182d99e65703f0076e4812653aab85fca0f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",stateRoot:"0x53580584816f617295ea26c0e17641e0120cab2f0a8ffb53a866fd53aa8e8c2d"},hardforks:[{name:"chainstart",block:0,forkHash:"0x3b8e0691"},{name:"homestead",block:1,forkHash:"0x60949295"},{name:"dao",block:null,forkHash:null},{name:"tangerineWhistle",block:2,forkHash:"0x8bde40dd"},{name:"spuriousDragon",block:3,forkHash:"0xcb3a64bb"},{name:"byzantium",block:1035301,forkHash:"0x8d748b57"},{name:"constantinople",block:3660663,forkHash:"0xe49cab14"},{name:"petersburg",block:4321234,forkHash:"0xafec6b27"},{name:"istanbul",block:5435345,forkHash:"0xcbdb8838"},{name:"berlin",block:8290928,forkHash:"0x6910c8bd"},{name:"london",block:8897988,forkHash:"0x8e29f2f3"}],bootstrapNodes:[{ip:"52.169.42.101",port:30303,id:"a24ac7c5484ef4ed0c5eb2d36620ba4e4aa13b8c84684e1b4aab0cebea2ae45cb4d375b77eab56516d34bfbd3c1a833fc51296ff084b770b94fb9028c4d25ccf",location:"",comment:"IE"},{ip:"52.3.158.184",port:30303,id:"343149e4feefa15d882d9fe4ac7d88f885bd05ebb735e547f12e12080a9fa07c8014ca6fd7f373123488102fe5e34111f8509cf0b7de3f5b44339c9f25e87cb8",location:"",comment:"INFURA"},{ip:"159.89.28.211",port:30303,id:"b6b28890b006743680c52e64e0d16db57f28124885595fa03a562be1d2bf0f3a1da297d56b13da25fb992888fd556d4c1a27b1f39d531bde7de1921c90061cc6",location:"",comment:"AKASHA"}],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.rinkeby.ethdisco.net"]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4712,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"ropsten",chainId:3,networkId:3,defaultHardfork:"istanbul",consensus:{type:"pow",algorithm:"ethash",ethash:{}},comment:"PoW test network",url:"https://github.com/ethereum/ropsten",genesis:{hash:"0x41941023680923e0fe4d74a34bdac8141f2540e3ae90623718e47d66d1ca4a2d",timestamp:null,gasLimit:16777216,difficulty:1048576,nonce:"0x0000000000000042",extraData:"0x3535353535353535353535353535353535353535353535353535353535353535",stateRoot:"0x217b0bbcfb72e2d57e28f33cb361b9983513177755dc3f33ce3e7022ed62b77b"},hardforks:[{name:"chainstart",block:0,forkHash:"0x30c7ddbc"},{name:"homestead",block:0,forkHash:"0x30c7ddbc"},{name:"dao",block:null,forkHash:null},{name:"tangerineWhistle",block:0,forkHash:"0x30c7ddbc"},{name:"spuriousDragon",block:10,forkHash:"0x63760190"},{name:"byzantium",block:17e5,forkHash:"0x3ea159c7"},{name:"constantinople",block:423e4,forkHash:"0x97b544f3"},{name:"petersburg",block:4939394,forkHash:"0xd6e2149b"},{name:"istanbul",block:6485846,forkHash:"0x4bc66396"},{name:"muirGlacier",block:7117117,forkHash:"0x6727ef90"},{name:"berlin",block:9812189,forkHash:"0xa157d377"},{name:"london",block:10499401,forkHash:"0x7119b6b3"}],bootstrapNodes:[{ip:"52.176.7.10",port:30303,id:"30b7ab30a01c124a6cceca36863ece12c4f5fa68e3ba9b0b51407ccc002eeed3b3102d20a88f1c1d3c3154e2449317b8ef95090e77b312d5cc39354f86d5d606",location:"",comment:"US-Azure geth"},{ip:"52.176.100.77",port:30303,id:"865a63255b3bb68023b6bffd5095118fcc13e79dcf014fe4e47e065c350c7cc72af2e53eff895f11ba1bbb6a2b33271c1116ee870f266618eadfc2e78aa7349c",location:"",comment:"US-Azure parity"},{ip:"52.232.243.152",port:30303,id:"6332792c4a00e3e4ee0926ed89e0d27ef985424d97b6a45bf0f23e51f0dcb5e66b875777506458aea7af6f9e4ffb69f43f3778ee73c81ed9d34c51c4b16b0b0f",location:"",comment:"Parity"},{ip:"192.81.208.223",port:30303,id:"94c15d1b9e2fe7ce56e458b9a3b672ef11894ddedd0c6f247e0f1d3487f52b66208fb4aeb8179fce6e3a749ea93ed147c37976d67af557508d199d9594c35f09",location:"",comment:"@gpip"}],dnsNetworks:["enrtree://AKA3AM6LPBYEUDMVNU3BSVQJ5AD45Y7YPOHJLEF6W26QOE4VTUDPE@all.ropsten.ethdisco.net"]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4713,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-1559",number:1559,comment:"Fee market change for ETH 1.0 chain",url:"https://eips.ethereum.org/EIPS/eip-1559",status:"Review",minimumHardfork:"berlin",requiredEIPs:[2930],gasConfig:{baseFeeMaxChangeDenominator:{v:8,d:"Maximum base fee change denominator"},elasticityMultiplier:{v:2,d:"Maximum block gas target elasticity"},initialBaseFee:{v:1e9,d:"Initial base fee on first EIP1559 block"}},gasPrices:{},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4714,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-2315",number:2315,comment:"Simple subroutines for the EVM",url:"https://eips.ethereum.org/EIPS/eip-2315",status:"Draft",minimumHardfork:"istanbul",gasConfig:{},gasPrices:{beginsub:{v:2,d:"Base fee of the BEGINSUB opcode"},returnsub:{v:5,d:"Base fee of the RETURNSUB opcode"},jumpsub:{v:10,d:"Base fee of the JUMPSUB opcode"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4715,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-2537",number:2537,comment:"BLS12-381 precompiles",url:"https://eips.ethereum.org/EIPS/eip-2537",status:"Draft",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{Bls12381G1AddGas:{v:600,d:"Gas cost of a single BLS12-381 G1 addition precompile-call"},Bls12381G1MulGas:{v:12e3,d:"Gas cost of a single BLS12-381 G1 multiplication precompile-call"},Bls12381G2AddGas:{v:4500,d:"Gas cost of a single BLS12-381 G2 addition precompile-call"},Bls12381G2MulGas:{v:55e3,d:"Gas cost of a single BLS12-381 G2 multiplication precompile-call"},Bls12381PairingBaseGas:{v:115e3,d:"Base gas cost of BLS12-381 pairing check"},Bls12381PairingPerPairGas:{v:23e3,d:"Per-pair gas cost of BLS12-381 pairing check"},Bls12381MapG1Gas:{v:5500,d:"Gas cost of BLS12-381 map field element to G1"},Bls12381MapG2Gas:{v:11e4,d:"Gas cost of BLS12-381 map field element to G2"},Bls12381MultiExpGasDiscount:{v:[[1,1200],[2,888],[3,764],[4,641],[5,594],[6,547],[7,500],[8,453],[9,438],[10,423],[11,408],[12,394],[13,379],[14,364],[15,349],[16,334],[17,330],[18,326],[19,322],[20,318],[21,314],[22,310],[23,306],[24,302],[25,298],[26,294],[27,289],[28,285],[29,281],[30,277],[31,273],[32,269],[33,268],[34,266],[35,265],[36,263],[37,262],[38,260],[39,259],[40,257],[41,256],[42,254],[43,253],[44,251],[45,250],[46,248],[47,247],[48,245],[49,244],[50,242],[51,241],[52,239],[53,238],[54,236],[55,235],[56,233],[57,232],[58,231],[59,229],[60,228],[61,226],[62,225],[63,223],[64,222],[65,221],[66,220],[67,219],[68,219],[69,218],[70,217],[71,216],[72,216],[73,215],[74,214],[75,213],[76,213],[77,212],[78,211],[79,211],[80,210],[81,209],[82,208],[83,208],[84,207],[85,206],[86,205],[87,205],[88,204],[89,203],[90,202],[91,202],[92,201],[93,200],[94,199],[95,199],[96,198],[97,197],[98,196],[99,196],[100,195],[101,194],[102,193],[103,193],[104,192],[105,191],[106,191],[107,190],[108,189],[109,188],[110,188],[111,187],[112,186],[113,185],[114,185],[115,184],[116,183],[117,182],[118,182],[119,181],[120,180],[121,179],[122,179],[123,178],[124,177],[125,176],[126,176],[127,175],[128,174]],d:"Discount gas costs of calls to the MultiExp precompiles with `k` (point, scalar) pair"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4716,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-2565",number:2565,comment:"ModExp gas cost",url:"https://eips.ethereum.org/EIPS/eip-2565",status:"Last call",minimumHardfork:"byzantium",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:3,d:"Gquaddivisor from modexp precompile for gas calculation"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4717,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-2718",comment:"Typed Transaction Envelope",url:"https://eips.ethereum.org/EIPS/eip-2718",status:"Draft",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4718,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-2929",comment:"Gas cost increases for state access opcodes",url:"https://eips.ethereum.org/EIPS/eip-2929",status:"Draft",minimumHardfork:"chainstart",gasConfig:{},gasPrices:{coldsload:{v:2100,d:"Gas cost of the first read of storage from a given location (per transaction)"},coldaccountaccess:{v:2600,d:"Gas cost of the first read of a given address (per transaction)"},warmstorageread:{v:100,d:"Gas cost of reading storage locations which have already loaded 'cold'"},sstoreCleanGasEIP2200:{v:2900,d:"Once per SSTORE operation from clean non-zero to something else"},sstoreNoopGasEIP2200:{v:100,d:"Once per SSTORE operation if the value doesn't change"},sstoreDirtyGasEIP2200:{v:100,d:"Once per SSTORE operation if a dirty value is changed"},sstoreInitRefundEIP2200:{v:19900,d:"Once per SSTORE operation for resetting to the original zero value"},sstoreCleanRefundEIP2200:{v:4900,d:"Once per SSTORE operation for resetting to the original non-zero value"},call:{v:0,d:"Base fee of the CALL opcode"},callcode:{v:0,d:"Base fee of the CALLCODE opcode"},delegatecall:{v:0,d:"Base fee of the DELEGATECALL opcode"},staticcall:{v:0,d:"Base fee of the STATICCALL opcode"},balance:{v:0,d:"Base fee of the BALANCE opcode"},extcodesize:{v:0,d:"Base fee of the EXTCODESIZE opcode"},extcodecopy:{v:0,d:"Base fee of the EXTCODECOPY opcode"},extcodehash:{v:0,d:"Base fee of the EXTCODEHASH opcode"},sload:{v:0,d:"Base fee of the SLOAD opcode"},sstore:{v:0,d:"Base fee of the SSTORE opcode"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4719,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-2930",comment:"Optional access lists",url:"https://eips.ethereum.org/EIPS/eip-2930",status:"Draft",minimumHardfork:"istanbul",requiredEIPs:[2718,2929],gasConfig:{},gasPrices:{accessListStorageKeyCost:{v:1900,d:"Gas cost per storage key in an Access List transaction"},accessListAddressCost:{v:2400,d:"Gas cost per storage key in an Access List transaction"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4720,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-3198",number:3198,comment:"BASEFEE opcode",url:"https://eips.ethereum.org/EIPS/eip-3198",status:"Review",minimumHardfork:"london",gasConfig:{},gasPrices:{basefee:{v:2,d:"Gas cost of the BASEFEE opcode"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4721,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-3529",comment:"Reduction in refunds",url:"https://eips.ethereum.org/EIPS/eip-3529",status:"Draft",minimumHardfork:"berlin",requiredEIPs:[2929],gasConfig:{maxRefundQuotient:{v:5,d:"Maximum refund quotient; max tx refund is min(tx.gasUsed/maxRefundQuotient, tx.gasRefund)"}},gasPrices:{selfdestructRefund:{v:0,d:"Refunded following a selfdestruct operation"},sstoreClearRefundEIP2200:{v:4800,d:"Once per SSTORE operation for clearing an originally existing storage slot"}},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4722,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-3541",comment:"Reject new contracts starting with the 0xEF byte",url:"https://eips.ethereum.org/EIPS/eip-3541",status:"Draft",minimumHardfork:"berlin",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4723,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"EIP-3554",comment:"Reduction in refunds",url:"Difficulty Bomb Delay to December 1st 2021",status:"Draft",minimumHardfork:"muirGlacier",requiredEIPs:[],gasConfig:{},gasPrices:{},vm:{},pow:{difficultyBombDelay:{v:95e5,d:"the amount of blocks to delay the difficulty bomb with"}}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4724,{"./1559.json":4713,"./2315.json":4714,"./2537.json":4715,"./2565.json":4716,"./2718.json":4717,"./2929.json":4718,"./2930.json":4719,"./3198.json":4720,"./3529.json":4721,"./3541.json":4722,"./3554.json":4723},function(){with(this)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.EIPs=void 0,r.EIPs={1559:e("./1559.json"),2315:e("./2315.json"),2537:e("./2537.json"),2565:e("./2565.json"),2718:e("./2718.json"),2929:e("./2929.json"),2930:e("./2930.json"),3198:e("./3198.json"),3529:e("./3529.json"),3541:e("./3541.json"),3554:e("./3554.json")}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4725,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"berlin",comment:"HF targeted for July 2020 following the Muir Glacier HF",url:"https://eips.ethereum.org/EIPS/eip-2070",status:"Draft",eips:[2565,2929,2718,2930]}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}],[4726,{},function(){with(this)return function(){"use strict";return function(e,t,r){t.exports={name:"byzantium",comment:"Hardfork with new precompiles, instructions and other protocol changes",url:"https://eips.ethereum.org/EIPS/eip-609",status:"Final",gasConfig:{},gasPrices:{modexpGquaddivisor:{v:20,d:"Gquaddivisor from modexp precompile for gas calculation"},ecAdd:{v:500,d:"Gas costs for curve addition precompile"},ecMul:{v:4e4,d:"Gas costs for curve multiplication precompile"},ecPairing:{v:1e5,d:"Base gas costs for curve pairing precompile"},ecPairingWord:{v:8e4,d:"Gas costs regarding curve pairing precompile input length"},revert:{v:0,d:"Base fee of the REVERT opcode"},staticcall:{v:700,d:"Base fee of the STATICCALL opcode"},returndatasize:{v:2,d:"Base fee of the RETURNDATASIZE opcode"},returndatacopy:{v:3,d:"Base fee of the RETURNDATACOPY opcode"}},vm:{},pow:{minerReward:{v:"3000000000000000000",d:"the amount a miner get rewarded for mining a block"},difficultyBombDelay:{v:3e6,d:"the amount of blocks to delay the difficulty bomb with"}}}}}},{package:"eth-lattice-keyring>gridplus-sdk>@ethereumjs/common"}]],[],{});